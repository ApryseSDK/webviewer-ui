(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[98023],{"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".sheet-tab{cursor:pointer;border-bottom:none;border-top-right-radius:4px;border-top-left-radius:4px;min-width:170px;height:40px;position:relative;border-inline-end:1px solid transparent}.sheet-tab:hover{background:var(--faded-component-background)}.sheet-tab.no-left-border .tab-body{border-inline-end:1px solid transparent}.sheet-tab .tab-body{height:24px;display:flex;padding:0;padding-inline-start:8px;padding-inline-end:8px;width:100%;position:absolute;inset-block-start:50%;transform:translateY(-50%);border-inline-end:1px solid var(--border)}.sheet-tab .tab-body.input-mode{padding-inline-start:5px;padding-inline-end:6px}.sheet-tab .tab-body .sheet-label{width:calc(100% - 24px);text-align:start;justify-content:left;height:24px}.sheet-tab .tab-body .sheet-label span{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.sheet-tab .tab-body .sheet-input{max-width:100%}.sheet-tab .tab-body input.input-error{border-color:red}.sheet-tab.active{border:1px solid var(--border);border-bottom:none;background:var(--gray-0)}.sheet-tab.active .tab-body{border-inline-end:1px solid transparent}.sheet-tab .sheet-options .ToggleElementButton button{width:24px;height:24px;min-width:24px}.sheet-tab .sheet-options .ToggleElementButton button .Icon{width:16px;height:14px}.sheet-tab .sheet-options .more-options-icon{height:24px;width:24px}.sheet-tab .sheet-options .more-options-icon .Icon{width:16px;height:16px}",""]),module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".Flyout[\\:has\\(.SheetOptionsFlyout\\)]{z-index:130}.Flyout:has(.SheetOptionsFlyout){z-index:130}.SpreadsheetSwitcher{padding:0}.GenericFileTab{display:flex;padding-inline-start:4px;padding-top:4px}.GenericFileTab .dropdown-menu{border:1px solid var(--border);margin-top:3px;margin-inline-start:5px}.GenericFileTab .dropdown-menu .Icon{position:absolute}.GenericFileTab .add-sheet-tab{margin-top:3px;margin-inline-start:5px}.GenericFileTab .add-sheet-tab .Icon{width:14px;height:14px}",""]),module.exports=exports},"./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>SpreadsheetSwitcher_SheetTab_SheetTab});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),actions=__webpack_require__("./src/redux/actions/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),Button=__webpack_require__("./src/components/Button/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),ToggleElementButton=__webpack_require__("./src/components/ModularComponents/ToggleElementButton/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),dataElement=__webpack_require__("./src/constants/dataElement.js"),selectors=__webpack_require__("./src/redux/selectors/index.js"),useFocusHandler=__webpack_require__("./src/hooks/useFocusHandler/index.js");const TabOptionsFlyout=props=>{const{sheetId,handleClick,sheetCount,disabled}=props,dispatch=(0,es.wA)(),flyoutSelector=`${dataElement.A.SHEET_TAB_OPTIONS_FLYOUT}-${sheetId}`,currentFlyout=(0,es.d4)((state=>selectors.A.getFlyout(state,flyoutSelector))),handleRenameWithFocus=(0,useFocusHandler.A)((e=>handleClick("Rename",e))),handleDeleteWithFocus=(0,useFocusHandler.A)((e=>handleClick("Delete",e)));return(0,react.useLayoutEffect)((()=>{const noteStateFlyout={dataElement:flyoutSelector,className:"TabOptionsFlyout",items:[{label:"action.rename",title:"action.rename",option:"Rename",dataElement:"sheetTabRenameOption",onClick:handleRenameWithFocus},{label:"action.delete",title:"action.delete",option:"Delete",dataElement:"sheetTabDeleteOption",onClick:handleDeleteWithFocus,disabled:1===sheetCount||disabled}]};dispatch(currentFlyout?actions.A.updateFlyout(noteStateFlyout.dataElement,noteStateFlyout):actions.A.addFlyout(noteStateFlyout))}),[sheetCount,disabled,handleClick]),null};TabOptionsFlyout.propTypes={sheetId:prop_types_default().string,handleClick:prop_types_default().func,sheetCount:prop_types_default().number,disabled:prop_types_default().bool};const SpreadsheetSwitcher_TabOptionsFlyout=TabOptionsFlyout,TabOptions=props=>{const{handleClick=()=>{},id,onToggle,label,disabled,sheetCount}=props,[t]=(0,useTranslation.B)();return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(ToggleElementButton.A,{dataElement:`options-${id}`,title:`${t("option.searchPanel.moreOptions")} ${label}`,img:"icon-tools-more-vertical",onToggle:isActive=>{isActive&&onToggle(label)},disabled,toggleElement:`${dataElement.A.SHEET_TAB_OPTIONS_FLYOUT}-${id}`}),(0,jsx_runtime.jsx)(SpreadsheetSwitcher_TabOptionsFlyout,{sheetId:id,sheetCount,handleClick:option=>handleClick(id,label,option),disabled})]})};TabOptions.propTypes={id:prop_types_default().string,label:prop_types_default().string,onToggle:prop_types_default().func,handleClick:prop_types_default().func,disabled:prop_types_default().bool,sheetCount:prop_types_default().number};const TabOptionsButton=TabOptions;TabOptions.__docgenInfo={description:"",methods:[],displayName:"TabOptions",props:{id:{description:"",type:{name:"string"},required:!1},label:{description:"",type:{name:"string"},required:!1},onToggle:{description:"",type:{name:"func"},required:!1},handleClick:{description:"",type:{name:"func"},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},sheetCount:{description:"",type:{name:"number"},required:!1}}};__webpack_require__("./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.scss");var useFocusOnClose=__webpack_require__("./src/hooks/useFocusOnClose/index.js");const propTypes={sheet:prop_types_default().any.isRequired,sheetCount:prop_types_default().number,activeSheetLabel:prop_types_default().string.isRequired,setLabelBeingEdited:prop_types_default().func.isRequired,setActiveSheet:prop_types_default().func.isRequired,renameSheet:prop_types_default().func.isRequired,deleteSheet:prop_types_default().func.isRequired,onClick:prop_types_default().func.isRequired,isEditMode:prop_types_default().bool.isRequired,validateName:prop_types_default().func,noRightBorder:prop_types_default().bool,isReadOnlyMode:prop_types_default().bool,skipDeleteWarning:prop_types_default().bool},SheetTab_SheetTab=({sheet,activeSheetLabel,onClick,sheetCount,setLabelBeingEdited,setActiveSheet,isEditMode,noRightBorder,validateName,isReadOnlyMode,deleteSheet,renameSheet,skipDeleteWarning})=>{const{sheetIndex,name:label,disabled}=sheet,isActive=label===activeSheetLabel,[inputValue,setInputValue]=(0,react.useState)(""),[isInputError,setIsInputError]=(0,react.useState)(!1),{t}=(0,useTranslation.B)(),inputRef=(0,react.useRef)(),dispatch=(0,es.wA)();(0,react.useEffect)((()=>{inputValue&&inputRef.current&&inputRef.current.focus()}),[inputValue]);const onInputChange=e=>{const newLabel=e.target.value,isDuplicate=validateName(label,newLabel),isEmpty=""===newLabel.trim();setIsInputError(isDuplicate||isEmpty),setInputValue(newLabel)},onInputBlur=()=>{isInputError?(()=>{const warningKey=""===inputValue?"warning.sheetTabRenameIssueTwo":"warning.sheetTabRenameIssueOne",warning={message:t(`${warningKey}.message`),title:t(`${warningKey}.title`),confirmBtnText:t("action.ok"),onConfirm:()=>inputRef.current.focus(),onCancel:()=>{setLabelBeingEdited(!1),setIsInputError(!1),setInputValue(label)}};dispatch(actions.A.showWarningMessage(warning))})():(renameSheet(label,inputValue),setLabelBeingEdited(null),setIsInputError(!1),setInputValue(""))},handleInputBlurWithFocusTransfer=(0,useFocusOnClose.A)(onInputBlur,"addTabButton"),onKeyDown=e=>{"Enter"!==e.key||isInputError||handleInputBlurWithFocusTransfer()},handleTabOptionSelection=(id,sheetName,option)=>{if("Rename"===option)setInputValue(text=sheetName),setIsInputError(!1),setLabelBeingEdited(text);else if("Delete"===option){if(skipDeleteWarning)return deleteSheet(label);const warning={message:t("warning.sheetTabDeleteMessage.message"),title:t("warning.sheetTabDeleteMessage.title"),confirmBtnText:t("action.ok"),secondaryBtnText:t("action.cancel"),onConfirm:()=>{deleteSheet(label)}};dispatch(actions.A.showWarningMessage(warning))}var text};let component=null;return component=isEditMode?(0,jsx_runtime.jsx)("input",{type:"text",className:classnames_default()("sheet-input",{"input-error":isInputError}),ref:inputRef,value:inputValue,onChange:onInputChange,onBlur:onInputBlur,onKeyDown,"aria-invalid":isInputError}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.A,{role:"tab",ariaSelected:isActive,ariaLabel:label,className:"sheet-label",onClick:e=>onClick(e,label,sheetIndex),title:label,label,useI18String:!1,disabled}),(0,jsx_runtime.jsx)("div",{className:"sheet-options",children:(0,jsx_runtime.jsx)(TabOptionsButton,{id:label?.replace(/\s+/g,"-").toLowerCase(),label,sheetCount,onToggle:name=>{return newActiveLabel=name,tabIndex=sheetIndex,setLabelBeingEdited(null),setIsInputError(!1),void setActiveSheet(newActiveLabel,tabIndex);var newActiveLabel,tabIndex},handleClick:handleTabOptionSelection,disabled:isReadOnlyMode})})]}),(0,jsx_runtime.jsx)("div",{className:classnames_default()({active:isActive,"no-left-border":noRightBorder,disabled},"sheet-tab"),children:(0,jsx_runtime.jsx)("div",{className:classnames_default()({"input-mode":isEditMode},"tab-body"),children:component})})};SheetTab_SheetTab.propTypes=propTypes;const SpreadsheetSwitcher_SheetTab_SheetTab=react.memo(SheetTab_SheetTab);SheetTab_SheetTab.__docgenInfo={description:"",methods:[],displayName:"SheetTab",props:{sheet:{description:"",type:{name:"any"},required:!0},sheetCount:{description:"",type:{name:"number"},required:!1},activeSheetLabel:{description:"",type:{name:"string"},required:!0},setLabelBeingEdited:{description:"",type:{name:"func"},required:!0},setActiveSheet:{description:"",type:{name:"func"},required:!0},renameSheet:{description:"",type:{name:"func"},required:!0},deleteSheet:{description:"",type:{name:"func"},required:!0},onClick:{description:"",type:{name:"func"},required:!0},isEditMode:{description:"",type:{name:"bool"},required:!0},validateName:{description:"",type:{name:"func"},required:!1},noRightBorder:{description:"",type:{name:"bool"},required:!1},isReadOnlyMode:{description:"",type:{name:"bool"},required:!1},skipDeleteWarning:{description:"",type:{name:"bool"},required:!1}}}},"./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>SpreadsheetEditor_SpreadsheetSwitcher_SpreadsheetSwitcher});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),useWindowsDimensions=__webpack_require__("./src/helpers/useWindowsDimensions.js"),Button=__webpack_require__("./src/components/Button/index.js"),ToggleElementButton=__webpack_require__("./src/components/ModularComponents/ToggleElementButton/index.js"),Icon=__webpack_require__("./src/components/Icon/index.js"),dataElement=__webpack_require__("./src/constants/dataElement.js"),spreadsheetEditor=__webpack_require__("./src/constants/spreadsheetEditor.js"),selectors=__webpack_require__("./src/redux/selectors/index.js"),actions=__webpack_require__("./src/redux/actions/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types);const AdditionalTabsFlyout=props=>{const{id="",additionalTabs,tabsForReference,onClick,activeItem}=props,dispatch=(0,es.wA)(),currentFlyout=(0,es.d4)((state=>selectors.A.getFlyout(state,id)));return(0,react.useLayoutEffect)((()=>{const noteStateFlyout={dataElement:id,className:"AdditionalTabsFlyout",items:additionalTabs.map((item=>{const tabLabel=item.name;return{label:tabLabel,title:tabLabel,option:tabLabel,disabled:item.disabled,isActive:tabLabel===activeItem,dataElement:Symbol(tabLabel).toString(),onClick:()=>onClick(tabLabel,item.sheetIndex)}}))};dispatch(currentFlyout?actions.A.updateFlyout(noteStateFlyout.dataElement,noteStateFlyout):actions.A.addFlyout(noteStateFlyout))}),[tabsForReference,activeItem]),null};AdditionalTabsFlyout.propTypes={id:prop_types_default().string,additionalTabs:prop_types_default().arrayOf(prop_types_default().shape({name:prop_types_default().string,sheetIndex:prop_types_default().number,disabled:prop_types_default().bool})),tabsForReference:prop_types_default().array,onClick:prop_types_default().func,activeItem:prop_types_default().string};const SpreadsheetSwitcher_AdditionalTabsFlyout=AdditionalTabsFlyout;var SheetTab=__webpack_require__("./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.js"),useArrowNavigation=(__webpack_require__("./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.scss"),__webpack_require__("./src/hooks/useArrowNavigation/index.js"));const SpreadsheetSwitcher_SpreadsheetSwitcher=props=>{const{tabs=[],activeSheetIndex=0,setActiveSheet,createNewSheet,deleteSheet,renameSheet,validateName,skipDeleteWarning=!1}=props,activeSheetLabel=tabs.find((tab=>tab.sheetIndex===activeSheetIndex))?.name||"",{width}=(0,useWindowsDimensions.A)(),breakpoint=(0,react.useMemo)((()=>Math.floor((width-80)/170)),[width]),{t}=(0,useTranslation.B)(),[labelBeingEdited,setLabelBeingEdited]=(0,react.useState)(""),isReadOnlyMode=(0,es.d4)(selectors.A.getSpreadsheetEditorEditMode)===spreadsheetEditor.xF.VIEW_ONLY,updateActiveTab=(newActiveLabel,tabIndex)=>{setLabelBeingEdited(null),setActiveSheet(newActiveLabel,tabIndex)},handleTabNameClick=(e,label,index)=>{e.preventDefault(),e.stopPropagation(),updateActiveTab(label,index)},[slicedTabs,flyoutTabs]=(0,react.useMemo)((()=>[tabs.slice(0,breakpoint),tabs.slice(breakpoint)]),[tabs,breakpoint]),tabListRef=(0,react.useRef)(),{currentFocusIndex}=(0,useArrowNavigation.A)(tabListRef,[slicedTabs,labelBeingEdited]),tabElements=slicedTabs.map(((item,i)=>(0,jsx_runtime.jsx)(SheetTab.A,{sheet:item,sheetCount:tabs.length,activeSheetLabel,onClick:handleTabNameClick,isEditMode:labelBeingEdited===item.name,setLabelBeingEdited,setActiveSheet,deleteSheet,renameSheet,noRightBorder:tabs[item.sheetIndex+1]&&tabs[item.sheetIndex+1].name===activeSheetLabel,validateName,isReadOnlyMode,skipDeleteWarning,tabIndex:currentFocusIndex===i?0:-1},item.sheetIndex))),isActiveSheetInFlyout=(0,react.useMemo)((()=>flyoutTabs.some((item=>item.name===activeSheetLabel))),[flyoutTabs,activeSheetLabel]);return(0,jsx_runtime.jsx)("div",{className:"SpreadsheetSwitcher ModularHeader BottomHeader stroke start",children:(0,jsx_runtime.jsxs)("div",{className:"GenericFileTab",role:"tablist",ref:tabListRef,children:[tabElements,flyoutTabs?.length>0?(0,jsx_runtime.jsx)(ToggleElementButton.A,{className:"dropdown-menu tab-dropdown-button",dataElement:"tabTrigger",title:t("message.showMore"),toggleElement:dataElement.A.ADDITIONAL_SPREADSHEET_TABS_MENU,label:flyoutTabs.length.toString(),children:isActiveSheetInFlyout&&(0,jsx_runtime.jsx)(Icon.A,{glyph:"icon-active-indicator"})}):null,(0,jsx_runtime.jsx)(Button.A,{className:"add-sheet-tab",title:"action.addSheet",img:"icon-menu-add",onClick:createNewSheet,dataElement:"addTabButton",label:"",ariaLabel:t("action.addSheet"),disabled:isReadOnlyMode}),flyoutTabs?.length>0&&(0,jsx_runtime.jsx)(SpreadsheetSwitcher_AdditionalTabsFlyout,{id:dataElement.A.ADDITIONAL_SPREADSHEET_TABS_MENU,additionalTabs:flyoutTabs,tabsForReference:tabs,onClick:updateActiveTab,activeItem:activeSheetLabel})]})})};SpreadsheetSwitcher_SpreadsheetSwitcher.propTypes={tabs:prop_types_default().arrayOf(prop_types_default().shape({name:prop_types_default().string,sheetIndex:prop_types_default().number,disabled:prop_types_default().bool})),activeSheetIndex:prop_types_default().number,setActiveSheet:prop_types_default().func,createNewSheet:prop_types_default().func,deleteSheet:prop_types_default().func,renameSheet:prop_types_default().func,skipDeleteWarning:prop_types_default().bool,validateName:prop_types_default().func};const SpreadsheetEditor_SpreadsheetSwitcher_SpreadsheetSwitcher=SpreadsheetSwitcher_SpreadsheetSwitcher;SpreadsheetSwitcher_SpreadsheetSwitcher.__docgenInfo={description:"",methods:[],displayName:"SpreadsheetSwitcher",props:{tabs:{description:"",type:{name:"arrayOf",value:{name:"shape",value:{name:{name:"string",required:!1},sheetIndex:{name:"number",required:!1},disabled:{name:"bool",required:!1}}}},required:!1},activeSheetIndex:{description:"",type:{name:"number"},required:!1},setActiveSheet:{description:"",type:{name:"func"},required:!1},createNewSheet:{description:"",type:{name:"func"},required:!1},deleteSheet:{description:"",type:{name:"func"},required:!1},renameSheet:{description:"",type:{name:"func"},required:!1},skipDeleteWarning:{description:"",type:{name:"bool"},required:!1},validateName:{description:"",type:{name:"func"},required:!1}}}},"./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>SpreadsheetEditor_SpreadsheetSwitcher});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),core=__webpack_require__("./src/core/index.js"),SpreadsheetSwitcher=__webpack_require__("./src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.js"),useOnDocumentUnloaded=__webpack_require__("./src/hooks/useOnDocumentUnloaded/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),useFocusOnClose=__webpack_require__("./src/hooks/useFocusOnClose/index.js");const ERROR="SpreadsheetEditorDocument is not loaded";let NEW_SPREADSHEET_NUMBER=2;function SpreadsheetSwitcherContainer(props){const{t}=(0,useTranslation.B)(),[sheets,setSheets]=(0,react.useState)([]),[activeSheetIndex,setActiveSheetIndex]=(0,react.useState)(0);(0,react.useEffect)((()=>{const onSpreadsheetEditorSheetStateChanged=event=>{setSheets(event.getVisibleSheets()),setActiveSheetIndex(event.getActiveSheetIndex())},onSpreadsheetEditorSheetChanged=event=>{setActiveSheetIndex(event.getSheetIndex())},onSpreadsheetEditorReady=()=>{const workbookInstance=core.A.getDocumentViewer().getDocument().getSpreadsheetEditorDocument().getWorkbook();workbookInstance&&setSheets((workbookInstance=>{let sheetCount=workbookInstance.sheetCount;const sheetArray=[];for(let i=0;i<sheetCount;i++){const sheet=workbookInstance.getSheetAt(i);sheetArray.push({name:sheet.name,sheetIndex:i})}return sheetArray})(workbookInstance))};return core.A.addEventListener("activeSheetChanged",onSpreadsheetEditorSheetChanged),core.A.addEventListener("spreadsheetEditorReady",onSpreadsheetEditorReady),core.A.addEventListener("sheetChanged",onSpreadsheetEditorSheetStateChanged),()=>{core.A.removeEventListener("sheetChanged",onSpreadsheetEditorSheetStateChanged),core.A.removeEventListener("spreadsheetEditorReady",onSpreadsheetEditorReady),core.A.removeEventListener("activeSheetChanged",onSpreadsheetEditorSheetChanged)}}),[]);const handleDocumentUnloaded=(0,react.useCallback)((()=>{setSheets([]),setActiveSheetIndex(0)}),[]);(0,useOnDocumentUnloaded.A)(handleDocumentUnloaded);const ownProps={...props,tabs:sheets,activeSheetIndex,setActiveSheet:(name,index)=>{const workbook=core.A.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();if(!workbook)return console.error(ERROR);workbook.getSheetAt(index)&&(workbook.setActiveSheet(index),setActiveSheetIndex(index))},createNewSheet:()=>{const workbook=core.A.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();if(!workbook)return console.error(ERROR);let newName=t("spreadsheetEditor.blankSheet"),isNameUnique=!workbook.getSheet(newName);for(;!isNameUnique;)newName=`${t("spreadsheetEditor.blankSheet")} ${NEW_SPREADSHEET_NUMBER++}`,isNameUnique=!workbook.getSheet(newName);workbook.createSheet(newName)},deleteSheet:(0,useFocusOnClose.A)((name=>{const workbook=core.A.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();if(!workbook)return console.error(ERROR);workbook.getSheet(name)&&workbook.removeSheet(name)}),"addTabButton"),renameSheet:(oldName,newName)=>{const workbook=core.A.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();if(!workbook)return console.error(ERROR);const sheet=workbook.getSheet(oldName);sheet&&(sheet.name=newName)},validateName:(currentName,newName)=>{const workbook=core.A.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();return workbook?currentName!==newName&&!!workbook.getSheet(newName):(console.error(ERROR),!1)}};return(0,jsx_runtime.jsx)(SpreadsheetSwitcher.A,{...ownProps})}SpreadsheetSwitcherContainer.propTypes={};const SpreadsheetSwitcher_SpreadsheetSwitcherContainer=SpreadsheetSwitcherContainer;SpreadsheetSwitcherContainer.__docgenInfo={description:"",methods:[],displayName:"SpreadsheetSwitcherContainer"};const SpreadsheetEditor_SpreadsheetSwitcher=SpreadsheetSwitcher_SpreadsheetSwitcherContainer}}]);