(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[79542],{"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ColorPickerOverlay/ColorPickerOverlay.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".open.ColorPickerOverlay{visibility:visible}.closed.ColorPickerOverlay{visibility:hidden}:host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.ColorPickerOverlay{position:absolute;z-index:70;justify-content:center;align-items:center}.ColorPickerOverlay:empty{padding:0}.ColorPickerOverlay .buttons{display:flex}.ColorPickerOverlay .Button{margin:4px;width:32px;height:32px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ColorPickerOverlay .Button{width:42px;height:42px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ColorPickerOverlay .Button{width:42px;height:42px}}.ColorPickerOverlay .Button:hover{background:var(--popup-button-hover)}.ColorPickerOverlay .Button:hover:disabled{background:none}.ColorPickerOverlay .Button .Icon{width:18px;height:18px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ColorPickerOverlay .Button .Icon{width:24px;height:24px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ColorPickerOverlay .Button .Icon{width:24px;height:24px}}.is-vertical.ColorPickerOverlay .Button.main-menu-button{width:100%;border-radius:0;justify-content:flex-start;padding-inline-start:var(--padding-small);padding-inline-end:var(--padding-small);margin:0 0 var(--padding-tiny) 0}.is-vertical.ColorPickerOverlay .Button.main-menu-button:first-child{margin-top:var(--padding-tiny)}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .is-vertical.ColorPickerOverlay .Button.main-menu-button{width:100%;height:32px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .is-vertical.ColorPickerOverlay .Button.main-menu-button{width:100%;height:32px}}.is-vertical.ColorPickerOverlay .Button.main-menu-button .Icon{margin-inline-end:10px}.is-vertical.ColorPickerOverlay .Button.main-menu-button span{white-space:nowrap}@keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}.ColorPickerOverlay{border-radius:4px;box-shadow:0 0 3px 0 var(--document-box-shadow);background:var(--component-background);display:flex;flex-direction:column;padding:16px;z-index:115}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/FilePickerHandler/FilePickerHandler.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".FilePickerHandler{display:none}",""]),module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/PresetButton/PresetButton.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.PresetButton:hover{background:var(--tools-button-hover)}.PresetButton.contentEditButton.active,.PresetButton.formFieldEditButton.active{background:var(--tools-button-active);color:var(--view-header-icon-active-fill);cursor:default}.PresetButton.contentEditButton.active .Icon,.PresetButton.formFieldEditButton.active .Icon{color:var(--view-header-icon-active-fill)}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/PresetButton/buttons/SheetEditor/SheetEditor.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".CellAdjustment .flyout-item-label,.CellTextAlignment .flyout-item-label{text-transform:none!important}.CellAdjustment{min-width:250px!important}.CellTextAlignment{min-width:200px!important}.CellFormat{min-width:300px!important}",""]),module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/ToggleElementButton/ToggleElementButton.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.ToggleElementButton .Button:hover:not(:disabled){cursor:pointer;border:none;box-shadow:inset 0 0 0 1px var(--blue-6);color:var(--blue-6);background-color:var(--faded-component-background)}.ToggleElementButton .Button.active{border:none;box-shadow:inset 0 0 0 1px var(--blue-5);color:var(--blue-5);background-color:var(--faded-component-background)}.ToggleElementButton .Button.active .Icon{color:var(--blue-5)}.ToggleElementButton .Button{width:auto;min-width:32px;height:32px;padding:5px}.ToggleElementButton .Button.active{cursor:default}.ToggleElementButton .Button.active .Icon{color:var(--view-header-icon-active-fill)}.ToggleElementButton .Button.active .Icon svg path:not(.no-fill){fill:var(--view-header-icon-active-fill)}.ToggleElementButton.legacy-ui .Button:hover:not(:disabled){border:none;box-shadow:none;background-color:var(--blue-1)}.ToggleElementButton.is-mobile .Button.modular-ui.icon-only:hover:not(:disabled):not(.active){background-color:transparent;background-color:initial;color:#000;color:initial;box-shadow:none}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/MultiViewer/MultiViewerWrapper/MultiViewerWrapper.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,"",""]),module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/PasswordModal/PasswordModal.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".open.PasswordModal{visibility:visible}.closed.PasswordModal{visibility:hidden}:host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.PasswordModal .footer .modal-button.confirm:hover{background:var(--primary-button-hover);border-color:var(--primary-button-hover);color:var(--gray-0)}.PasswordModal .footer .modal-button.confirm{background:var(--primary-button);border-color:var(--primary-button);color:var(--primary-button-text)}.PasswordModal .footer .modal-button.confirm.disabled{cursor:default;background:var(--disabled-button-color);color:var(--primary-button-text)}.PasswordModal .footer .modal-button.confirm.disabled span{color:var(--primary-button-text)}.PasswordModal .footer .modal-button.cancel:hover,.PasswordModal .footer .modal-button.secondary-btn-custom:hover{border:none;box-shadow:inset 0 0 0 1px var(--blue-6);color:var(--blue-6)}.PasswordModal .footer .modal-button.cancel,.PasswordModal .footer .modal-button.secondary-btn-custom{border:none;box-shadow:inset 0 0 0 1px var(--primary-button);color:var(--primary-button)}.PasswordModal .footer .modal-button.cancel.disabled,.PasswordModal .footer .modal-button.secondary-btn-custom.disabled{cursor:default;border:none;box-shadow:inset 0 0 0 1px rgba(43,115,171,.5);color:rgba(43,115,171,.5)}.PasswordModal .footer .modal-button.cancel.disabled span,.PasswordModal .footer .modal-button.secondary-btn-custom.disabled span{color:rgba(43,115,171,.5)}.PasswordModal{position:fixed;inset-inline-start:0;inset-block-end:0;z-index:100;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:var(--modal-negative-space)}.PasswordModal .modal-container .wrapper .modal-content{padding:10px}.PasswordModal .footer{display:flex;flex-direction:row;justify-content:flex-end;width:100%;margin-top:13px}.PasswordModal .footer.modal-footer{padding:16px;margin:0;border-top:1px solid var(--divider)}.PasswordModal .footer .modal-button{display:flex;justify-content:center;align-items:center;padding:6px 18px;margin:8px 0 0;width:auto;width:-moz-fit-content;width:fit-content;border-radius:4px;height:30px;cursor:pointer}.PasswordModal .footer .modal-button.confirm{margin-inline-start:4px}.PasswordModal .footer .modal-button.secondary-btn-custom{border-radius:4px;padding:2px 20px 4px;cursor:pointer}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .PasswordModal .footer .modal-button{padding:23px 8px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .PasswordModal .footer .modal-button{padding:23px 8px}}.PasswordModal .swipe-indicator{background:var(--swipe-indicator-bg);border-radius:2px;height:4px;width:38px;position:absolute;inset-block-start:12px;margin-inline-start:auto;margin-inline-end:auto;inset-inline-start:0;inset-inline-end:0}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .PasswordModal .swipe-indicator{display:none}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .PasswordModal .swipe-indicator{display:none}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .PasswordModal .swipe-indicator{width:32px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .PasswordModal .swipe-indicator{width:32px}}.PasswordModal .modal-container{width:480px}.PasswordModal .modal-container .wrapper form{padding:16px;font-size:14px}.PasswordModal .modal-container .wrapper .incorrect-password{margin-top:6px;font-size:13px;color:#cf0101}.PasswordModal .modal-container .wrapper .modal-button{margin-top:0}.PasswordModal .modal-container .wrapper .error-modal-content{padding:2px 16px}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./src/components/ColorPickerOverlay/ColorPickerOverlay.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-redux/es/index.js"),react_dom__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-dom/index.js"),selectors__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/redux/selectors/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_12__),components_DataElementWrapper__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/DataElementWrapper/index.js"),components_ColorPalette__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/components/ColorPalette/index.js"),actions__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/redux/actions/index.js"),hooks_useOnClickOutside__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/hooks/useOnClickOutside.js"),helpers_getOverlayPositionBasedOn__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./src/helpers/getOverlayPositionBasedOn.js"),constants_dataElement__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/constants/dataElement.js"),classnames__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_10__),helpers_getRootNode__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./src/helpers/getRootNode.js");__webpack_require__("./src/components/ColorPickerOverlay/ColorPickerOverlay.scss");const propTypes={color:prop_types__WEBPACK_IMPORTED_MODULE_12___default().object,onStyleChange:prop_types__WEBPACK_IMPORTED_MODULE_12___default().func,toggleButtonDataElement:prop_types__WEBPACK_IMPORTED_MODULE_12___default().string,portalElementId:prop_types__WEBPACK_IMPORTED_MODULE_12___default().string},ColorPickerOverlay=({color,onStyleChange,toggleButtonDataElement,portalElementId="app"})=>{const[position,setPosition]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((()=>({left:"555px",right:"auto",top:"auto"}))),overlayRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),[isOpen]=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.d4)((state=>[selectors__WEBPACK_IMPORTED_MODULE_4__.A.isElementOpen(state,constants_dataElement__WEBPACK_IMPORTED_MODULE_9__.A.OFFICE_EDITOR_COLOR_PICKER_OVERLAY)])),headerButtonDataElement=toggleButtonDataElement||constants_dataElement__WEBPACK_IMPORTED_MODULE_9__.A.OFFICE_EDITOR_TEXT_COLOR_BUTTON,flyoutButtonDataElement=toggleButtonDataElement||constants_dataElement__WEBPACK_IMPORTED_MODULE_9__.A.OFFICE_EDITOR_FLYOUT_COLOR_PICKER,dispatch=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.wA)(),onClose=()=>dispatch(actions__WEBPACK_IMPORTED_MODULE_7__.A.closeElements([constants_dataElement__WEBPACK_IMPORTED_MODULE_9__.A.OFFICE_EDITOR_COLOR_PICKER_OVERLAY]));return(0,hooks_useOnClickOutside__WEBPACK_IMPORTED_MODULE_8__.A)(overlayRef,(e=>{const headerButton=(0,helpers_getRootNode__WEBPACK_IMPORTED_MODULE_13__.Ay)().querySelector(`[data-element="${headerButtonDataElement}"]`),flyoutButton=(0,helpers_getRootNode__WEBPACK_IMPORTED_MODULE_13__.Ay)().querySelector(`[data-element="${flyoutButtonDataElement}"]`);headerButton?.contains(e.target)||flyoutButton?.contains(e.target)||onClose()})),(0,react__WEBPACK_IMPORTED_MODULE_1__.useLayoutEffect)((()=>{if(isOpen){const onResize=()=>{const overlayPosition=(0,helpers_getOverlayPositionBasedOn__WEBPACK_IMPORTED_MODULE_14__.A)(headerButtonDataElement,overlayRef);setPosition(overlayPosition)};return onResize(),window.addEventListener("resize",onResize),()=>window.removeEventListener("resize",onResize)}}),[isOpen]),isOpen?(0,react_dom__WEBPACK_IMPORTED_MODULE_3__.createPortal)((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(components_DataElementWrapper__WEBPACK_IMPORTED_MODULE_5__.A,{"data-element":constants_dataElement__WEBPACK_IMPORTED_MODULE_9__.A.OFFICE_EDITOR_COLOR_PICKER_OVERLAY,className:classnames__WEBPACK_IMPORTED_MODULE_10___default()({ColorPickerOverlay:!0,Popup:!0,open:isOpen,closed:!isOpen}),style:position,ref:overlayRef,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(components_ColorPalette__WEBPACK_IMPORTED_MODULE_6__.A,{color,property:"TextColor",onStyleChange,hasInitialFocus:!0,useMobileMinMaxWidth:!0,onClose})}),(0,helpers_getRootNode__WEBPACK_IMPORTED_MODULE_13__.Ay)().getElementById(portalElementId)):null};ColorPickerOverlay.propTypes=propTypes;const __WEBPACK_DEFAULT_EXPORT__=ColorPickerOverlay},"./src/components/ColorPickerOverlay/ColorPickerOverlay.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ColorPickerOverlay/ColorPickerOverlay.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/ColorPickerOverlay/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./src/components/ColorPickerOverlay/ColorPickerOverlay.js").A},"./src/components/FilePickerHandler/FilePickerHandler.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/FilePickerHandler/FilePickerHandler.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/ModularComponents/OfficeEditor/OfficeEditorInsertImageButton/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>OfficeEditor_OfficeEditorInsertImageButton});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),FlyoutItemContainer=__webpack_require__("./src/components/ModularComponents/FlyoutItemContainer/index.js"),openOfficeEditorFilePicker=__webpack_require__("./src/helpers/openOfficeEditorFilePicker.js"),OfficeEditorImageFilePickerHandler=__webpack_require__("./src/components/OfficeEditorImageFilePickerHandler/index.js"),ActionButton=__webpack_require__("./src/components/ActionButton/index.js"),menuItems=__webpack_require__("./src/components/ModularComponents/Helpers/menuItems.js"),customizationVariables=__webpack_require__("./src/constants/customizationVariables.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames);const OfficeEditorInsertImageButton=(0,react.forwardRef)(((props,ref)=>{const menuItem=menuItems.W[customizationVariables.dQ.INSERT_IMAGE],{isFlyoutItem,style,className,dataElement=menuItem.dataElement,img:icon=menuItem.icon,title=props.title||menuItem.title}=props,{label}=menuItem,handleClick=()=>{(0,openOfficeEditorFilePicker.A)()};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,label,ref,onClickHandler:()=>handleClick}):(0,jsx_runtime.jsx)(ActionButton.A,{className:classnames_default()({"button-text-icon":!0,[className]:!0}),dataElement,title,img:icon,label,onClick:handleClick,style}),(0,jsx_runtime.jsx)(OfficeEditorImageFilePickerHandler.A,{})]})}));OfficeEditorInsertImageButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,style:prop_types_default().object,className:prop_types_default().string,img:prop_types_default().string,title:prop_types_default().string},OfficeEditorInsertImageButton.displayName="InsertImageButton";const OfficeEditorInsertImageButton_OfficeEditorInsertImageButton=OfficeEditorInsertImageButton;OfficeEditorInsertImageButton.__docgenInfo={description:"",methods:[],displayName:"InsertImageButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},className:{description:"",type:{name:"string"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};const OfficeEditor_OfficeEditorInsertImageButton=OfficeEditorInsertImageButton_OfficeEditorInsertImageButton},"./src/components/ModularComponents/PresetButton/PresetButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>ModularComponents_PresetButton_PresetButton});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),customizationVariables=__webpack_require__("./src/constants/customizationVariables.js"),officeEditor=__webpack_require__("./src/constants/officeEditor.js"),spreadsheetEditor=__webpack_require__("./src/constants/spreadsheetEditor.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),helpers_officeEditor=__webpack_require__("./src/helpers/officeEditor.js"),loadDocument=__webpack_require__("./src/helpers/loadDocument.js"),menuItems=__webpack_require__("./src/components/ModularComponents/Helpers/menuItems.js"),FlyoutItemContainer=__webpack_require__("./src/components/ModularComponents/FlyoutItemContainer/index.js");const NewDocumentButton=react.forwardRef(((props,ref)=>{const{isFlyoutItem,dataElement,className,style,img:icon,title}=props,isDisabled=!(0,helpers_officeEditor.pb)(),dispatch=(0,es.wA)();if(isDisabled){if(isFlyoutItem)return null;console.warn("The new document preset button is only available if the Office Editor mode is enabled.")}const handleNewDocumentClick=async()=>{(0,loadDocument.A)(dispatch,null,{filename:"Untitled.docx",enableOfficeEditing:!0})};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleNewDocumentClick}):(0,menuItems.c)({buttonType:customizationVariables.dQ.NEW_DOCUMENT,isDisabled,onClick:handleNewDocumentClick,dataElement,className,style,icon,title})}));NewDocumentButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},NewDocumentButton.displayName="NewDocumentButton";const NewDocument=NewDocumentButton;NewDocumentButton.__docgenInfo={description:"A button that creates a new document.\n@name newDocumentButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"NewDocumentButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var selectors=__webpack_require__("./src/redux/selectors/index.js"),openFilePicker=__webpack_require__("./src/helpers/openFilePicker.js"),constants_dataElement=__webpack_require__("./src/constants/dataElement.js");const FilePickerButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,dataElement,className,style,img:icon,title}=props,isDisabled=(0,es.d4)((state=>selectors.A.isElementDisabled(state,constants_dataElement.A.FILE_PICKER_BUTTON)));if(isDisabled){if(isFlyoutItem)return null;console.warn("The file picker preset button should be enabled with the enableFilePicker option in the WebViewer constructor.")}return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:openFilePicker.A}):(0,menuItems.c)({buttonType:customizationVariables.dQ.FILE_PICKER,isDisabled,onClick:openFilePicker.A,dataElement,className,style,icon,title})}));FilePickerButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},FilePickerButton.displayName="FilePickerButton";const FilePicker=FilePickerButton;FilePickerButton.__docgenInfo={description:"A button that allows the opening of a file as the document in the UI.\n@name filePickerButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"FilePickerButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var ActionButton=__webpack_require__("./src/components/ActionButton/index.js"),accessibility=__webpack_require__("./src/helpers/accessibility.js"),core=__webpack_require__("./src/core/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames);const UndoButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,style,className,dataElement=menuItems.W.undoButton.dataElement,img:icon=menuItems.W.undoButton.icon,title=menuItems.W.undoButton.title}=props,activeDocumentViewerKey=(0,es.d4)((state=>selectors.A.getActiveDocumentViewerKey(state))),canUndo=(0,es.d4)((state=>selectors.A.canUndo(state,activeDocumentViewerKey))),isOfficeEditorMode=(0,es.d4)((state=>selectors.A.getIsOfficeEditorMode(state))),isOfficeEditorUndoEnabled=(0,es.d4)((state=>selectors.A.isOfficeEditorUndoEnabled(state))),disabled=!isOfficeEditorMode&&!canUndo||isOfficeEditorMode&&!isOfficeEditorUndoEnabled,handleClick=()=>{if(isOfficeEditorMode)return core.A.getOfficeEditor().undo();core.A.undo(activeDocumentViewerKey)};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleClick,disabled}):(0,jsx_runtime.jsx)(ActionButton.A,{className:classnames_default()({PresetButton:!0,"undo-button":!0,[className]:!0}),dataElement,title,img:icon,onClick:handleClick,shouldPassActiveDocumentViewerKeyToOnClickHandler:!0,disabled,style,onClickAnnouncement:(0,accessibility.ey)(title)})}));UndoButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,style:prop_types_default().object,className:prop_types_default().string,img:prop_types_default().string,title:prop_types_default().string},UndoButton.displayName="UndoButton";const Undo=UndoButton;UndoButton.__docgenInfo={description:"A button that performs the undo action.\n@name undoButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"UndoButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},className:{description:"",type:{name:"string"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};const RedoButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,style,className,dataElement=menuItems.W.redoButton.dataElement,img:icon=menuItems.W.redoButton.icon,title=menuItems.W.redoButton.title}=props,activeDocumentViewerKey=(0,es.d4)((state=>selectors.A.getActiveDocumentViewerKey(state))),canRedo=(0,es.d4)((state=>selectors.A.canRedo(state,activeDocumentViewerKey))),isOfficeEditorMode=(0,es.d4)((state=>selectors.A.getIsOfficeEditorMode(state))),isOfficeEditorRedoEnabled=(0,es.d4)((state=>selectors.A.isOfficeEditorRedoEnabled(state))),disabled=!isOfficeEditorMode&&!canRedo||isOfficeEditorMode&&!isOfficeEditorRedoEnabled,handleClick=()=>{if(isOfficeEditorMode)return core.A.getOfficeEditor().redo();core.A.redo(activeDocumentViewerKey)};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleClick,disabled}):(0,jsx_runtime.jsx)(ActionButton.A,{className:classnames_default()({PresetButton:!0,"redo-button":!0,[className]:!0}),dataElement,title,img:icon,onClick:handleClick,shouldPassActiveDocumentViewerKeyToOnClickHandler:!0,disabled,style,onClickAnnouncement:(0,accessibility.ey)(title)})}));RedoButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,style:prop_types_default().object,className:prop_types_default().string,img:prop_types_default().string,title:prop_types_default().string},RedoButton.displayName="RedoButton";const Redo=RedoButton;RedoButton.__docgenInfo={description:"A button that performs the redo action.\n@name redoButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"RedoButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},className:{description:"",type:{name:"string"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var downloadPdf=__webpack_require__("./src/helpers/downloadPdf.js"),types=__webpack_require__("./src/constants/types.js"),useOnDocumentUnloaded=__webpack_require__("./src/hooks/useOnDocumentUnloaded/index.js");const DownloadButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,dataElement,className,style,img:icon,title}=props,[documentType,setDocumentType]=(0,react.useState)(null),dispatch=(0,es.wA)(),activeDocumentViewerKey=(0,es.d4)(selectors.A.getActiveDocumentViewerKey);(0,react.useEffect)((()=>{const onDocumentLoaded=viewerKey=>{const document=core.A.getDocument(viewerKey);setDocumentType(document?.getType()||null)};return onDocumentLoaded(activeDocumentViewerKey),core.A.addEventListener("documentLoaded",onDocumentLoaded),()=>core.A.removeEventListener("documentLoaded",onDocumentLoaded)}),[activeDocumentViewerKey]);const handleDocumentUnloaded=(0,react.useCallback)((()=>{setDocumentType(null)}),[]);(0,useOnDocumentUnloaded.A)(handleDocumentUnloaded);const isDownloadSupported=documentType&&!(documentType===types._.XOD||(0,helpers_officeEditor.pb)());if(!documentType||!isDownloadSupported){if(isFlyoutItem)return null;console.warn(documentType?"The download preset button is not available for XOD documents or Office Editor mode.":"The download preset button is not available because the document is not loaded.")}const handleClick=()=>{(0,downloadPdf.A)(dispatch,{},activeDocumentViewerKey)};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleClick}):(0,menuItems.c)({isDisabled:!isDownloadSupported,buttonType:customizationVariables.dQ.DOWNLOAD,onClick:handleClick,dataElement,className,style,icon,title})}));DownloadButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},DownloadButton.displayName="DownloadButton";const Download=DownloadButton;DownloadButton.__docgenInfo={description:"A button that downloads the current document.\n@name downloadButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"DownloadButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var toggleFullscreen=__webpack_require__("./src/helpers/toggleFullscreen.js");const FullScreenButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,dataElement,className,style,img:icon,title}=props,isFullScreen=(0,es.d4)((state=>selectors.A.isFullScreen(state))),label=isFullScreen?"action.exitFullscreen":"action.enterFullscreen";return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,label,ref,onClick:toggleFullscreen.A}):(0,menuItems.c)({buttonType:customizationVariables.dQ.FULLSCREEN,onClick:toggleFullscreen.A,isFullScreen,dataElement,className,style,icon,title})}));FullScreenButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},FullScreenButton.displayName="FullScreenButton";const FullScreen=FullScreenButton;FullScreenButton.__docgenInfo={description:"A button that toggles fullscreen mode.\n@name fullscreenButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"FullScreenButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var actions=__webpack_require__("./src/redux/actions/index.js"),useFocusHandler=__webpack_require__("./src/hooks/useFocusHandler/index.js");const SaveAsButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,dataElement,className,style,img:icon,title}=props,[documentType,setDocumentType]=(0,react.useState)(),dispatch=(0,es.wA)(),activeDocumentViewerKey=(0,es.d4)(selectors.A.getActiveDocumentViewerKey);(0,react.useEffect)((()=>{const onDocumentLoaded=viewerKey=>{const document=core.A.getDocument(viewerKey);setDocumentType(document?.getType()||null)};return onDocumentLoaded(activeDocumentViewerKey),core.A.addEventListener("documentLoaded",onDocumentLoaded),()=>core.A.removeEventListener("documentLoaded",onDocumentLoaded)}),[activeDocumentViewerKey]);const handleDocumentUnloaded=(0,react.useCallback)((()=>{setDocumentType(null)}),[]);(0,useOnDocumentUnloaded.A)(handleDocumentUnloaded);const handleSaveAsButtonClick=(0,useFocusHandler.A)((()=>{dispatch(actions.A.openElement(constants_dataElement.A.SAVE_MODAL))})),isDisabled=!documentType||documentType===types._.XOD;if(isDisabled){if(isFlyoutItem)return null;console.warn("The save as preset button is not available for XOD documents.")}return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleSaveAsButtonClick}):(0,menuItems.c)({buttonType:customizationVariables.dQ.SAVE_AS,isDisabled,onClick:handleSaveAsButtonClick,dataElement,className,style,icon,title})}));SaveAsButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},SaveAsButton.displayName="SaveAsButton";const SaveAs=SaveAsButton;SaveAsButton.__docgenInfo={description:"A button that opens the save as modal.\n@name saveAsButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"SaveAsButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var print=__webpack_require__("./src/helpers/print.js");const PrintButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,dataElement,className,style,img:icon,title}=props,dispatch=(0,es.wA)(),useClientSidePrint=(0,es.d4)(selectors.A.useClientSidePrint),isEmbedPrintSupported=(0,es.d4)(selectors.A.isEmbedPrintSupported),sortStrategy=(0,es.d4)(selectors.A.getSortStrategy),colorMap=(0,es.d4)(selectors.A.getColorMap),timezone=(0,es.d4)(selectors.A.getTimezone),activeDocumentViewerKey=(0,es.d4)(selectors.A.getActiveDocumentViewerKey),[document,setDocument]=(0,react.useState)(null);(0,react.useEffect)((()=>{const onDocumentLoaded=viewerKey=>{const document=core.A.getDocument(viewerKey);setDocument(document)};return onDocumentLoaded(activeDocumentViewerKey),core.A.addEventListener("documentLoaded",onDocumentLoaded),()=>core.A.removeEventListener("documentLoaded",onDocumentLoaded)}),[activeDocumentViewerKey]);const handleDocumentUnloaded=(0,react.useCallback)((()=>{setDocument(null)}),[]);(0,useOnDocumentUnloaded.A)(handleDocumentUnloaded);const handlePrintButtonClick=(0,useFocusHandler.A)((()=>{(0,print.y)(dispatch,useClientSidePrint,isEmbedPrintSupported,sortStrategy,colorMap,{isGrayscale:core.A.getDocumentViewer().isGrayscaleModeEnabled(),timezone})}));if(!document){if(isFlyoutItem)return null;console.warn("The print preset button is not available because no document is loaded.")}return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handlePrintButtonClick}):(0,menuItems.c)({buttonType:customizationVariables.dQ.PRINT,onClick:handlePrintButtonClick,isDisabled:!document,dataElement,className,style,icon,title})}));PrintButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},PrintButton.displayName="PrintButton";const Print=PrintButton;PrintButton.__docgenInfo={description:"A button that prints the document.\n@name printButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"PrintButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};const NewPortfolioButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,dataElement,className,style,img:icon,title}=props,dispatch=(0,es.wA)(),isCreatePortfolioButtonEnabled=!(0,es.d4)((state=>selectors.A.isElementDisabled(state,constants_dataElement.A.CREATE_PORTFOLIO_BUTTON)))&&core.A.isFullPDFEnabled(),handleCreatePortfolioButtonClick=(0,useFocusHandler.A)((()=>{dispatch(actions.A.openElement(constants_dataElement.A.CREATE_PORTFOLIO_MODAL))}));if(!isCreatePortfolioButtonEnabled){if(isFlyoutItem)return null;console.warn("The create portfolio preset button is not available for non-full PDF mode.")}return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleCreatePortfolioButtonClick}):(0,menuItems.c)({buttonType:customizationVariables.dQ.CREATE_PORTFOLIO,isDisabled:!isCreatePortfolioButtonEnabled,onClick:handleCreatePortfolioButtonClick,dataElement,className,style,icon,title})}));NewPortfolioButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},NewPortfolioButton.displayName="NewPortfolioButton";const NewPortfolio=NewPortfolioButton;NewPortfolioButton.__docgenInfo={description:"A button that opens the create portfolio modal.\n@name createPortfolioButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"NewPortfolioButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};const SettingsButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,dataElement,className,style,img:icon,title}=props,dispatch=(0,es.wA)(),handleClickWithFocus=(0,useFocusHandler.A)((()=>{dispatch(actions.A.openElement(constants_dataElement.A.SETTINGS_MODAL))}));return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleClickWithFocus}):(0,menuItems.c)({buttonType:customizationVariables.dQ.SETTINGS,onClick:handleClickWithFocus,dataElement,className,style,icon,title})}));SettingsButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},SettingsButton.displayName="SettingsButton";const Settings=SettingsButton;SettingsButton.__docgenInfo={description:"A button that opens the settings modal.\n@name settingsButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"SettingsButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};const FormFieldEditButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,style,className,dataElement=menuItems.W.formFieldEditButton.dataElement,img:icon=menuItems.W.formFieldEditButton.icon,title=menuItems.W.formFieldEditButton.title}=props,[active,setActive]=(0,react.useState)(core.A.getFormFieldCreationManager().isInFormFieldCreationMode());(0,react.useEffect)((()=>{const formFieldCreationManager=core.A.getFormFieldCreationManager();if(formFieldCreationManager){const updateState=()=>setActive(formFieldCreationManager.isInFormFieldCreationMode());return formFieldCreationManager.addEventListener("formFieldCreationModeStarted",updateState),formFieldCreationManager.addEventListener("formFieldCreationModeEnded",updateState),()=>{formFieldCreationManager.removeEventListener("formFieldCreationModeStarted",updateState),formFieldCreationManager.removeEventListener("formFieldCreationModeEnded",updateState)}}}),[]);const handleClick=()=>{const formFieldCreationManager=core.A.getFormFieldCreationManager();formFieldCreationManager.isInFormFieldCreationMode()?formFieldCreationManager.endFormFieldCreationMode():formFieldCreationManager.startFormFieldCreationMode()};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleClick}):(0,jsx_runtime.jsx)(ActionButton.A,{className:classnames_default()({PresetButton:!0,formFieldEditButton:!0,[className]:!0}),dataElement,title,img:icon,onClick:handleClick,isActive:active,style,ariaPressed:active,onClickAnnouncement:(0,accessibility.ey)(title)})}));FormFieldEditButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,style:prop_types_default().object,className:prop_types_default().string,img:prop_types_default().string,title:prop_types_default().string},FormFieldEditButton.displayName="FormFieldEditButton";const FormFieldEdit=FormFieldEditButton;FormFieldEditButton.__docgenInfo={description:"A button that toggles form field edit mode.\n@name formFieldEditButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"FormFieldEditButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},className:{description:"",type:{name:"string"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};const ContentEditButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,style,className,dataElement=menuItems.W.contentEditButton.dataElement,img:icon=menuItems.W.contentEditButton.icon,title=menuItems.W.contentEditButton.title}=props,areContentEditWorkersLoaded=(0,es.d4)((state=>selectors.A.areContentEditWorkersLoaded(state))),dispatch=(0,es.wA)(),[active,setActive]=(0,react.useState)(core.A.getContentEditManager().isInContentEditMode());(0,react.useEffect)((()=>{const contentEditManager=core.A.getContentEditManager();if(contentEditManager){const updateState=()=>setActive(contentEditManager.isInContentEditMode());return contentEditManager.addEventListener("contentEditModeStarted",updateState),contentEditManager.addEventListener("contentEditModeEnded",updateState),()=>{contentEditManager.removeEventListener("contentEditModeStarted",updateState),contentEditManager.removeEventListener("contentEditModeEnded",updateState)}}}),[]);const handleClick=()=>{const contentEditManager=core.A.getContentEditManager();contentEditManager.isInContentEditMode()?contentEditManager.endContentEditMode():(areContentEditWorkersLoaded||dispatch(actions.A.openElement(constants_dataElement.A.LOADING_MODAL)),contentEditManager.startContentEditMode(),setActive(!0),dispatch(actions.A.openElement(constants_dataElement.A.TEXT_EDITING_PANEL)))};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleClick}):(0,jsx_runtime.jsx)(ActionButton.A,{className:classnames_default()({PresetButton:!0,contentEditButton:!0,[className]:!0}),dataElement,title,img:icon,onClick:handleClick,isActive:active,style,ariaPressed:active,onClickAnnouncement:(0,accessibility.ey)(title)})}));ContentEditButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,style:prop_types_default().object,className:prop_types_default().string,img:prop_types_default().string,title:prop_types_default().string},ContentEditButton.displayName="ContentEditButton";const ContentEdit=ContentEditButton;ContentEditButton.__docgenInfo={description:"A button that toggles Content Edit Mode.\n@name contentEditButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"ContentEditButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},className:{description:"",type:{name:"string"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};const ToggleAccessibilityMode=(0,react.forwardRef)(((props,ref)=>{const dispatch=(0,es.wA)(),store=(0,es.Pj)(),{isFlyoutItem,dataElement,className,style,img:icon,title}=props,isAccessibleMode=(0,es.d4)(selectors.A.isAccessibleMode),shouldAddA11yContentToDOM=(0,es.d4)(selectors.A.shouldAddA11yContentToDOM),accessibleReadingOrderManager=core.A.getDocumentViewer()?.getAccessibleReadingOrderManager();(0,react.useEffect)((()=>{shouldAddA11yContentToDOM?accessibleReadingOrderManager?.startAccessibleReadingOrderMode():accessibleReadingOrderManager?.endAccessibleReadingOrderMode()}),[shouldAddA11yContentToDOM]);const onClick=()=>{store.getState().advanced.fullAPI||isAccessibleMode?dispatch(actions.A.setShouldAddA11yContentToDOM(!shouldAddA11yContentToDOM)):console.warn("FullAPI is required to use accessibility mode")};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick}):(0,menuItems.c)({buttonType:customizationVariables.dQ.TOGGLE_ACCESSIBILITY_MODE,onClick,isActive:shouldAddA11yContentToDOM,dataElement,className,style,icon,title})}));ToggleAccessibilityMode.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},ToggleAccessibilityMode.displayName="ToggleAccessibilityMode";const buttons_ToggleAccessibilityMode=ToggleAccessibilityMode;ToggleAccessibilityMode.__docgenInfo={description:"A button that toggles the accessibility mode on and off.\n@name toggleAccessibilityModeButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"ToggleAccessibilityMode",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var OfficeEditorInsertImageButton=__webpack_require__("./src/components/ModularComponents/OfficeEditor/OfficeEditorInsertImageButton/index.js");const propTypes={isIncreaseIndent:prop_types_default().bool.isRequired,isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,style:prop_types_default().object,className:prop_types_default().string,img:prop_types_default().string,title:prop_types_default().string},IndentButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,isIncreaseIndent,style,className}=props,menuItem=isIncreaseIndent?menuItems.W.increaseIndentButton:menuItems.W.decreaseIndentButton,{dataElement=menuItem.dataElement,img:icon=menuItem.icon,title=menuItem.title}=props,indentType=isIncreaseIndent?"increase":"decrease",handleClick=async()=>{isIncreaseIndent?await core.A.getOfficeEditor().increaseIndent():await core.A.getOfficeEditor().decreaseIndent()};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:async()=>{await handleClick()}}):(0,jsx_runtime.jsx)(ActionButton.A,{className:classnames_default()({PresetButton:!0,"indent-button":!0,[`${indentType}-indent-button`]:!0,[className]:className}),dataElement,title,img:icon,onClick:async()=>{await handleClick()},style},indentType)}));IndentButton.propTypes=propTypes,IndentButton.displayName="IndentButton";const OfficeEditor_IndentButton=IndentButton;IndentButton.__docgenInfo={description:"",methods:[],displayName:"IndentButton",props:{isIncreaseIndent:{description:"",type:{name:"bool"},required:!0},isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},className:{description:"",type:{name:"string"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var ToggleElementButton=__webpack_require__("./src/components/ModularComponents/ToggleElementButton/index.js"),ColorPickerOverlay=__webpack_require__("./src/components/ColorPickerOverlay/index.js"),Icon=__webpack_require__("./src/components/Icon/index.js");const ColorPickerButton_propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,img:prop_types_default().string,title:prop_types_default().string},ColorPickerButton=(0,react.forwardRef)(((props,ref)=>{const[activeColor]=(0,es.d4)((state=>[selectors.A.getActiveColor(state)]),es.bN),{isFlyoutItem,dataElement=menuItems.W.officeEditorColorPicker.dataElement,img:icon=menuItems.W.officeEditorColorPicker.icon,title=menuItems.W.officeEditorColorPicker.title}=props,dispatch=(0,es.wA)(),useColorIconBorder="rgba(255,255,255,1)"===activeColor.toString(),ariaLabel=activeColor.toHexString(),colorIcon=(0,jsx_runtime.jsx)(Icon.A,{dataElement,className:(useColorIconBorder?"icon-border":"")+" icon-text-color menu-icon",glyph:props.img||"icon-office-editor-circle",color:activeColor.toString(),ariaLabel});return(0,react.useEffect)((()=>()=>{dispatch(actions.A.closeElement(constants_dataElement.A.OFFICE_EDITOR_COLOR_PICKER_OVERLAY))}),[]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:()=>{dispatch(actions.A.toggleElement(constants_dataElement.A.OFFICE_EDITOR_COLOR_PICKER_OVERLAY))},icon:colorIcon}):(0,jsx_runtime.jsx)(ToggleElementButton.A,{dataElement,title,ariaLabel,img:icon,element:constants_dataElement.A.OFFICE_EDITOR_COLOR_PICKER_OVERLAY,color:activeColor.toString(),toggleElement:constants_dataElement.A.OFFICE_EDITOR_COLOR_PICKER_OVERLAY,iconClassName:(useColorIconBorder?"icon-border":"")+" icon-text-color"}),(0,jsx_runtime.jsx)(ColorPickerOverlay.A,{onStyleChange:(_,newColor)=>{const color={r:newColor.R,g:newColor.G,b:newColor.B,a:255};core.A.getOfficeEditor().updateSelectionAndCursorStyle({color}),dispatch(actions.A.closeElements([constants_dataElement.A.OFFICE_EDITOR_COLOR_PICKER_OVERLAY,"officeEditorHomeToolsGroupedItemsFlyout"]))},color:activeColor,toggleButtonDataElement:dataElement})]})}));ColorPickerButton.propTypes=ColorPickerButton_propTypes,ColorPickerButton.displayName="ColorPickerButton";const OfficeEditor_ColorPickerButton=ColorPickerButton;ColorPickerButton.__docgenInfo={description:"",methods:[],displayName:"ColorPickerButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};const NonPrintingCharactersToggleButton_propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,img:prop_types_default().string,title:prop_types_default().string},NonPrintingCharactersToggleButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,dataElement=menuItems.W.officeEditorToggleNonPrintingCharactersButton.dataElement,img:icon=menuItems.W.officeEditorToggleNonPrintingCharactersButton.icon,title=menuItems.W.officeEditorToggleNonPrintingCharactersButton.title}=props,handleClick=async()=>{const doc=core.A.getDocument();await doc.getOfficeEditor().toggleNonPrintingCharacters()},enableNonPrintingCharacters=(0,es.d4)((state=>selectors.A.isNonPrintingCharactersEnabled(state)));return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleClick,additionalClass:enableNonPrintingCharacters?"active":""}):(0,jsx_runtime.jsx)(ActionButton.A,{onClick:handleClick,dataElement,title,isActive:enableNonPrintingCharacters,img:icon})}));NonPrintingCharactersToggleButton.propTypes=NonPrintingCharactersToggleButton_propTypes,NonPrintingCharactersToggleButton.displayName="NonPrintingCharactersToggleButton";const OfficeEditor_NonPrintingCharactersToggleButton=NonPrintingCharactersToggleButton;NonPrintingCharactersToggleButton.__docgenInfo={description:"",methods:[],displayName:"NonPrintingCharactersToggleButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};const CompareButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,className,style}=props,isPanelOpen=(0,es.d4)((state=>selectors.A.isElementOpen(state,constants_dataElement.A.COMPARE_PANEL))),[doc1TypeValid,setDoc1TypeValid]=(0,react.useState)(!1),[doc2TypeValid,setDoc2TypeValid]=(0,react.useState)(!1),diffStarted=(0,react.useRef)(!1),dispatch=(0,es.wA)();(0,react.useEffect)((()=>{const onDocumentLoaded=documentViewerKey=>()=>{const documentViewer=core.A.getDocumentViewer(documentViewerKey),isValid="pdf"===documentViewer.getDocument()?.getType()||documentViewer.getDocument()?.getType()===types._.WEBVIEWER_SERVER&&!documentViewer.getDocument()?.isWebViewerServerDocument();1===documentViewerKey?setDoc1TypeValid(isValid):setDoc2TypeValid(isValid)},onDocumentUnloaded=documentViewerKey=>()=>{1===documentViewerKey?setDoc1TypeValid(!1):setDoc2TypeValid(!1),diffStarted.current=!1,dispatch(actions.A.closeElement(constants_dataElement.A.COMPARE_PANEL))},docLoaded1=onDocumentLoaded(1),docLoaded2=onDocumentLoaded(2),docUnloaded1=onDocumentUnloaded(1),docUnloaded2=onDocumentUnloaded(2);return docLoaded1(),docLoaded2(),core.A.addEventListener("documentLoaded",docLoaded1,void 0,1),core.A.addEventListener("documentUnloaded",docUnloaded1,void 0,1),core.A.addEventListener("documentLoaded",docLoaded2,void 0,2),core.A.addEventListener("documentUnloaded",docUnloaded2,void 0,2),()=>{core.A.removeEventListener("documentLoaded",docLoaded1,1),core.A.removeEventListener("documentUnloaded",docUnloaded1,1),core.A.removeEventListener("documentLoaded",docLoaded2,2),core.A.removeEventListener("documentUnloaded",docUnloaded2,2)}}),[]);const isDisabled=!doc1TypeValid||!doc2TypeValid;(0,react.useEffect)((()=>{if(isDisabled){if(isFlyoutItem)return null;console.warn("The compare preset button can only be used when 2 PDF documents are loaded on both sides")}}),[isDisabled]);const handleClick=()=>{const isOpening=!isPanelOpen;if(dispatch(actions.A.toggleElement(constants_dataElement.A.COMPARE_PANEL)),!diffStarted.current&&isOpening){diffStarted.current=!0;const documentViewers=core.A.getDocumentViewers();documentViewers[0].startSemanticDiff(documentViewers[1])}};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleClick,isActive:isPanelOpen}):(0,menuItems.c)({isDisabled,buttonType:customizationVariables.dQ.COMPARE,onClick:handleClick,isActive:isPanelOpen,className,style})}));CompareButton.propTypes={isFlyoutItem:prop_types_default().bool,className:prop_types_default().string,style:prop_types_default().object},CompareButton.displayName="CompareButton";const Compare=CompareButton;CompareButton.__docgenInfo={description:"A button that starts semantic text compare and opens the compare panel\n@name compareButton\n@memberof UI.Components.CompareButton",methods:[],displayName:"CompareButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1}}};const EDIT_MODE=window.Core.SpreadsheetEditor.SpreadsheetEditorEditMode,NewSpreadsheetButton=react.forwardRef(((props,ref)=>{const{isFlyoutItem,dataElement,className,style,img:icon,title}=props,currentUIConfiguration=(0,es.d4)(selectors.A.getUIConfiguration),spreadsheetEditorEditMode=(0,es.d4)(selectors.A.getSpreadsheetEditorEditMode),isSpreadsheetEditorModeEnabled=currentUIConfiguration===customizationVariables.jq.SPREADSHEET_EDITOR,[isDisabled,setIsDisabled]=(0,react.useState)(!isSpreadsheetEditorModeEnabled||spreadsheetEditorEditMode===EDIT_MODE.VIEW_ONLY);(0,react.useEffect)((()=>{const shouldDisableButton=!(currentUIConfiguration===customizationVariables.jq.SPREADSHEET_EDITOR)||spreadsheetEditorEditMode===EDIT_MODE.VIEW_ONLY;shouldDisableButton&&console.warn("The new spreadsheet preset button is only available if the Spreadsheet Editor mode is enabled in editing mode."),setIsDisabled(shouldDisableButton)}),[currentUIConfiguration,spreadsheetEditorEditMode]);const onClick=async()=>{core.A.loadBlankSpreadsheet()};return isDisabled?null:isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick}):(0,menuItems.c)({buttonType:customizationVariables.dQ.NEW_SPREADSHEET,isDisabled,onClick,dataElement,className,style,icon,title})}));NewSpreadsheetButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,className:prop_types_default().string,style:prop_types_default().object,img:prop_types_default().string,title:prop_types_default().string},NewSpreadsheetButton.displayName="NewSpreadsheetButton";const NewSpreadsheet=NewSpreadsheetButton;NewSpreadsheetButton.__docgenInfo={description:"A button that creates a new sheet document.\n@ignore\n@name newSpreadsheetButton\n@memberof UI.Components.PresetButton",methods:[],displayName:"NewSpreadsheetButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var MultiViewerWrapper=__webpack_require__("./src/components/MultiViewer/MultiViewerWrapper/index.js");const AlignmentButton_propTypes={alignment:prop_types_default().oneOf(Object.values(officeEditor.O2)).isRequired,isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,style:prop_types_default().object,className:prop_types_default().string,buttonType:prop_types_default().string.isRequired,img:prop_types_default().string,title:prop_types_default().string},AlignmentButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,alignment,style,className,buttonType,dataElement=menuItems.W[buttonType].dataElement,img:icon=menuItems.W[buttonType].icon,title=menuItems.W[buttonType].title}=props,isActive=(0,es.d4)((state=>selectors.A.isJustificationButtonActive(state,alignment))),handleClick=()=>{core.A.getOfficeEditor().updateParagraphStyle({justification:alignment})};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...props,ref,onClick:handleClick,additionalClass:isActive?"active":""}):(0,jsx_runtime.jsx)(ActionButton.A,{ariaCurrent:isActive,isActive,dataElement,title,img:icon,onClick:handleClick,style,className})}));AlignmentButton.propTypes=AlignmentButton_propTypes,AlignmentButton.displayName="AlignmentButton";const OfficeEditor_AlignmentButton=AlignmentButton;AlignmentButton.__docgenInfo={description:"",methods:[],displayName:"AlignmentButton",props:{alignment:{description:"",type:{name:"enum",computed:!0,value:"Object.values(JUSTIFICATION_OPTIONS)"},required:!0},isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},className:{description:"",type:{name:"string"},required:!1},buttonType:{description:"",type:{name:"string"},required:!0},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}};var BaseAlignmentButton=__webpack_require__("./src/components/ModularComponents/PresetButton/buttons/SheetEditor/BaseAlignmentButton.js");const HorizontalAlignmentButton=(props,ref)=>(0,jsx_runtime.jsx)(BaseAlignmentButton.A,{...props,ref,selector:selectors.A.getActiveCellRangeHorizontalAlignment}),SheetEditor_HorizontalAlignmentButton=react.forwardRef(HorizontalAlignmentButton),AlignmentButtonContainer=(0,react.forwardRef)(((props,ref)=>{switch((0,es.d4)((state=>selectors.A.getUIConfiguration(state)))){case customizationVariables.jq.SPREADSHEET_EDITOR:return(0,jsx_runtime.jsx)(SheetEditor_HorizontalAlignmentButton,{...props,ref});case customizationVariables.jq.DOCX_EDITOR:return(0,jsx_runtime.jsx)(OfficeEditor_AlignmentButton,{...props,ref});default:return null}}));AlignmentButtonContainer.displayName="AlignmentButtonContainer";const buttons_AlignmentButtonContainer=AlignmentButtonContainer;AlignmentButtonContainer.__docgenInfo={description:"",methods:[],displayName:"AlignmentButtonContainer"};__webpack_require__("./src/components/ModularComponents/PresetButton/PresetButton.scss"),__webpack_require__("./src/components/ModularComponents/PresetButton/buttons/SheetEditor/SheetEditor.scss");const CellDecoratorButton=(0,react.lazy)((()=>__webpack_require__.e(18670).then(__webpack_require__.bind(__webpack_require__,"./src/components/ModularComponents/PresetButton/buttons/SheetEditor/CellDecoratorButton.js")))),FontStyleToggleButton=(0,react.lazy)((()=>__webpack_require__.e(20996).then(__webpack_require__.bind(__webpack_require__,"./src/components/ModularComponents/PresetButton/buttons/OfficeEditor/FontStyleToggleButton.js")))),StyleButtonContainer=(0,react.forwardRef)(((props,ref)=>{switch((0,es.d4)((state=>selectors.A.getUIConfiguration(state)))){case customizationVariables.jq.SPREADSHEET_EDITOR:return(0,jsx_runtime.jsx)(CellDecoratorButton,{...props,ref});case customizationVariables.jq.DOCX_EDITOR:return(0,jsx_runtime.jsx)(FontStyleToggleButton,{...props,ref});default:return null}}));StyleButtonContainer.displayName="StyleButtonContainer";const buttons_StyleButtonContainer=StyleButtonContainer;StyleButtonContainer.__docgenInfo={description:"",methods:[],displayName:"StyleButtonContainer"};const VerticalAlignmentButton=(0,react.lazy)((()=>__webpack_require__.e(21260).then(__webpack_require__.bind(__webpack_require__,"./src/components/ModularComponents/PresetButton/buttons/SheetEditor/VerticalAlignmentButton.js")))),CellAdjustmentButton=(0,react.lazy)((()=>__webpack_require__.e(73879).then(__webpack_require__.bind(__webpack_require__,"./src/components/ModularComponents/PresetButton/buttons/SheetEditor/CellAdjustmentButton.js")))),MergeToggleButton=(0,react.lazy)((()=>__webpack_require__.e(22873).then(__webpack_require__.bind(__webpack_require__,"./src/components/ModularComponents/PresetButton/buttons/SheetEditor/MergeToggleButton.js")))),CellFormatButton=(0,react.lazy)((()=>__webpack_require__.e(65820).then(__webpack_require__.bind(__webpack_require__,"./src/components/ModularComponents/PresetButton/buttons/SheetEditor/CellFormatButton.js")))),CopyPasteCutButton=(0,react.lazy)((()=>__webpack_require__.e(43547).then(__webpack_require__.bind(__webpack_require__,"./src/components/ModularComponents/PresetButton/buttons/SheetEditor/CopyPasteCutButton.js")))),PresetButton_PresetButton=(0,react.forwardRef)(((props,ref)=>{const{buttonType}=props;return(0,jsx_runtime.jsx)(react.Suspense,{fallback:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}),children:(()=>{switch(buttonType){case customizationVariables.dQ.UNDO:return(0,jsx_runtime.jsx)(Undo,{...props,ref});case customizationVariables.dQ.REDO:return(0,jsx_runtime.jsx)(Redo,{...props,ref});case customizationVariables.dQ.NEW_DOCUMENT:return(0,jsx_runtime.jsx)(NewDocument,{...props,ref});case customizationVariables.dQ.FILE_PICKER:return(0,jsx_runtime.jsx)(FilePicker,{...props,ref});case customizationVariables.dQ.DOWNLOAD:return(0,jsx_runtime.jsx)(Download,{...props,ref});case customizationVariables.dQ.FULLSCREEN:return(0,jsx_runtime.jsx)(FullScreen,{...props,ref});case customizationVariables.dQ.SAVE_AS:return(0,jsx_runtime.jsx)(SaveAs,{...props,ref});case customizationVariables.dQ.PRINT:return(0,jsx_runtime.jsx)(Print,{...props,ref});case customizationVariables.dQ.CREATE_PORTFOLIO:return(0,jsx_runtime.jsx)(NewPortfolio,{...props,ref});case customizationVariables.dQ.SETTINGS:return(0,jsx_runtime.jsx)(Settings,{...props,ref});case customizationVariables.dQ.FORM_FIELD_EDIT:return(0,jsx_runtime.jsx)(FormFieldEdit,{...props,ref});case customizationVariables.dQ.ALIGN_TOP:return(0,jsx_runtime.jsx)(VerticalAlignmentButton,{...props,ref,alignment:spreadsheetEditor.Ic.Top});case customizationVariables.dQ.ALIGN_MIDDLE:return(0,jsx_runtime.jsx)(VerticalAlignmentButton,{...props,ref,alignment:spreadsheetEditor.Ic.Middle});case customizationVariables.dQ.ALIGN_BOTTOM:return(0,jsx_runtime.jsx)(VerticalAlignmentButton,{...props,ref,alignment:spreadsheetEditor.Ic.Bottom});case customizationVariables.dQ.CELL_MERGE_TOGGLE:return(0,jsx_runtime.jsx)(MergeToggleButton,{...props,ref});case customizationVariables.dQ.CONTENT_EDIT:return(0,jsx_runtime.jsx)(ContentEdit,{...props,ref});case customizationVariables.dQ.TOGGLE_ACCESSIBILITY_MODE:return(0,jsx_runtime.jsx)(buttons_ToggleAccessibilityMode,{...props,ref});case customizationVariables.dQ.INCREASE_INDENT:return(0,jsx_runtime.jsx)(OfficeEditor_IndentButton,{...props,ref,isIncreaseIndent:!0});case customizationVariables.dQ.DECREASE_INDENT:return(0,jsx_runtime.jsx)(OfficeEditor_IndentButton,{...props,ref,isIncreaseIndent:!1});case customizationVariables.dQ.OE_TOGGLE_NON_PRINTING_CHARACTERS:return(0,jsx_runtime.jsx)(OfficeEditor_NonPrintingCharactersToggleButton,{...props,ref});case customizationVariables.dQ.BOLD:return(0,jsx_runtime.jsx)(buttons_StyleButtonContainer,{...props,ref,styleType:customizationVariables.KH.Bold});case customizationVariables.dQ.ITALIC:return(0,jsx_runtime.jsx)(buttons_StyleButtonContainer,{...props,ref,styleType:customizationVariables.KH.Italic});case customizationVariables.dQ.UNDERLINE:return(0,jsx_runtime.jsx)(buttons_StyleButtonContainer,{...props,ref,styleType:customizationVariables.KH.Underline});case customizationVariables.dQ.STRIKEOUT:return(0,jsx_runtime.jsx)(buttons_StyleButtonContainer,{...props,ref,styleType:customizationVariables.KH.Strikeout});case customizationVariables.dQ.ALIGN_LEFT:return(0,jsx_runtime.jsx)(buttons_AlignmentButtonContainer,{...props,alignment:officeEditor.O2.Left,ref});case customizationVariables.dQ.ALIGN_CENTER:return(0,jsx_runtime.jsx)(buttons_AlignmentButtonContainer,{...props,alignment:officeEditor.O2.Center,ref});case customizationVariables.dQ.ALIGN_RIGHT:return(0,jsx_runtime.jsx)(buttons_AlignmentButtonContainer,{...props,alignment:officeEditor.O2.Right,ref});case customizationVariables.dQ.JUSTIFY_BOTH:return(0,jsx_runtime.jsx)(buttons_AlignmentButtonContainer,{...props,alignment:officeEditor.O2.Both,ref});case customizationVariables.dQ.OE_COLOR_PICKER:return(0,jsx_runtime.jsx)(OfficeEditor_ColorPickerButton,{...props,ref});case customizationVariables.dQ.INSERT_IMAGE:return(0,jsx_runtime.jsx)(OfficeEditorInsertImageButton.A,{...props,ref});case customizationVariables.dQ.COMPARE:return(0,jsx_runtime.jsx)(MultiViewerWrapper.A,{children:(0,jsx_runtime.jsx)(Compare,{...props,ref})});case customizationVariables.dQ.NEW_SPREADSHEET:return(0,jsx_runtime.jsx)(NewSpreadsheet,{...props,ref});case customizationVariables.dQ.CELL_COPY:return(0,jsx_runtime.jsx)(CopyPasteCutButton,{...props,ref,actionType:spreadsheetEditor.de.Copy});case customizationVariables.dQ.CELL_PASTE:return(0,jsx_runtime.jsx)(CopyPasteCutButton,{...props,ref,actionType:spreadsheetEditor.de.Paste});case customizationVariables.dQ.CELL_CUT:return(0,jsx_runtime.jsx)(CopyPasteCutButton,{...props,ref,actionType:spreadsheetEditor.de.Cut});default:return(0,spreadsheetEditor.Ce)(customizationVariables.ur,buttonType)?(0,jsx_runtime.jsx)(CellAdjustmentButton,{...props,ref}):(0,spreadsheetEditor.Ce)(customizationVariables.H6.map((i=>i.label)),buttonType)?(0,jsx_runtime.jsx)(CellFormatButton,{...props,ref,formatType:buttonType}):(console.warn(`${buttonType} is not a valid item type.`),null)}})()})}));PresetButton_PresetButton.propTypes={buttonType:prop_types_default().string.isRequired},PresetButton_PresetButton.displayName="PresetButton";const ModularComponents_PresetButton_PresetButton=PresetButton_PresetButton;PresetButton_PresetButton.__docgenInfo={description:"",methods:[],displayName:"PresetButton",props:{buttonType:{description:"",type:{name:"string"},required:!0}}}},"./src/components/ModularComponents/PresetButton/PresetButton.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/PresetButton/PresetButton.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/ModularComponents/PresetButton/buttons/SheetEditor/BaseAlignmentButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>SheetEditor_BaseAlignmentButton});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),ActionButton=__webpack_require__("./src/components/ActionButton/index.js"),FlyoutItemContainer=__webpack_require__("./src/components/ModularComponents/FlyoutItemContainer/index.js"),menuItems=__webpack_require__("./src/components/ModularComponents/Helpers/menuItems.js"),core=__webpack_require__("./src/core/index.js");const horizontalAlignmentMap={left:1,center:2,right:3},verticalAlignmentMap={top:1,middle:2,bottom:3};const setCellAlignment=alignmentType=>{if(!alignmentType)return;const spreadsheetEditorManager=core.A.getDocumentViewer().getSpreadsheetEditorManager(),{alignment,alignmentValue}=function getAlignmentProperties(alignmentType){const isVerticalAlignment=void 0!==verticalAlignmentMap[alignmentType],alignmentValue=isVerticalAlignment?verticalAlignmentMap[alignmentType]:horizontalAlignmentMap[alignmentType];return void 0===alignmentValue?{alignment:void 0,alignmentValue:void 0}:{alignment:isVerticalAlignment?"verticalAlignment":"horizontalAlignment",alignmentValue}}(alignmentType);spreadsheetEditorManager.setSelectedCellsStyle({[alignment]:alignmentValue})};var prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types);const BaseAlignmentButton=(0,react.forwardRef)(((props,ref)=>{const{isFlyoutItem,style,className,alignment,selector,buttonType,dataElement=menuItems.W[buttonType].dataElement,img:icon=menuItems.W[buttonType].icon,title=menuItems.W[buttonType].title,...rest}=props,currentAlignment=(0,es.d4)(selector),isActive=alignment===currentAlignment,handleClick=()=>{setCellAlignment(alignment)},commonProps={dataElement,...rest,ref,onClick:handleClick};return isFlyoutItem?(0,jsx_runtime.jsx)(FlyoutItemContainer.A,{...commonProps,additionalClass:isActive?"active":""}):(0,jsx_runtime.jsx)(ActionButton.A,{ariaCurrent:isActive,isActive,dataElement,title,img:icon,onClick:handleClick,style,className})}));BaseAlignmentButton.displayName="BaseAlignmentButton",BaseAlignmentButton.propTypes={isFlyoutItem:prop_types_default().bool,dataElement:prop_types_default().string,style:prop_types_default().object,className:prop_types_default().string,alignment:prop_types_default().string.isRequired,selector:prop_types_default().func.isRequired,buttonType:prop_types_default().string.isRequired,img:prop_types_default().string,title:prop_types_default().string};const SheetEditor_BaseAlignmentButton=BaseAlignmentButton;BaseAlignmentButton.__docgenInfo={description:"",methods:[],displayName:"BaseAlignmentButton",props:{isFlyoutItem:{description:"",type:{name:"bool"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},style:{description:"",type:{name:"object"},required:!1},className:{description:"",type:{name:"string"},required:!1},alignment:{description:"",type:{name:"string"},required:!0},selector:{description:"",type:{name:"func"},required:!0},buttonType:{description:"",type:{name:"string"},required:!0},img:{description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1}}}},"./src/components/ModularComponents/PresetButton/buttons/SheetEditor/SheetEditor.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/PresetButton/buttons/SheetEditor/SheetEditor.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/ModularComponents/ToggleElementButton/ToggleElementButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),selectors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/redux/selectors/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-redux/es/index.js"),actions__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/redux/actions/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_10__),components_Button__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./src/components/ModularComponents/ToggleElementButton/ToggleElementButton.scss"),__webpack_require__("./src/components/Button/index.js")),hooks_useFocusHandler__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/hooks/useFocusHandler/index.js"),helpers_getDeviceSize__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/helpers/getDeviceSize.js"),classnames__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_9__);const ToggleElementButton=props=>{const buttonRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(),isMobile=(0,helpers_getDeviceSize__WEBPACK_IMPORTED_MODULE_8__.IS)(),{dataElement,title,disabled,img,label,toggleElement,setFlyoutTriggerRef=null,onToggle,className,onClick:customOnClick=null}=props,isActive=(0,react_redux__WEBPACK_IMPORTED_MODULE_3__.d4)((state=>selectors__WEBPACK_IMPORTED_MODULE_2__.A.isElementOpen(state,toggleElement))),flyoutMap=(0,react_redux__WEBPACK_IMPORTED_MODULE_3__.d4)(selectors__WEBPACK_IMPORTED_MODULE_2__.A.getFlyoutMap,react_redux__WEBPACK_IMPORTED_MODULE_3__.bN),isToggleElementDisabled=(0,react_redux__WEBPACK_IMPORTED_MODULE_3__.d4)((state=>selectors__WEBPACK_IMPORTED_MODULE_2__.A.isElementDisabled(state,toggleElement))),isButtonDisabled=(0,react_redux__WEBPACK_IMPORTED_MODULE_3__.d4)((state=>selectors__WEBPACK_IMPORTED_MODULE_2__.A.isElementDisabled(state,dataElement))),customizableUI=(0,react_redux__WEBPACK_IMPORTED_MODULE_3__.d4)(selectors__WEBPACK_IMPORTED_MODULE_2__.A.getFeatureFlags)?.customizableUI,[isElementActive,setIsElementActive]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(isActive),[isElementDisabled,setIsElementDisabled]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(disabled),isFlyoutItem=!!flyoutMap?.[toggleElement];(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{setIsElementActive(isActive),onToggle&&onToggle(isActive)}),[isActive]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{setIsElementDisabled(isToggleElementDisabled||disabled)}),[isToggleElementDisabled,disabled]);const dispatch=(0,react_redux__WEBPACK_IMPORTED_MODULE_3__.wA)(),onClickFocusWrapped=(0,hooks_useFocusHandler__WEBPACK_IMPORTED_MODULE_7__.A)((event=>{event.stopPropagation(),customOnClick&&customOnClick(event),isFlyoutItem&&(setFlyoutTriggerRef?setFlyoutTriggerRef():dispatch(actions__WEBPACK_IMPORTED_MODULE_4__.A.setFlyoutToggleElement(dataElement))),dispatch(actions__WEBPACK_IMPORTED_MODULE_4__.A.toggleElement(toggleElement))}));return isButtonDisabled?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_9___default()({ToggleElementButton:!0,"legacy-ui":!customizableUI,"is-mobile":isMobile}),ref:buttonRef,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(components_Button__WEBPACK_IMPORTED_MODULE_6__.A,{isActive:isElementActive,dataElement,img,label,title,onClick:onClickFocusWrapped,disabled:isElementDisabled,className,ariaPressed:isFlyoutItem?void 0:isElementActive,ariaExpanded:isFlyoutItem?isElementActive:void 0,...props,children:props.children})})};ToggleElementButton.propTypes={dataElement:prop_types__WEBPACK_IMPORTED_MODULE_10___default().string.isRequired,title:prop_types__WEBPACK_IMPORTED_MODULE_10___default().string,disabled:prop_types__WEBPACK_IMPORTED_MODULE_10___default().bool,img:prop_types__WEBPACK_IMPORTED_MODULE_10___default().string,label:prop_types__WEBPACK_IMPORTED_MODULE_10___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_10___default().string,prop_types__WEBPACK_IMPORTED_MODULE_10___default().number]),toggleElement:prop_types__WEBPACK_IMPORTED_MODULE_10___default().string.isRequired,setFlyoutTriggerRef:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func,className:prop_types__WEBPACK_IMPORTED_MODULE_10___default().string,onToggle:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func,onClick:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func};const __WEBPACK_DEFAULT_EXPORT__=ToggleElementButton;ToggleElementButton.__docgenInfo={description:"",methods:[],displayName:"ToggleElementButton",props:{dataElement:{description:"",type:{name:"string"},required:!0},title:{description:"",type:{name:"string"},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},img:{description:"",type:{name:"string"},required:!1},label:{description:"",type:{name:"union",value:[{name:"string"},{name:"number"}]},required:!1},toggleElement:{description:"",type:{name:"string"},required:!0},setFlyoutTriggerRef:{description:"",type:{name:"func"},required:!1},className:{description:"",type:{name:"string"},required:!1},onToggle:{description:"",type:{name:"func"},required:!1},onClick:{description:"",type:{name:"func"},required:!1}}}},"./src/components/ModularComponents/ToggleElementButton/ToggleElementButton.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ModularComponents/ToggleElementButton/ToggleElementButton.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/ModularComponents/ToggleElementButton/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./src/components/ModularComponents/ToggleElementButton/ToggleElementButton.js").A},"./src/components/MultiViewer/MultiViewerWrapper/MultiViewerWrapper.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/MultiViewer/MultiViewerWrapper/MultiViewerWrapper.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/MultiViewer/MultiViewerWrapper/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>MultiViewer_MultiViewerWrapper});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),es=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/components/MultiViewer/MultiViewerWrapper/MultiViewerWrapper.scss"),__webpack_require__("./node_modules/react-redux/es/index.js")),selectors=__webpack_require__("./src/redux/selectors/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types);const MultiViewerWrapper_MultiViewerWrapper=({children,wrapOnlyInMultiViewerMode=!1})=>{const isMultiViewerMode=(0,es.d4)(selectors.A.isMultiViewerMode);return(0,es.d4)((state=>selectors.A.isMultiViewerReady(state)))||wrapOnlyInMultiViewerMode&&!isMultiViewerMode?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children}):null};MultiViewerWrapper_MultiViewerWrapper.propTypes={children:prop_types_default().any,wrapOnlyInMultiViewerMode:prop_types_default().bool};const MultiViewer_MultiViewerWrapper_MultiViewerWrapper=MultiViewerWrapper_MultiViewerWrapper;MultiViewerWrapper_MultiViewerWrapper.__docgenInfo={description:"",methods:[],displayName:"MultiViewerWrapper",props:{wrapOnlyInMultiViewerMode:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},children:{description:"",type:{name:"any"},required:!1}}};const MultiViewer_MultiViewerWrapper=MultiViewer_MultiViewerWrapper_MultiViewerWrapper},"./src/components/OfficeEditorImageFilePickerHandler/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_OfficeEditorImageFilePickerHandler});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),actions=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/redux/actions/index.js")),es=__webpack_require__("./node_modules/react-redux/es/index.js"),getRootNode=__webpack_require__("./src/helpers/getRootNode.js"),core=__webpack_require__("./src/core/index.js"),dataElement=__webpack_require__("./src/constants/dataElement.js"),selectors=__webpack_require__("./src/redux/selectors/index.js");__webpack_require__("./src/components/FilePickerHandler/FilePickerHandler.scss");const ACCEPTED_FORMATS=["jpg","jpeg","png","bmp"].map((format=>`.${format}`)).join(", "),OfficeEditorImageFilePickerHandler_FilePickerHandler=()=>{const dispatch=(0,es.wA)(),activeFlyout=(0,es.d4)(selectors.A.getActiveFlyout);return(0,jsx_runtime.jsx)("div",{className:"FilePickerHandler",children:(0,jsx_runtime.jsx)("input",{id:"office-editor-file-picker",type:"file",accept:ACCEPTED_FORMATS,onChange:async e=>{const file=e.target.files[0];if(file){try{dispatch(actions.A.openElement(dataElement.A.LOADING_MODAL));const base64=await(file=>new Promise(((resolve,reject)=>{const reader=new FileReader;reader.readAsDataURL(file),reader.onload=()=>resolve(reader.result),reader.onerror=reject})))(file);await core.A.getOfficeEditor().insertImageAtCursor(base64),dispatch(actions.A.closeElement(dataElement.A.LOADING_MODAL)),dispatch(actions.A.closeElement(activeFlyout))}catch(error){dispatch(actions.A.closeElement(dataElement.A.LOADING_MODAL)),dispatch(actions.A.closeElement(activeFlyout)),dispatch(actions.A.showWarningMessage({title:"Error",message:error}))}const picker=(0,getRootNode.Ay)().querySelector("#office-editor-file-picker");picker&&(picker.value="")}}})})},OfficeEditorImageFilePickerHandler=OfficeEditorImageFilePickerHandler_FilePickerHandler;OfficeEditorImageFilePickerHandler_FilePickerHandler.__docgenInfo={description:"",methods:[],displayName:"FilePickerHandler"};const components_OfficeEditorImageFilePickerHandler=OfficeEditorImageFilePickerHandler},"./src/components/PasswordModal/PasswordModal.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>__WEBPACK_DEFAULT_EXPORT__,Pm:()=>setCancelPasswordCheckCallback,mw:()=>setCheckPasswordFunction});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__),react_redux__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-redux/es/index.js"),react_i18next__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),components_Button__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/Button/index.js"),actions__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/redux/actions/index.js"),selectors__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/redux/selectors/index.js"),_ModalWrapper__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/components/ModalWrapper/index.js"),helpers_accessibility__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/helpers/accessibility.js"),constants_dataElement__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/constants/dataElement.js");__webpack_require__("./src/components/PasswordModal/PasswordModal.scss");let checkPassword=()=>{};const setCheckPasswordFunction=fn=>{checkPassword=fn};let cancelPasswordCheckCallback=()=>{};const setCancelPasswordCheckCallback=fn=>{cancelPasswordCheckCallback=fn},PasswordModal=()=>{const[isOpen,attempt,maxAttempts]=(0,react_redux__WEBPACK_IMPORTED_MODULE_3__.d4)((state=>[selectors__WEBPACK_IMPORTED_MODULE_6__.A.isElementOpen(state,constants_dataElement__WEBPACK_IMPORTED_MODULE_9__.A.PASSWORD_MODAL),selectors__WEBPACK_IMPORTED_MODULE_6__.A.getPasswordAttempts(state),selectors__WEBPACK_IMPORTED_MODULE_6__.A.getMaxPasswordAttempts(state)]),react_redux__WEBPACK_IMPORTED_MODULE_3__.bN),dispatch=(0,react_redux__WEBPACK_IMPORTED_MODULE_3__.wA)(),[t]=(0,react_i18next__WEBPACK_IMPORTED_MODULE_11__.B)(),passwordInput=react__WEBPACK_IMPORTED_MODULE_1__.createRef(),[password,setPassword]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(""),[userCancelled,setUserCancelled]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>(isOpen?(dispatch(actions__WEBPACK_IMPORTED_MODULE_5__.A.closeElement(constants_dataElement__WEBPACK_IMPORTED_MODULE_9__.A.PROGRESS_MODAL)),passwordInput.current?.focus(),window.addEventListener("keydown",(e=>(0,helpers_accessibility__WEBPACK_IMPORTED_MODULE_8__.dy)(e,closeModal)))):(setPassword(""),setUserCancelled(!1)),()=>window.removeEventListener("keydown",helpers_accessibility__WEBPACK_IMPORTED_MODULE_8__.dy))),[dispatch,isOpen,passwordInput]);const handleSubmit=e=>{e.preventDefault(),checkPassword(password)},closeModal=event=>{"Escape"===event.key?setUserCancelled(!0):dispatch(actions__WEBPACK_IMPORTED_MODULE_5__.A.closeElement(constants_dataElement__WEBPACK_IMPORTED_MODULE_9__.A.PASSWORD_MODAL)),cancelPasswordCheckCallback()},getErrorModal=errorMessage=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_ModalWrapper__WEBPACK_IMPORTED_MODULE_7__.A,{isOpen,title:"message.error",closeButtonDataElement:"errorModalCloseButton",onCloseClick:closeModal,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"modal-content error-modal-content",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{"aria-live":"assertive",role:"alert",children:t(errorMessage)})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"modal-footer footer",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(components_Button__WEBPACK_IMPORTED_MODULE_4__.A,{className:"confirm modal-button",dataElement:"passwordSubmitButton",label:t("action.ok"),onClick:closeModal})})]}),onKeyDown=e=>{13===e.which&&handleSubmit(e)},renderEnterPasswordContent=()=>{const wrongPassword=0!==attempt,wrongPasswordMessage=`${t("message.incorrectPassword",{remainingAttempts:maxAttempts-attempt})}`;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_ModalWrapper__WEBPACK_IMPORTED_MODULE_7__.A,{isOpen,title:"message.passwordRequired",closeButtonDataElement:"errorModalCloseButton",onCloseClick:()=>{setUserCancelled(!0)},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("form",{onSubmit:handleSubmit,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{children:t("message.enterPassword")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("input",{className:(wrongPassword?"wrong":"correct")+" text-input-modal",type:"password",ref:passwordInput,autoComplete:"current-password",value:password,onKeyDown,onChange:e=>setPassword(e.target.value),placeholder:t("message.enterPasswordPlaceholder"),"aria-label":`${wrongPassword?wrongPasswordMessage:t("message.enterPassword")}`}),wrongPassword&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"incorrect-password",children:wrongPasswordMessage})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"modal-footer footer",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(components_Button__WEBPACK_IMPORTED_MODULE_4__.A,{className:"confirm modal-button",dataElement:"passwordSubmitButton",label:t("action.submit"),disabled:!password,onClick:handleSubmit})})]})};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_2___default()({Modal:!0,PasswordModal:!0,open:isOpen,closed:!isOpen}),"data-element":constants_dataElement__WEBPACK_IMPORTED_MODULE_9__.A.PASSWORD_MODAL,children:attempt===maxAttempts?getErrorModal("message.encryptedAttemptsExceeded"):userCancelled?getErrorModal("message.encryptedUserCancelled"):renderEnterPasswordContent()})},__WEBPACK_DEFAULT_EXPORT__=PasswordModal;PasswordModal.__docgenInfo={description:"",methods:[],displayName:"PasswordModal"}},"./src/components/PasswordModal/PasswordModal.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/PasswordModal/PasswordModal.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/PasswordModal/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__,setCancelPasswordCheckCallback:()=>_PasswordModal__WEBPACK_IMPORTED_MODULE_0__.Pm,setCheckPasswordFunction:()=>_PasswordModal__WEBPACK_IMPORTED_MODULE_0__.mw});var _PasswordModal__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/PasswordModal/PasswordModal.js");const __WEBPACK_DEFAULT_EXPORT__=_PasswordModal__WEBPACK_IMPORTED_MODULE_0__.Ay},"./src/helpers/downloadPdf.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var file_saver__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/file-saver/dist/FileSaver.min.js"),core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/core/index.js"),helpers_device__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/helpers/device.js"),helpers_fireEvent__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/helpers/fireEvent.js"),constants_events__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/constants/events.js"),actions__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/redux/actions/index.js"),helpers_rasterPrint__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/helpers/rasterPrint.js"),selectors__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/redux/selectors/index.js"),blob_stream__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/blob-stream/index.js"),blob_stream__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(blob_stream__WEBPACK_IMPORTED_MODULE_8__),constants_sortStrategies__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/constants/sortStrategies.js"),constants_map__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/constants/map.js"),lodash_range__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/lodash/range.js"),lodash_range__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(lodash_range__WEBPACK_IMPORTED_MODULE_11__),helpers_getRootNode__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./src/helpers/getRootNode.js"),constants_types__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./src/constants/types.js"),_officeEditor__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./src/helpers/officeEditor.js"),src_constants_dataElement__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./src/constants/dataElement.js"),constants_commonColors__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./src/constants/commonColors.js");let isDownloaded=!1,previousWatermarkSettings={},previousFileName="";const __WEBPACK_DEFAULT_EXPORT__=async(dispatch,options={},documentViewerKey=1)=>{let temporaryModifiedDoc,doc=core__WEBPACK_IMPORTED_MODULE_1__.A.getDocument(documentViewerKey);if(!doc)return void console.warn("Document is not loaded");previousFileName!==doc?.getFilename()&&(previousFileName=doc?.getFilename(),isDownloaded=!1);const documentViewer=core__WEBPACK_IMPORTED_MODULE_1__.A.getDocumentViewer();previousWatermarkSettings=await documentViewer.getWatermark(),isDownloaded?documentViewer.setWatermark():(isDownloaded=!0,doc.enableWatermarkApplied());const{filename=doc?.getFilename()||"document",includeAnnotations=!0,externalURL,useDisplayAuthor=!1,store}=options;let pages=options.pages,includeComments=!!options.includeComments;const downloadAllPages=!pages||pages.length===doc.getPageCount(),downloadDataAsFile=(data,extension,options)=>{const arr=new Uint8Array(data),{downloadName}=options;let file,downloadType="application/pdf";if(options.downloadType===constants_types__WEBPACK_IMPORTED_MODULE_12__._.OFFICE||options.downloadType===constants_types__WEBPACK_IMPORTED_MODULE_12__._.SPREADSHEET_EDITOR){downloadType=function reverseObject(obj){return Object.assign({},...Object.entries(obj).map((([key,value])=>({[value]:key}))))}(window.Core.mimeTypeToExtension)[extension]}file=helpers_device__WEBPACK_IMPORTED_MODULE_2__.lT?new Blob([arr],{type:downloadType}):new File([arr],filename,{type:downloadType}),(0,file_saver__WEBPACK_IMPORTED_MODULE_0__.saveAs)(file,downloadName||filename),dispatch(actions__WEBPACK_IMPORTED_MODULE_5__.A.closeElement(src_constants_dataElement__WEBPACK_IMPORTED_MODULE_14__.A.LOADING_MODAL)),(0,helpers_fireEvent__WEBPACK_IMPORTED_MODULE_3__.A)(constants_events__WEBPACK_IMPORTED_MODULE_4__.A.FILE_DOWNLOADED),temporaryModifiedDoc&&temporaryModifiedDoc.unloadResources(),documentViewer.setWatermark(previousWatermarkSettings)};(0,_officeEditor__WEBPACK_IMPORTED_MODULE_13__.pb)()&&(includeComments=!1),options.downloadType||(options.downloadType=constants_types__WEBPACK_IMPORTED_MODULE_12__._.PDF);const downloadAsImage="png"===options.downloadType;if(dispatch(actions__WEBPACK_IMPORTED_MODULE_5__.A.openElement(src_constants_dataElement__WEBPACK_IMPORTED_MODULE_14__.A.LOADING_MODAL)),downloadAsImage){pages?.length||(pages=lodash_range__WEBPACK_IMPORTED_MODULE_11___default()(1,doc.getPageCount()+1,1));const state=store.getState(),[sortStrategy,dateFormat,language,printQuality,colorMap]=[selectors__WEBPACK_IMPORTED_MODULE_7__.A.getSortStrategy(state),selectors__WEBPACK_IMPORTED_MODULE_7__.A.getPrintedNoteDateFormat(state),selectors__WEBPACK_IMPORTED_MODULE_7__.A.getCurrentLanguage(state),selectors__WEBPACK_IMPORTED_MODULE_7__.A.getPrintQuality(state),selectors__WEBPACK_IMPORTED_MODULE_7__.A.getColorMap(state)],id="download-handler-css";if(!(0,helpers_getRootNode__WEBPACK_IMPORTED_MODULE_16__.Ay)().querySelector(`#${id}`)){const style=window.document.createElement("style");style.id=id,style.textContent="\n        img {\n          display: block !important;\n          max-width: 100%;\n          max-height: 100%;\n          height: 100%;\n          width: 100%;\n          object-fit: contain;\n          page-break-after: always;\n          padding: 0;\n          margin: 0;\n        }\n\n        .page__container {\n          margin: 10px;\n          box-sizing: border-box;\n          display: flex !important;\n          flex-direction: column;\n          padding: 10px;\n          min-height: 100%;\n          min-width: 100%;\n          font-size: 10px;\n        }\n\n        .page__container .page__header {\n          margin-top: 2rem;\n          display: block !important;\n          align-self: flex-start;\n          font-size: 2rem;\n          margin-bottom: 2rem;\n          padding-bottom: 0.6rem;\n          border-bottom: 0.1rem solid black;\n        }\n\n        .page__container .note {\n          display: flex !important;\n          flex-direction: column;\n          padding: 0.6rem;\n          border: 0.1rem lightgray solid;\n          border-radius: 0.4rem;\n          margin-bottom: 0.5rem;\n        }\n\n        .page__container .note .note__info {\n          display: block !important;\n          font-size: 1.3rem;\n          margin-bottom: 0.1rem;\n        }\n\n        .page__container .note .note__info--with-icon {\n          display: flex !important;\n        }\n\n        .page__container .note .note__info--with-icon .note__icon {\n          display: block !important;\n          width: 1.65rem;\n          height: 1.65rem;\n          margin-top: -0.1rem;\n          margin-right: 0.2rem;\n        }\n\n        .page__container .note .note__info--with-icon .note__icon path:not([fill=none]) {\n          display: block !important;\n          fill: currentColor;\n        }\n\n        .page__container .note .note__root .note__content {\n          display: block !important;\n          margin-left: 0.3rem;\n        }\n\n        .page__container .note .note__root {\n          display: block !important;\n        }\n\n        .page__container .note .note__info--with-icon .note__icon svg {\n          display: block !important;\n        }\n\n        .page__container .note .note__reply {\n          display: block !important;\n          margin: 0.5rem 0 0 2rem;\n        }\n\n        .page__container .note .note__content {\n          display: block !important;\n          font-size: 1.2rem;\n          margin-top: 0.1rem;\n        }\n      ",window.document.head.prepend(style)}const printingOptions={includeComments,includeAnnotations,maintainPageOrientation:!0,printQuality,sortStrategy,colorMap,dateFormat,isPrintCurrentView:!1,language,createCanvases:!0,isGrayscale:!1},createdPages=(0,helpers_rasterPrint__WEBPACK_IMPORTED_MODULE_6__.F1)(pages,printingOptions,void 0),addWhiteBackground=dataURL=>{const pagePrintCanvas=document.createElement("canvas"),pagePrintContext=pagePrintCanvas.getContext("2d");return new Promise((res=>{const printImg=new Image;printImg.src=dataURL,printImg.onload=()=>{pagePrintCanvas.width=printImg.width,pagePrintCanvas.height=printImg.height,pagePrintContext.fillStyle=constants_commonColors__WEBPACK_IMPORTED_MODULE_15__.zb.white,pagePrintContext.fillRect(0,0,pagePrintCanvas.width,pagePrintCanvas.height),pagePrintContext.drawImage(printImg,0,0),res(pagePrintCanvas.toDataURL())}}))},html2canvas=(await __webpack_require__.e(26526).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/html2canvas/dist/npm/index.js",23))).default;for(let page of createdPages){let dataURL;if(page=await page,page instanceof HTMLElement){document.body.appendChild(page);const canvas=await html2canvas(page,{backgroundColor:null,scale:1,logging:!1});dataURL=await addWhiteBackground(canvas.toDataURL()),document.body.removeChild(page)}else dataURL=doc?.getType()===constants_types__WEBPACK_IMPORTED_MODULE_12__._.OFFICE||doc?.getType()===constants_types__WEBPACK_IMPORTED_MODULE_12__._.LEGACY_OFFICE||doc?.getType()===constants_types__WEBPACK_IMPORTED_MODULE_12__._.OFFICE_EDITOR?await addWhiteBackground(page):page;const link=document.createElement("a");link.href=dataURL,link.download=`${filename}.png`,link.style.display="none",document.body.appendChild(link),link.click(),document.body.removeChild(link)}return dispatch(actions__WEBPACK_IMPORTED_MODULE_5__.A.closeElement(src_constants_dataElement__WEBPACK_IMPORTED_MODULE_14__.A.LOADING_MODAL)),void(0,helpers_fireEvent__WEBPACK_IMPORTED_MODULE_3__.A)(constants_events__WEBPACK_IMPORTED_MODULE_4__.A.FILE_DOWNLOADED)}let annotationsPromise=Promise.resolve();const convertToPDF=options.downloadType===constants_types__WEBPACK_IMPORTED_MODULE_12__._.PDF&&(doc.getType()===constants_types__WEBPACK_IMPORTED_MODULE_12__._.OFFICE||(0,_officeEditor__WEBPACK_IMPORTED_MODULE_13__.pb)()||doc.getType()===constants_types__WEBPACK_IMPORTED_MODULE_12__._.SPREADSHEET_EDITOR);if(!(0,_officeEditor__WEBPACK_IMPORTED_MODULE_13__.pb)()&&doc.getType()!==constants_types__WEBPACK_IMPORTED_MODULE_12__._.SPREADSHEET_EDITOR||!convertToPDF){if(convertToPDF||includeComments){const xfdfString=await core__WEBPACK_IMPORTED_MODULE_1__.A.exportAnnotations({fields:!0,widgets:!0,links:!0,useDisplayAuthor},documentViewerKey),fileData=await doc.getFileData({xfdfString,includeAnnotations,downloadType:constants_types__WEBPACK_IMPORTED_MODULE_12__._.PDF});if(temporaryModifiedDoc=await core__WEBPACK_IMPORTED_MODULE_1__.A.createDocument(fileData,{extension:constants_types__WEBPACK_IMPORTED_MODULE_12__._.PDF,filename}),includeComments){const canvas2pdf=await Promise.all([__webpack_require__.e(4373),__webpack_require__.e(4118)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/canvas2pdf/canvas2pdf.js",23)),state=store.getState(),[sortStrategy,colorMap]=[selectors__WEBPACK_IMPORTED_MODULE_7__.A.getSortStrategy(state),selectors__WEBPACK_IMPORTED_MODULE_7__.A.getColorMap(state)],pageWidth=612,pageHeight=792,titleFontSize=12,bodyFontSize=11,cardSpacing=8,padding=36,commentPages={};for(const pageNumber of pages){const annotationNotes=(0,constants_sortStrategies__WEBPACK_IMPORTED_MODULE_9__.Qk)()[sortStrategy].getSortedNotes(core__WEBPACK_IMPORTED_MODULE_1__.A.getAnnotationsList(documentViewerKey).filter((annotation=>annotation.Listable&&annotation.PageNumber===pageNumber&&!annotation.isReply()&&!annotation.isGrouped())));if(!annotationNotes?.length)continue;const startX=padding;let startY=padding,ctx=new canvas2pdf.PdfContext(blob_stream__WEBPACK_IMPORTED_MODULE_8___default()(),{font:"Helvetica"});async function savePage(){const blob=await new Promise((res=>{ctx.stream.on("finish",(()=>res(ctx.stream.toBlob("application/pdf")))),ctx.end()}));commentPages[pageNumber]?commentPages[pageNumber].push(blob):commentPages[pageNumber]=[blob]}let x=startX,y=startY;const text=`Page ${pageNumber}`;ctx.font=`${titleFontSize}px Helvetica`,ctx.fillStyle=constants_commonColors__WEBPACK_IMPORTED_MODULE_15__.zb.black;let textSize=ctx.measureText(text);ctx.fillText(text,x,y),y+=textSize.height;for(const annotation of annotationNotes){let skip;async function drawAnnotationComment(annotation,startX,isReply=!1){async function drawText(text,options={}){const{bold=!1,fillStyle=constants_commonColors__WEBPACK_IMPORTED_MODULE_15__.zb.black,size=bodyFontSize,font="Helvetica"}=options;let{x,y}=options;ctx.fillStyle=fillStyle,ctx.font=`${size}px ${font}`;const textSize=ctx.measureText(text);return textSize.height+y>pageHeight-padding&&(drawRoundedRect(ctx,padding,startY,pageWidth-2*padding,pageHeight-startY-padding,4,"bottom"),await savePage(),ctx=new canvas2pdf.PdfContext(blob_stream__WEBPACK_IMPORTED_MODULE_8___default()(),{font:"Helvetica"}),ctx.fillStyle=fillStyle,ctx.font=`${size}px ${font}`,x=startX,y=padding+cardSpacing,startY=padding,skip="top"),ctx.fillText(text,x,y),bold&&(ctx.fillText(text,x+.1,y),textSize.width+=.1),{textSize,x,y,startY}}function extractProperties(newProperties){x=newProperties.x,y=newProperties.y,startY=newProperties.startY,textSize=newProperties.textSize}extractProperties(await drawText(annotation.Author||"Guest",{bold:!0,x,y})),x+=textSize.width+cardSpacing;const dateText=`- ${new Date(annotation.DateCreated).toLocaleString(void 0,{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"})}`;if(extractProperties(await drawText(dateText,{fillStyle:constants_commonColors__WEBPACK_IMPORTED_MODULE_15__.zb.gray8,x,y})),x+=textSize.width+cardSpacing,!isReply){const subjectText=`Subject: ${annotation.Subject}`,subjectTextSize=ctx.measureText(subjectText);subjectTextSize.width<90&&(subjectTextSize.width=90),ctx.fillText(subjectText,pageWidth-padding-subjectTextSize.width-cardSpacing,y)}x=startX,y+=textSize.height+cardSpacing,isReply||(y+=cardSpacing),ctx.fillStyle=constants_commonColors__WEBPACK_IMPORTED_MODULE_15__.zb.black;return annotation.getContents()?(await async function drawTextAndWrap(text,checkNewLines=!0){if(checkNewLines){const textArray=text.split("\n");if(textArray.length>1){for(const text of textArray)await drawTextAndWrap(text,!1),x=startX;return}}const textSize=ctx.measureText(text);if(textSize.width+x>pageWidth-padding-cardSpacing){let maxSize=pageWidth-2*padding-3*cardSpacing;isReply&&(maxSize-=36);const indexOfLastSpaceToFit=text.lastIndexOf(" ",text.length*maxSize/(textSize.width+x));extractProperties(await drawText(text.substring(0,indexOfLastSpaceToFit),{x,y})),y+=textSize.height,x=startX,await drawTextAndWrap(text.substring(indexOfLastSpaceToFit+1))}else ctx.fillText(text,x,y),y+=textSize.height}(annotation.getContents()),y+=cardSpacing):y-=cardSpacing,y-cardSpacing}y+40>pageHeight&&(await savePage(),ctx=new canvas2pdf.PdfContext(blob_stream__WEBPACK_IMPORTED_MODULE_8___default()(),{font:"Helvetica"}),x=padding,y=padding),y+=cardSpacing,startY=y,y+=cardSpacing,x+=cardSpacing,await new Promise((resolve=>{const key=(0,constants_map__WEBPACK_IMPORTED_MODULE_10__.c7)(annotation),colorProperty=colorMap[key]&&colorMap[key].iconColor,color=annotation[colorProperty||"StrokeColor"].toString(),iconKey=(0,constants_map__WEBPACK_IMPORTED_MODULE_10__.ap)(key).icon,icon=__webpack_require__("./assets/icons sync recursive ^\\.\\/.*\\.svg$")(`./${iconKey}.svg`),blob=new Blob([icon],{type:"image/svg+xml;charset=utf-8"}),url=URL.createObjectURL(blob),img=new Image;img.style.color=color,img.src=url,img.onload=()=>{ctx.drawImage(img,x,y,24,24),URL.revokeObjectURL(url),resolve()}})),x+=30,y+=14;let lastYPos=await drawAnnotationComment(annotation,x-30);x=startX+36;for(const reply of annotation.getReplies())y+=cardSpacing,lastYPos=await drawAnnotationComment(reply,x,!0);drawRoundedRect(ctx,padding,startY,pageWidth-2*padding,lastYPos-startY+cardSpacing,4,skip),x=startX}await savePage()}let pageOffset=1;for(let page of Object.keys(commentPages)){page=parseInt(page);for(const blob of commentPages[page]){const commentPagesDoc=await core__WEBPACK_IMPORTED_MODULE_1__.A.createDocument(blob,{extension:constants_types__WEBPACK_IMPORTED_MODULE_12__._.PDF});await temporaryModifiedDoc.insertPages(commentPagesDoc,[1],page+pageOffset),downloadAllPages||(pages=pages.map((p=>p>=page+pageOffset?p+1:p)),pages.push(page+pageOffset)),pageOffset++,commentPagesDoc.unloadResources()}}pages=downloadAllPages?void 0:pages.sort(((a,b)=>a-b)),annotationsPromise=Promise.resolve((await temporaryModifiedDoc.extractXFDF({pages})).xfdfString)}else annotationsPromise=Promise.resolve(xfdfString)}else!includeAnnotations||options.xfdfString||downloadAsImage?options.xfdfString||includeAnnotations||(options.xfdfString=window.Core.EMPTY_XFDF):annotationsPromise=options.documentToBeDownloaded?Promise.resolve((await options.documentToBeDownloaded.extractXFDF(pages)).xfdfString):core__WEBPACK_IMPORTED_MODULE_1__.A.exportAnnotations({useDisplayAuthor},documentViewerKey);return annotationsPromise.then((async xfdfString=>{options.xfdfString=options.xfdfString||xfdfString,includeAnnotations||(options.includeAnnotations=!1);const extension=doc.getFilename().split(".").pop()?.toLowerCase()||"",docType=doc?.getType(),isNotPDF=docType?.includes("video")||"audio"===docType||docType===constants_types__WEBPACK_IMPORTED_MODULE_12__._.OFFICE||docType===constants_types__WEBPACK_IMPORTED_MODULE_12__._.SPREADSHEET_EDITOR||(0,_officeEditor__WEBPACK_IMPORTED_MODULE_13__.pb)(),downloadName=((name,extension)=>name.toLowerCase().endsWith(extension)?name:`${name}${extension}`)(filename,isNotPDF&&!convertToPDF?`.${extension}`:".pdf"),clonedOptions=Object.assign({},options);clonedOptions.documentToBeDownloaded&&(temporaryModifiedDoc=clonedOptions.documentToBeDownloaded,delete clonedOptions.documentToBeDownloaded),clonedOptions.store&&delete clonedOptions.store;const handleError=error=>{throw dispatch(actions__WEBPACK_IMPORTED_MODULE_5__.A.closeElement(src_constants_dataElement__WEBPACK_IMPORTED_MODULE_14__.A.LOADING_MODAL)),new Error(error.message)},signatureWidgets=core__WEBPACK_IMPORTED_MODULE_1__.A.getAnnotationsList().filter((a=>a instanceof window.Core.Annotations.SignatureWidgetAnnotation));if((await Promise.all(signatureWidgets.map((a=>a.isSignedDigitally())))).includes(!0)&&(clonedOptions.flags|=window.Core.SaveOptions.INCREMENTAL),!externalURL)return pages&&!downloadAllPages?(temporaryModifiedDoc||doc).extractPages(pages,options.xfdfString).then((data=>downloadDataAsFile(data,extension,{...options,downloadName})),handleError):(temporaryModifiedDoc||doc).getFileData(clonedOptions).then((data=>downloadDataAsFile(data,extension,{...options,downloadName})),handleError);{const downloadIframe=(0,helpers_getRootNode__WEBPACK_IMPORTED_MODULE_16__.Ay)().querySelector("#download-iframe")||document.createElement("iframe");downloadIframe.width=0,downloadIframe.height=0,downloadIframe.id="download-iframe",downloadIframe.src=null,document.body.appendChild(downloadIframe),downloadIframe.src=externalURL,dispatch(actions__WEBPACK_IMPORTED_MODULE_5__.A.closeElement(src_constants_dataElement__WEBPACK_IMPORTED_MODULE_14__.A.LOADING_MODAL)),(0,helpers_fireEvent__WEBPACK_IMPORTED_MODULE_3__.A)(constants_events__WEBPACK_IMPORTED_MODULE_4__.A.FILE_DOWNLOADED)}})).catch((error=>{console.warn(error),dispatch(actions__WEBPACK_IMPORTED_MODULE_5__.A.closeElement(src_constants_dataElement__WEBPACK_IMPORTED_MODULE_14__.A.LOADING_MODAL))}))}{const data=await doc.getFileData({downloadType:constants_types__WEBPACK_IMPORTED_MODULE_12__._.PDF});downloadDataAsFile(data,constants_types__WEBPACK_IMPORTED_MODULE_12__._.PDF,options)}};function drawRoundedRect(ctx,x,y,width,height,radius,skip=void 0){const skipTop="top"===skip,skipBottom="bottom"===skip;ctx.beginPath(),ctx.strokeStyle="lightgray",ctx.lineWidth=1,skipTop?(ctx.moveTo(x,y),ctx.lineTo(x,y+height-radius),ctx.quadraticCurveTo(x,y+height,x+radius,y+height),ctx.lineTo(x+width-radius,y+height),ctx.quadraticCurveTo(x+width,y+height,x+width,y+height-radius),ctx.lineTo(x+width,y)):skipBottom?(ctx.moveTo(x,y+height),ctx.lineTo(x,y+radius),ctx.quadraticCurveTo(x,y,x+radius,y),ctx.lineTo(x+width-radius,y),ctx.quadraticCurveTo(x+width,y,x+width,y+radius),ctx.lineTo(x+width,y+height)):(ctx.moveTo(x+radius,y),ctx.lineTo(x+width-radius,y),ctx.quadraticCurveTo(x+width,y,x+width,y+radius),ctx.lineTo(x+width,y+height-radius),ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height),ctx.lineTo(x+radius,y+height),ctx.quadraticCurveTo(x,y+height,x,y+height-radius),ctx.lineTo(x,y+radius),ctx.quadraticCurveTo(x,y,x+radius,y),ctx.closePath()),ctx.stroke()}},"./src/helpers/isFullscreen.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=()=>!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},"./src/helpers/loadDocument.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>loadDocument});var PasswordModal=__webpack_require__("./src/components/PasswordModal/index.js"),core=__webpack_require__("./src/core/index.js"),fireEvent=__webpack_require__("./src/helpers/fireEvent.js"),isString=__webpack_require__("./node_modules/lodash/isString.js"),isString_default=__webpack_require__.n(isString);const helpers_getFileExtension=(src,options)=>{if(options?.extension)return options.extension.toLowerCase();if(!src)return null;if(src instanceof File)return src.name.split(".").pop().toLowerCase();if((src instanceof Blob||src instanceof ArrayBuffer)&&options?.filename)return options.filename.split(".").pop().toLowerCase();if(isString_default()(src)){return src.split("?")[0].split("#")[0].split(".").pop().toLowerCase()}return null};var getHashParameters=__webpack_require__("./src/helpers/getHashParameters.js"),actions=__webpack_require__("./src/redux/actions/index.js"),dataElement=__webpack_require__("./src/constants/dataElement.js"),customizationVariables=__webpack_require__("./src/constants/customizationVariables.js");const loadDocument=(dispatch,src,options={},documentViewerKey=1)=>{(options={...getDefaultOptions(),...options}).docId=options.docId||options.documentId||null;const customLoadingProgressFunction=options.onLoadingProgress;if(options.onLoadingProgress=percent=>{customLoadingProgressFunction&&customLoadingProgressFunction(percent),dispatch(actions.A.setLoadingProgress(percent))},options.password=transformPasswordOption(options.password,dispatch),options.xodOptions=extractXodOptions(options),"onError"in options){const userDefinedOnErrorCallback=options.onError;options.onError=function(error){(0,fireEvent.R)(error),userDefinedOnErrorCallback(error)}}else options.onError=fireEvent.R;dispatch(actions.A.closeElement(dataElement.A.PASSWORD_MODAL));const extension=helpers_getFileExtension(src,options),isDOCXEditorMode=options.initialMode===customizationVariables.jq.DOCX_EDITOR||options.enableOfficeEditing,isXLSXEditorMode=options.initialMode===customizationVariables.jq.SPREADSHEET_EDITOR;isDOCXEditorMode&&customizationVariables.rM.includes(extension)||isXLSXEditorMode&&customizationVariables.CG.includes(extension)?options.enableOfficeEditing=!0:options.enableOfficeEditing=!1,src?core.A.loadDocument(src,options,documentViewerKey).catch((()=>{})):isXLSXEditorMode?core.A.loadBlankSpreadsheet(options):isDOCXEditorMode&&core.A.loadBlankOfficeEditorDocument(options),dispatch(actions.A.openElement(dataElement.A.PROGRESS_MODAL))},getDefaultOptions=()=>({startOffline:(0,getHashParameters.A)("startOffline",!1),azureWorkaround:(0,getHashParameters.A)("azureWorkaround",!1),webviewerServerURL:(0,getHashParameters.A)("webviewerServerURL",""),fallbackToClientSide:(0,getHashParameters.A)("fallbackToClientSide",!1),singleServerMode:(0,getHashParameters.A)("singleServerMode",!1),webviewerServerRangeRequests:(0,getHashParameters.A)("wvsRange",!0),forceClientSideInit:(0,getHashParameters.A)("forceClientSideInit",!1),disableWebsockets:(0,getHashParameters.A)("disableWebsockets",!1),cacheKey:(0,getHashParameters.A)("cacheKey",null),officeOptions:JSON.parse((0,getHashParameters.A)("officeOptions",null)),rasterizerOptions:JSON.parse((0,getHashParameters.A)("rasterizerOptions",null)),streaming:(0,getHashParameters.A)("streaming",null),useDownloader:(0,getHashParameters.A)("useDownloader",!0),backendType:(0,getHashParameters.A)("pdf",null),loadAsPDF:(0,getHashParameters.A)("loadAsPDF",null),initialMode:(0,getHashParameters.A)("initialMode",null),enableOfficeEditing:(0,getHashParameters.A)("enableOfficeEditing",!1)}),transformPasswordOption=(password,dispatch)=>{let attempt,passwordChecked=!1;return checkPassword=>{dispatch(actions.A.setPasswordAttempts(attempt++)),password||(password=""),passwordChecked||"string"!=typeof password?(passwordChecked&&1!==attempt&&console.error("Wrong password has been passed as an argument. WebViewer will open password modal."),(0,PasswordModal.setCheckPasswordFunction)(checkPassword),dispatch(actions.A.openElement(dataElement.A.PASSWORD_MODAL))):(checkPassword(password),passwordChecked=!0,attempt=0)}},extractXodOptions=options=>{const xodOptions=options.xodOptions||{};return options.decryptOptions&&(xodOptions.decrypt=window.Core.Encryption.decrypt,xodOptions.decryptOptions=options.decryptOptions),options.decrypt&&(xodOptions.decrypt=options.decrypt),null!==options.streaming&&(xodOptions.streaming="true"===options.streaming||!0===options.streaming),options.azureWorkaround&&(xodOptions.azureWorkaround=options.azureWorkaround),options.startOffline&&(xodOptions.startOffline=options.startOffline),xodOptions}},"./src/helpers/openOfficeEditorFilePicker.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var helpers_getRootNode__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/helpers/getRootNode.js");const __WEBPACK_DEFAULT_EXPORT__=()=>{(0,helpers_getRootNode__WEBPACK_IMPORTED_MODULE_0__.Ay)().querySelector("#office-editor-file-picker")?.click()}},"./src/helpers/toggleFullscreen.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _fireEvent__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/helpers/fireEvent.js"),constants_events__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/constants/events.js"),_isFullscreen__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/helpers/isFullscreen.js"),_getRootNode__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/helpers/getRootNode.js");const __WEBPACK_DEFAULT_EXPORT__=()=>{const rootNode=(0,_getRootNode__WEBPACK_IMPORTED_MODULE_2__.Ay)(),targetElement=rootNode instanceof ShadowRoot?rootNode.host:rootNode.documentElement;(0,_isFullscreen__WEBPACK_IMPORTED_MODULE_3__.A)()?(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),(0,_fireEvent__WEBPACK_IMPORTED_MODULE_0__.A)(constants_events__WEBPACK_IMPORTED_MODULE_1__.A.FULLSCREEN_MODE_TOGGLED,{isInFullscreen:!1})):(targetElement.requestFullscreen?targetElement.requestFullscreen():targetElement.msRequestFullscreen?targetElement.msRequestFullscreen():targetElement.mozRequestFullScreen?targetElement.mozRequestFullScreen():targetElement.webkitRequestFullScreen&&(targetElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT),setTimeout((()=>{document.webkitCurrentFullScreenElement||targetElement.webkitRequestFullScreen()}),200)),(0,_fireEvent__WEBPACK_IMPORTED_MODULE_0__.A)(constants_events__WEBPACK_IMPORTED_MODULE_1__.A.FULLSCREEN_MODE_TOGGLED,{isInFullscreen:!0}))}},"./src/hooks/useOnDocumentUnloaded/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>hooks_useOnDocumentUnloaded});var react=__webpack_require__("./node_modules/react/index.js"),core=__webpack_require__("./src/core/index.js");const hooks_useOnDocumentUnloaded=callback=>{react.useEffect((()=>{const onDocumentUnloaded=()=>{callback()};return core.A.addEventListener("documentUnloaded",onDocumentUnloaded),()=>{core.A.removeEventListener("documentUnloaded",onDocumentUnloaded)}}),[callback])}},"?19e6":()=>{},"?3e83":()=>{}}]);