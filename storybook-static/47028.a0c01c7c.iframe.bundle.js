(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[47028],{"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsBar/HeaderFooterControlsBar.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,':host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.header-footer-edit-ui{position:absolute;height:46px;width:100%;align-items:center;display:flex;visibility:hidden}.header-footer-edit-ui.header-edit-ui{inset-block-start:143px}.header-footer-edit-ui.footer-edit-ui{inset-block-end:143px}.header-footer-edit-ui.active{visibility:visible}.header-footer-edit-ui .box-shadow-div{width:100%;height:100%;overflow:hidden;position:absolute;display:flex;align-items:center}.header-footer-edit-ui .box-shadow-div:after{content:"";position:absolute;width:100%;height:40px;padding:3px 0;background-color:var(--gray-0);box-shadow:0 0 3px 0 var(--gray-7);z-index:-1}.header-footer-edit-ui .label{color:var(--gray-8);font-size:.8125rem;font-weight:700;margin-inline-start:16px}.header-footer-edit-ui .options-dropdown-container{position:absolute;inset-inline-end:16px}.header-footer-edit-ui .options-dropdown-container .options-button{color:var(--blue-5);padding:8px 32px 8px 8px;background:transparent;width:auto;border:none;cursor:pointer}.header-footer-edit-ui .options-dropdown-container .options-button .Icon{width:16px;height:16px;position:absolute;inset-inline-end:9.5px;inset-block-start:0;inset-block-end:0;margin:auto;color:var(--blue-5)}.header-footer-edit-ui .options-dropdown-container .options-button.active,.header-footer-edit-ui .options-dropdown-container .options-button.active .Icon,.header-footer-edit-ui .options-dropdown-container .options-button:hover,.header-footer-edit-ui .options-dropdown-container .options-button:hover .Icon{color:var(--blue-6)}.header-footer-edit-ui .options-dropdown-container .options-button.active .Icon{transform:rotate(180deg)}.header-footer-edit-ui .options-dropdown-container .Dropdown__items{padding:4px 0;min-width:157px}.header-footer-edit-ui .options-dropdown-container .Dropdown__items .Dropdown__item{height:32px;padding:0 10px 0 40px;position:relative;width:auto}.header-footer-edit-ui .options-dropdown-container .Dropdown__items .Dropdown__item:first-child{margin-bottom:9px}.header-footer-edit-ui .options-dropdown-container .Dropdown__items .Dropdown__item .Icon{position:absolute;inset-inline-start:10px;fill:var(--gray-7);inset-block-start:0;inset-block-end:0;margin:auto}.header-footer-edit-ui .options-dropdown-container .Dropdown__items .Divider{flex-basis:100%;width:100%;height:1px;margin:0;position:absolute;inset-block-end:-5px;inset-inline-start:0}',""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsOverlay.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".HeaderFooterControlsOverlay{position:absolute;inset-block-start:0;inset-inline-start:0;width:100%;height:100%;z-index:501}",""]),module.exports=exports},"./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsBar/HeaderFooterControlsBar.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsBar/HeaderFooterControlsBar.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsOverlay.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_HeaderFooterControlsOverlay_HeaderFooterControlsOverlay});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),react_dom=__webpack_require__("./node_modules/react-dom/index.js"),getRootNode=__webpack_require__("./src/helpers/getRootNode.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),Icon=__webpack_require__("./src/components/Icon/index.js"),ActionButton=__webpack_require__("./src/components/ActionButton/index.js"),VisuallyHiddenLabel=__webpack_require__("./src/components/VisuallyHiddenLabel/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),actions=__webpack_require__("./src/redux/actions/index.js"),dataElement=__webpack_require__("./src/constants/dataElement.js"),Dropdown=__webpack_require__("./src/components/Dropdown/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),core=__webpack_require__("./src/core/index.js"),headerFooterModalState=__webpack_require__("./src/helpers/headerFooterModalState.js"),constants_officeEditor=__webpack_require__("./src/constants/officeEditor.js");__webpack_require__("./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsBar/HeaderFooterControlsBar.scss");const propTypes={type:prop_types_default().oneOf(["header","footer"]),pageNumber:prop_types_default().number,isActive:prop_types_default().bool},MOUSE_EVENTS_TYPES=["click","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu"],HeaderFooterControlsBar_HeaderFooterControlsBar=({type,pageNumber,isActive})=>{const[t]=(0,useTranslation.B)(),dispatch=(0,es.wA)(),doc=core.A.getDocument(),officeEditor=doc.getOfficeEditor(),blockerRef=(0,react.useRef)(),dropdownId=`${type}-options-dropdown-${pageNumber}`,barId=`${type}-edit-ui-${pageNumber}`,[containerStyle,setContainerStyle]=(0,react.useState)({}),[sectionNumber,setSectionNumber]=(0,react.useState)(null),[headerType,setHeaderType]=(0,react.useState)(0),[footerType,setFooterType]=(0,react.useState)(0),[optionsDisabled,setOptionsDisabled]=(0,react.useState)(!1),[showHeaderBar,setShowHeaderBar]=(0,react.useState)(!1),[showFooterBar,setShowFooterBar]=(0,react.useState)(!1),barClassName=(0,react.useMemo)((()=>{const showBar="header"===type?showHeaderBar:showFooterBar;return classnames_default()("header-footer-edit-ui",`${type}-edit-ui`,{active:isActive&&showBar})}),[type,isActive,showHeaderBar,showFooterBar]),getHeaderFooterTop=()=>{const heightOfBar=blockerRef.current?.clientHeight||0;switch(type){case"header":return officeEditor.getHeaderPosition(pageNumber);case"footer":return officeEditor.getFooterPosition(pageNumber)-heightOfBar;default:return 0}},updateHeaderFooterSectionNumber=async()=>{const sectionNumber=await officeEditor.getSectionNumber(pageNumber);setSectionNumber(sectionNumber)};(0,react.useEffect)((async()=>{const onBarClick=event=>{"mousedown"===event.type&&dispatch(actions.A.closeElements([dataElement.A.CONTEXT_MENU_POPUP])),event.stopPropagation()};MOUSE_EVENTS_TYPES.forEach((eventType=>{blockerRef.current.addEventListener(eventType,onBarClick)}));const onHeaderFooterUpdated=()=>{updateHeaderFooterTop(),updateHeaderFooterSectionNumber()},updateHeaderFooterTop=()=>{const top=getHeaderFooterTop();top>0&&setContainerStyle({top})};doc.addEventListener("headerFooterUpdated",onHeaderFooterUpdated);const onEditModeUpdated=editMode=>{const isReadOnlyMode=editMode===constants_officeEditor.r8.VIEW_ONLY||editMode===constants_officeEditor.r8.PREVIEW;setOptionsDisabled(isReadOnlyMode)};doc.addEventListener("editModeUpdated",onEditModeUpdated);return setContainerStyle((()=>{const headerFooterStyle="header"===type?{top:constants_officeEditor.Ib}:{bottom:constants_officeEditor.Ib},top=getHeaderFooterTop();return top>0?{top}:headerFooterStyle})()),()=>{MOUSE_EVENTS_TYPES.forEach((eventType=>{blockerRef.current?.removeEventListener(eventType,onBarClick)})),doc.removeEventListener("headerFooterUpdated",onHeaderFooterUpdated),doc.removeEventListener("editModeUpdated",onEditModeUpdated)}}),[isActive]),(0,react.useEffect)((()=>{const onLayoutChange=e=>{if("headerFooter"!==e.source)return;const headerType=officeEditor.getHeaderPageType(pageNumber),footerType=officeEditor.getFooterPageType(pageNumber);-1!==headerType&&(setShowHeaderBar(!0),setHeaderType(headerType)),-1!==footerType&&(setShowFooterBar(!0),setFooterType(footerType))};return doc.addEventListener("officeDocumentEdited",onLayoutChange),()=>{doc.removeEventListener("officeDocumentEdited",onLayoutChange)}}),[pageNumber]),(0,react.useEffect)((()=>{updateHeaderFooterSectionNumber();const headerType=officeEditor.getHeaderPageType(pageNumber),footerType=officeEditor.getFooterPageType(pageNumber);-1!==headerType&&(setShowHeaderBar(!0),setHeaderType(headerType)),-1!==footerType&&(setShowFooterBar(!0),setFooterType(footerType))}),[isActive,pageNumber]);const dropdownItems=[{label:t("officeEditor.pageOptions"),key:"page-options",icon:"ic-edit-page",onClick:async()=>{headerFooterModalState.A.setPageNumber(pageNumber),dispatch(actions.A.openElement(dataElement.A.HEADER_FOOTER_OPTIONS_MODAL))}},{label:t("header"===type?"officeEditor.removeHeader":"officeEditor.removeFooter"),key:`remove-${type}`,icon:"ic-delete-page",onClick:()=>"header"===type?officeEditor.removeHeaders(pageNumber):"footer"===type?officeEditor.removeFooters(pageNumber):void 0}],barLabelKey=`officeEditor.${type}.${"header"===type?headerType:footerType}`,sectionLabel=sectionNumber?` - ${t("officeEditor.section")} ${sectionNumber}`:"",barLabel=`${t(barLabelKey)}${sectionLabel}`,buttonLabel=`${barLabel} ${t("officeEditor.options")}`,buttonLabelId=`${dropdownId}-label`;return(0,jsx_runtime.jsxs)("div",{className:barClassName,id:barId,style:containerStyle,children:[(0,jsx_runtime.jsx)("div",{className:"box-shadow-div",ref:blockerRef}),(0,jsx_runtime.jsx)("div",{className:"label",children:barLabel}),(0,jsx_runtime.jsx)(Dropdown.A,{width:"auto",id:dropdownId,renderItem:item=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Icon.A,{glyph:item.icon,className:"Dropdown__item-icon"}),(0,jsx_runtime.jsx)("div",{className:"Dropdown__item-vertical",children:(0,jsx_runtime.jsx)("div",{className:"Dropdown__item-label",children:t(item.label)})}),"page-options"===item.key&&(0,jsx_runtime.jsx)("div",{className:"Divider"})]}),className:"options-dropdown-container",getKey:item=>item.key,items:dropdownItems,onClickItem:async itemKey=>{const item=dropdownItems.find((item=>item.key===itemKey));await(item?.onClick())},displayButton:isOpen=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(ActionButton.A,{className:"options-button",ariaLabelledby:buttonLabelId,ariaControls:`${dropdownId}-dropdown`,ariaExpanded:isOpen,img:"ic_chevron_down_black_24px",label:t("officeEditor.options"),isActive:isOpen,disabled:optionsDisabled}),(0,jsx_runtime.jsx)(VisuallyHiddenLabel.A,{id:buttonLabelId,label:buttonLabel})]}),labelledById:buttonLabelId,stopPropagationOnMouseDown:!0,disabled:optionsDisabled})]})};HeaderFooterControlsBar_HeaderFooterControlsBar.propTypes=propTypes;const HeaderFooterControlsOverlay_HeaderFooterControlsBar_HeaderFooterControlsBar=react.memo(HeaderFooterControlsBar_HeaderFooterControlsBar);HeaderFooterControlsBar_HeaderFooterControlsBar.__docgenInfo={description:"",methods:[],displayName:"HeaderFooterControlsBar",props:{type:{description:"",type:{name:"enum",value:[{value:"'header'",computed:!1},{value:"'footer'",computed:!1}]},required:!1},pageNumber:{description:"",type:{name:"number"},required:!1},isActive:{description:"",type:{name:"bool"},required:!1}}};const HeaderFooterControlsOverlay_HeaderFooterControlsBar=HeaderFooterControlsOverlay_HeaderFooterControlsBar_HeaderFooterControlsBar;__webpack_require__("./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsOverlay.scss");const HeaderFooterControlsOverlay_propTypes={visiblePages:prop_types_default().arrayOf(prop_types_default().number),isHeaderControlsActive:prop_types_default().bool,isFooterControlsActive:prop_types_default().bool},HeaderFooterControlsOverlay_HeaderFooterControlsOverlay=({visiblePages,isHeaderControlsActive,isFooterControlsActive})=>{const portals=visiblePages.map((pageNumber=>{const pageSection=(0,getRootNode.Ay)().getElementById(`pageSection${pageNumber}`);return pageSection?(0,react_dom.createPortal)((0,jsx_runtime.jsxs)("div",{className:"HeaderFooterControlsOverlay",children:[(0,jsx_runtime.jsx)(HeaderFooterControlsOverlay_HeaderFooterControlsBar,{type:"header",pageNumber,isActive:isHeaderControlsActive}),(0,jsx_runtime.jsx)(HeaderFooterControlsOverlay_HeaderFooterControlsBar,{type:"footer",pageNumber,isActive:isFooterControlsActive})]},pageNumber),pageSection):null}));return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:portals})};HeaderFooterControlsOverlay_HeaderFooterControlsOverlay.propTypes=HeaderFooterControlsOverlay_propTypes;const components_HeaderFooterControlsOverlay_HeaderFooterControlsOverlay=HeaderFooterControlsOverlay_HeaderFooterControlsOverlay;HeaderFooterControlsOverlay_HeaderFooterControlsOverlay.__docgenInfo={description:"",methods:[],displayName:"HeaderFooterControlsOverlay",props:{visiblePages:{description:"",type:{name:"arrayOf",value:{name:"number"}},required:!1},isHeaderControlsActive:{description:"",type:{name:"bool"},required:!1},isFooterControlsActive:{description:"",type:{name:"bool"},required:!1}}}},"./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsOverlay.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsOverlay.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/HeaderFooterControlsOverlay/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./src/components/HeaderFooterControlsOverlay/HeaderFooterControlsOverlay.js").A},"./src/helpers/headerFooterModalState.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=(()=>{let pageNumber=0;return{setPageNumber:val=>pageNumber=val,getPageNumber:()=>pageNumber}})()}}]);