"use strict";(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[95567],{"./src/components/OfficeEditorColumnsModal/OfficeEditorColumnsModal.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Basic:()=>Basic,ColumnCalculation:()=>ColumnCalculation,UnitConversion:()=>UnitConversion,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),reducers_rootReducer__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/redux/reducers/rootReducer.js")),_OfficeEditorColumnsModal__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/OfficeEditorColumnsModal/OfficeEditorColumnsModal.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),react_redux__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react-redux/es/index.js"),storybook_test__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("storybook/test"),helpers_officeEditor__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/helpers/officeEditor.js");const __WEBPACK_DEFAULT_EXPORT__={title:"Components/OfficeEditorColumnsModal",component:_OfficeEditorColumnsModal__WEBPACK_IMPORTED_MODULE_3__.A},store=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_7__.U1)({reducer:reducers_rootReducer__WEBPACK_IMPORTED_MODULE_2__.A});function Basic(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_redux__WEBPACK_IMPORTED_MODULE_4__.Kq,{store,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_OfficeEditorColumnsModal__WEBPACK_IMPORTED_MODULE_3__.A,{})})}const getColumnInputs=(canvas,numberOfColums)=>new Array(numberOfColums).fill().map(((_,i)=>({width:canvas.getByLabelText(`Column ${i+1} Width`),spacing:i<numberOfColums-1?canvas.getByLabelText(`Column ${i+1} Spacing`):{value:"0"}})));Basic.play=async({canvasElement})=>{const columnAmountInput=(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.within)(canvasElement).getByLabelText("Number of Columns");await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(columnAmountInput,"{backspace}"),(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(columnAmountInput.value).toBe(""),await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(columnAmountInput,"0"),(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(columnAmountInput.value).toBe("0"),await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(columnAmountInput,"{backspace}-9"),(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(columnAmountInput.value).toBe("1"),await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(columnAmountInput,"{backspace}5{backspace}{tab}"),(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(columnAmountInput.value).toBe("5"),await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(columnAmountInput,"{backspace}0{tab}"),(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(columnAmountInput.value).toBe("5")};const ColumnCalculation=()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Basic,{});ColumnCalculation.play=async({canvasElement})=>{const canvas=(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.within)(canvasElement),columnAmountInput=canvas.getByLabelText("Number of Columns"),equalWidthCheckbox=canvas.getByLabelText("Equal Column Width");await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.click(equalWidthCheckbox),(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(equalWidthCheckbox.checked).toBe(!1),await(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.waitFor)((()=>(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(canvas.getByLabelText("Column 1 Width").valueAsNumber).toBe(11.11))),await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(columnAmountInput,"{backspace}5"),(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(columnAmountInput.value).toBe("5");const inputs=getColumnInputs(canvas,5),expectInputsToBeWithinLimits=async()=>{await(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.waitFor)((()=>(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(inputs.reduce(((acc,input)=>acc+parseFloat(input.width.value)+parseFloat(input.spacing.value)),0)).toBeCloseTo(11.11)))};for(const input of inputs)await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.clear(input.width),await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(input.width,"3[Tab]"),await expectInputsToBeWithinLimits();for(let i=0;i<inputs.length-1;i++)await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.clear(inputs[i].spacing),await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(inputs[i].spacing,"0.5[Tab]"),await expectInputsToBeWithinLimits();await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(columnAmountInput,"{backspace}1"),(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(canvas.getByLabelText("Column 1 Width").valueAsNumber).toBe(11.11)};const UnitConversion=()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Basic,{});UnitConversion.play=async({canvasElement})=>{const canvas=(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.within)(canvasElement),singleColumnWidthInch=(0,helpers_officeEditor__WEBPACK_IMPORTED_MODULE_6__.if)(11.11,"cm","inch"),unitButton=await canvas.findByRole("combobox",{name:"Unit Measurement"});await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.click(unitButton);const inchOption=canvas.getByRole("option",{name:"inch"});await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.click(inchOption),await(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.waitFor)((()=>(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(canvas.getByLabelText("Column 1 Width").valueAsNumber).toBeCloseTo(singleColumnWidthInch,1)));const columnAmountInput=canvas.getByLabelText("Number of Columns");columnAmountInput.focus(),columnAmountInput.value="",await storybook_test__WEBPACK_IMPORTED_MODULE_5__.userEvent.type(columnAmountInput,"3[Tab]");const inputs=getColumnInputs(canvas,3);await(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.waitFor)((()=>(0,storybook_test__WEBPACK_IMPORTED_MODULE_5__.expect)(inputs.reduce(((acc,input)=>acc+parseFloat(input.width.value)+parseFloat(input.spacing.value)),0)).toBeCloseTo(singleColumnWidthInch,1)))};const __namedExportsOrder=["Basic","ColumnCalculation","UnitConversion"]},"./src/helpers/officeEditorColumnsHelper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{gY:()=>checkEqualColumnWidths,ki:()=>modifyColumns,vX:()=>modifyColumnsInReverse});var helpers_officeEditor__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/helpers/officeEditor.js"),constants_officeEditor__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/constants/officeEditor.js");const setColumnValue=({columns,index,endIndex,excessAmount,excessAmountPerColumn,type})=>{const newColumns=[...columns];let newValue=newColumns[index][type]-excessAmountPerColumn,nextExcess={excessAmount,excessAmountPerColumn};const minimumValue=(type=>type===constants_officeEditor__WEBPACK_IMPORTED_MODULE_1__.U_.WIDTH?(0,helpers_officeEditor__WEBPACK_IMPORTED_MODULE_0__.VW)(constants_officeEditor__WEBPACK_IMPORTED_MODULE_1__.nm.CM):0)(type);if(newValue<minimumValue){const newExcess=(({newValue,minimumValue,excessAmount,excessAmountPerColumn,numberOfRemainingColumns})=>{const remainingExcess=minimumValue-newValue;return{excessAmount:excessAmount-=excessAmountPerColumn-remainingExcess,excessAmountPerColumn:excessAmount<0?(excessAmount+remainingExcess)/numberOfRemainingColumns:remainingExcess}})({newValue,minimumValue,excessAmount,excessAmountPerColumn,numberOfRemainingColumns:endIndex-index});nextExcess.excessAmount=newExcess.excessAmount,nextExcess.excessAmountPerColumn=newExcess.excessAmountPerColumn,newValue=minimumValue}else nextExcess.excessAmount=excessAmount-excessAmountPerColumn;return newColumns[index][type]=(0,helpers_officeEditor__WEBPACK_IMPORTED_MODULE_0__.rF)(newValue),{newColumns,nextExcess}},calculateExcessAmountPerColumn=(excessAmount,numberOfColumns)=>excessAmount<0?excessAmount/numberOfColumns:excessAmount,modifyColumns=({columns,excessAmount,startIndex,endIndex,numberOfColumns,type})=>{let excessAmountPerColumn=calculateExcessAmountPerColumn(excessAmount,numberOfColumns),excessAmountRemaining=excessAmount,nextColumns=[...columns];for(let i=startIndex;i<=endIndex&&0!==excessAmountRemaining;i++){const{newColumns,nextExcess}=setColumnValue({columns:nextColumns,index:i,endIndex,excessAmount:excessAmountRemaining,excessAmountPerColumn,type});excessAmountPerColumn=nextExcess.excessAmountPerColumn,excessAmountRemaining=nextExcess.excessAmount,nextColumns=[...newColumns]}return{nextColumns,excessAmountRemaining}},modifyColumnsInReverse=({columns,excessAmount,startIndex,endIndex,numberOfColumns,type,skipIndex=-1})=>{let excessAmountPerColumn=calculateExcessAmountPerColumn(excessAmount,numberOfColumns),excessAmountRemaining=excessAmount,nextColumns=[...columns];for(let i=startIndex;i>=endIndex&&0!==excessAmountRemaining;i--){if(skipIndex>-1&&i===skipIndex)continue;const{newColumns,nextExcess}=setColumnValue({columns:nextColumns,index:i,endIndex:startIndex,excessAmount:excessAmountRemaining,excessAmountPerColumn,type});excessAmountPerColumn=nextExcess.excessAmountPerColumn,excessAmountRemaining=nextExcess.excessAmount,nextColumns=[...newColumns]}return{nextColumns,excessAmountRemaining}},checkEqualColumnWidths=columns=>{const width=columns[0],spacing=columns[1],widthEqual=columns.filter(((_,i)=>i%2==0)).every((val=>val===width));return columns.filter(((_,i)=>i%2==1)).every((val=>val===spacing))&&widthEqual}},"./src/redux/reducers/featureFlagsReducer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=initialState=>(state=initialState,action)=>{const{type,payload}=action;switch(type){case"ENABLE_FEATURE_FLAG":return{...state,[payload.featureFlag]:!0};case"DISABLE_FEATURE_FLAG":return{...state,[payload.featureFlag]:!1};default:return state}}},"./src/redux/reducers/rootReducer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>rootReducer});var redux=__webpack_require__("./node_modules/redux/es/redux.js"),initialState=__webpack_require__("./src/redux/initialState.js"),viewerReducer=__webpack_require__("./src/redux/reducers/viewerReducer.js");var featureFlagsReducer=__webpack_require__("./src/redux/reducers/featureFlagsReducer.js");const colorSetters={SET_CELL_BACKGROUND_COLORS:"cellBackgroundColors",SET_TEXT_COLORS:"textColors",SET_BORDER_COLORS:"borderColors"};var getRootNode=__webpack_require__("./src/helpers/getRootNode.js"),es=__webpack_require__("./node_modules/redux-persist/es/index.js"),storage=__webpack_require__("./node_modules/redux-persist/lib/storage/index.js");const instanceId=(0,getRootNode.zd)(),viewerPersistConfig={key:`viewer-${instanceId}`,storage:storage.A,whitelist:["toolbarGroup","lastPickedToolForGroup","lastPickedToolGroup","activeGroupedItems","lastActiveToolForRibbon","activeCustomRibbon","currentLanguage","activeTheme","fadePageNavigationComponent","toolDefaultStyleUpdateFromAnnotationPopupEnabled","enableNoteSubmissionWithEnter","isWidgetHighlightingEnabled","isCommentThreadExpansionEnabled","isNotesPanelRepliesCollapsingEnabled","isNotesPanelTextCollapsingEnabled","pageDeletionConfirmationModalEnabled","thumbnailSelectingPages","shortcutKeyMap"]},searchPersistConfig={key:`search-${instanceId}`,storage:storage.A,whitelist:["clearSearchPanelOnClose"]},officeEditorPersistConfig={key:`office-editor-${instanceId}`,storage:storage.A,whitelist:["unitMeasurement"]},rootReducer=(0,redux.HY)({viewer:(0,es.rL)(viewerPersistConfig,(0,viewerReducer.A)(initialState.A.viewer)),search:(0,es.rL)(searchPersistConfig,(initialState=>(state=initialState,action)=>{const{type,payload}=action;switch(type){case"SEARCH_TEXT":{const{searchValue,replaceValue,options={}}=payload,{caseSensitive,wholeWord,wildcard,regex,searchUp,ambientString}=options;return{...state,value:searchValue,replaceValue,nextResult:null,nextResultIndex:null,isCaseSensitive:caseSensitive||!1,isWholeWord:wholeWord||!1,isWildcard:wildcard||!1,isRegex:regex||!1,isSearchUp:searchUp||!1,isAmbientString:ambientString||!1}}case"SEARCH_TEXT_FULL":{const{searchValue,options={}}=payload,{caseSensitive,wholeWord,wildcard,regex}=options;return{...state,value:searchValue,isCaseSensitive:caseSensitive||!1,isWholeWord:wholeWord||!1,isWildcard:wildcard||!1,isRegex:regex||!1,isSearchUp:!1,isAmbientString:!0}}case"SET_SEARCH_VALUE":return{...state,value:payload.value,nextResult:null,nextResultIndex:null};case"SET_REPLACE_VALUE":return{...state,replaceValue:payload.replaceText};case"SET_NEXT_RESULT":return{...state,nextResult:payload.nextResult,nextResultIndex:payload.nextResultIndex};case"ADD_RESULT":return{...state,results:[...state.results,payload.result]};case"SET_CASE_SENSITIVE":return{...state,isCaseSensitive:payload.isCaseSensitive,nextResult:null,nextResultIndex:null};case"SET_WHOLE_WORD":return{...state,isWholeWord:payload.isWholeWord,nextResult:null,nextResultIndex:null};case"SET_WILD_CARD":return{...state,isWildcard:payload.isWildcard,nextResult:null,nextResultIndex:null};case"SET_SEARCH_ERROR":return{...state,errorMessage:payload.errorMessage};case"RESET_SEARCH":return{...initialState,value:state.value,isCaseSensitive:state.isCaseSensitive,isWholeWord:state.isWholeWord,isWildcard:state.isWildcard,nextResult:null,nextResultIndex:null};case"SET_SEARCH_RESULTS":return{...state,results:payload};case"SET_CLEAR_SEARCH_ON_PANEL_CLOSE":return{...state,clearSearchPanelOnClose:payload};case"SET_PROCESSING_SEARCH_RESULTS":return{...state,isProcessingSearchResults:payload.isProcessingSearchResults};case"REPLACE_REDACTION_SEARCH_PATTERN":return{...state,redactionSearchPatterns:{...state.redactionSearchPatterns,[payload.searchPattern]:{...state.redactionSearchPatterns[payload.searchPattern],regex:payload.regex}}};case"ADD_REDACTION_SEARCH_PATTERN":return{...state,redactionSearchPatterns:{...state.redactionSearchPatterns,[payload.searchPattern.type]:payload.searchPattern}};case"REMOVE_REDACTION_SEARCH_PATTERN":{const updatedRedactionSearchPatterns={...state.redactionSearchPatterns};return delete updatedRedactionSearchPatterns[payload.searchPatternType],{...state,redactionSearchPatterns:updatedRedactionSearchPatterns}}default:return state}})(initialState.A.search)),user:(initialState=>(state=initialState,action)=>{const{type,payload}=action;switch(type){case"SET_USER_NAME":return{...state,name:payload.userName};case"SET_ADMIN_USER":return{...state,isAdmin:payload.isAdminUser};default:return state}})(initialState.A.user),document:(initialState=>(state=initialState,action)=>{const{type,payload}=action;switch(type){case"SET_DOCUMENT_FILE":return{...state,file:payload.documentFile,path:payload.documentFile.name,pdfDoc:null};case"SET_PAGE_NUMBER":return{...state,pageNumber:payload.documentPageNumber};case"SET_TOTAL_PAGES":return{...state,totalPages:{...state.totalPages,[payload.documentViewerKey]:payload.totalPages}};case"SET_OUTLINES":return{...state,outlines:payload.outlines};case"SET_BOOKMARKS":return{...state,bookmarks:payload.bookmarks};case"SET_PORTFOLIO":return{...state,portfolio:payload.portfolio};case"SET_LAYERS":return{...state,layers:payload.layers};case"SET_PASSWORD_ATTEMPTS":return{...state,passwordAttempts:payload.attempt};case"SET_PRINT_QUALITY":return{...state,printQuality:payload.quality};case"SET_DEFAULT_PRINT_OPTIONS":return{...state,defaultPrintOptions:payload.options};case"SET_LOADING_PROGRESS":return{...state,loadingProgress:payload.progress};default:return state}})(initialState.A.document),advanced:()=>initialState.A.advanced,featureFlags:(0,featureFlagsReducer.A)(initialState.A.featureFlags),wv3dPropertiesPanel:(initialState=>(state=initialState,action)=>{const{type,payload}=action;switch(type){case"SET_WV3D_PROPERTIES_PANEL_MODEL_DATA":{const{modelData}=payload;return{...state,modelData}}case"SET_WV3D_PROPERTIES_PANEL_SCHEMA":{const{schema}=payload;return{...state,schema}}default:return state}})(initialState.A.wv3dPropertiesPanel),officeEditor:(0,es.rL)(officeEditorPersistConfig,(initialState=>(state=initialState,action)=>{const{type,payload}=action;switch(type){case"SET_OFFICE_EDITOR_CURSOR_PROPERTIES":{const{cursorProperties}=payload;return{...state,cursorProperties}}case"SET_OFFICE_EDITOR_SELECTION_PROPERTIES":{const{selectionProperties}=payload;return{...state,selectionProperties}}case"SET_OFFICE_EDITOR_CAN_UNDO":{const{canUndo}=payload;return{...state,canUndo}}case"SET_OFFICE_EDITOR_CAN_REDO":{const{canRedo}=payload;return{...state,canRedo}}case"ADD_OFFICE_EDITOR_AVAILABLE_FONT_FACE":{const{fontFace}=payload,fontFaces=state.availableFontFaces.slice();return fontFaces.push(fontFace),{...state,availableFontFaces:fontFaces.sort()}}case"SET_OFFICE_EDITOR_EDIT_MODE":return{...state,editMode:payload.editMode};case"SET_OFFICE_EDITOR_ACTIVE_STREAM":return{...state,stream:payload.stream};case"SET_OFFICE_EDITOR_UNIT_MEASUREMENT":return{...state,unitMeasurement:payload.unitMeasurement};default:return state}})(initialState.A.officeEditor)),digitalSignatureValidation:(initialState=>(state=initialState,action)=>{const{type,payload}=action;switch(type){case"SET_VALIDATION_MODAL_WIDGET_NAME":return{...state,validationModalWidgetName:payload.validationModalWidgetName};case"SET_VERIFICATION_RESULT":return{...state,verificationResult:payload.result};case"ADD_TRUSTED_CERTIFICATES":return{...state,certificates:[...state.certificates,...payload.certificates]};case"ADD_TRUST_LIST":return{...state,trustLists:[...state.trustLists,payload.trustList]};case"SET_IS_REVOCATION_CHECKING_ENABLED":return{...state,isRevocationCheckingEnabled:payload.isRevocationCheckingEnabled};case"SET_REVOCATION_PROXY_PREFIX":return{...state,revocationProxyPrefix:payload.revocationProxyPrefix};default:return state}})(initialState.A.digitalSignatureValidation),spreadsheetEditor:(initialState=>(state=initialState,action)=>{const{type,payload}=action;if(type in colorSetters)return{...state,[colorSetters[type]]:[...payload.colors]};switch(type){case"SET_ACTIVE_CELL_RANGE":{const{activeCellRange,cellProperties}=payload;return{...state,activeCellRange,cellProperties:{...cellProperties}}}case"SET_SPREADSHEET_EDITOR_EDIT_MODE":return{...state,editMode:payload.mode};case"SET_ACTIVE_CELL_RANGE_STYLE":{const{styles}=payload;return{...state,cellProperties:{...state.cellProperties,styles:{...state.cellProperties.styles,...styles,font:{...state.cellProperties.styles.font,...styles.font||{}}}}}}case"SET_SELECTED_BORDER_COLOR_OPTION":{const{selectedBorderColorOption}=payload;return{...state,selectedBorderColorOption}}case"SET_SELECTED_BORDER_STYLE_OPTION":{const{selectedBorderStyleListOption}=payload;return{...state,selectedBorderStyleListOption}}default:return state}})(initialState.A.spreadsheetEditor)})}}]);