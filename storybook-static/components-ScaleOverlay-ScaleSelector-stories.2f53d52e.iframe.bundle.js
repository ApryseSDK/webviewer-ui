"use strict";(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[7564],{"./src/components/ScaleOverlay/ScaleSelector.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Basic:()=>Basic,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_ScaleSelector__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/ScaleOverlay/ScaleSelector.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),react_redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-redux/es/index.js"),core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/core/index.js");__webpack_require__("./src/components/ScaleOverlay/ScaleOverlay.scss");const __WEBPACK_DEFAULT_EXPORT__={title:"Components/ScaleOverlay/ScaleSelector",component:_ScaleSelector__WEBPACK_IMPORTED_MODULE_1__.A};var scales=[{_pageScale:{value:1,unit:"mm"},_worldScale:{value:10,unit:"mm"},pageScale:{value:1,unit:"mm"},worldScale:{value:10,unit:"mm"}}],selectedScales=["1 mm = 10 mm"],initialState={viewer:{currentPage:1,isDocumentReadOnly:!1}};function Basic(){return core__WEBPACK_IMPORTED_MODULE_3__.A.getScalePrecision=function(){return!0},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_redux__WEBPACK_IMPORTED_MODULE_2__.Kq,{store:(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_5__.U1)({reducer:function(){return initialState}})},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"ScaleOverlay"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"scale-overlay-header"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ScaleSelector__WEBPACK_IMPORTED_MODULE_1__.A,{scales,selectedScales,onScaleSelected:function(){},onAddingNewScale:function(){}}))))}Basic.parameters={...Basic.parameters,docs:{...Basic.parameters?.docs,source:{originalSource:"function Basic() {\n  core.getScalePrecision = () => true;\n  return <ReduxProvider store={configureStore({\n    reducer: () => initialState\n  })}>\n      <div className='ScaleOverlay'>\n        <div className='scale-overlay-header'>\n          <ScaleSelector scales={scales} selectedScales={selectedScales} onScaleSelected={() => {}} onAddingNewScale={() => {}} />\n        </div>\n      </div>\n    </ReduxProvider>;\n}",...Basic.parameters?.docs?.source}}};const __namedExportsOrder=["Basic"]},"./src/components/Button/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _Button__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/Button/Button.js");const __WEBPACK_DEFAULT_EXPORT__=_Button__WEBPACK_IMPORTED_MODULE_0__.A;_Button__WEBPACK_IMPORTED_MODULE_0__.A.__docgenInfo={description:"",methods:[],displayName:"Button",props:{isActive:{description:"",type:{name:"bool"},required:!1},mediaQueryClassName:{description:"",type:{name:"string"},required:!1},img:{description:"",type:{name:"string"},required:!1},label:{description:"",type:{name:"union",value:[{name:"string"},{name:"number"}]},required:!1},title:{description:"",type:{name:"string"},required:!1},color:{description:"",type:{name:"string"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},onClick:{description:"",type:{name:"func"},required:!1},onDoubleClick:{description:"",type:{name:"func"},required:!1},onMouseUp:{description:"",type:{name:"func"},required:!1},isSubmitType:{description:"",type:{name:"bool"},required:!1},ariaLabel:{description:"Will override translated title if both given.",type:{name:"string"},required:!1},ariaControls:{description:"",type:{name:"string"},required:!1},role:{description:"",type:{name:"string"},required:!1},hideTooltipShortcut:{description:"",type:{name:"bool"},required:!1},useI18String:{description:"",type:{name:"bool"},required:!1},shouldPassActiveDocumentViewerKeyToOnClickHandler:{description:"",type:{name:"bool"},required:!1},children:{description:"",type:{name:"node"},required:!1}}}},"./src/components/DataElementWrapper/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>components_DataElementWrapper});var prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js");function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_define_property(target,key,source[key])}))}return target}function _object_without_properties(source,excluded){if(null==source)return{};var key,i,target=function _object_without_properties_loose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var propTypes={id:prop_types_default().string,children:prop_types_default().node,dataElement:prop_types_default().string,type:prop_types_default().string,ariaLabel:prop_types_default().string};var DataElementWrapper=react.forwardRef((function(_param,ref){var _param_type=_param.type,type=void 0===_param_type?"div":_param_type,children=_param.children,dataElement=_param.dataElement,ariaLabel=_param.ariaLabel,props=_object_without_properties(_param,["type","children","dataElement","ariaLabel"]),isDisabled=function useIsDisabledWithDefaultValue(selector){var defaultValue=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return(0,es.d4)(selector)}catch(e){e.message}return defaultValue}((function(state){return selectors.A.isElementDisabled(state,dataElement)}));return isDisabled?null:"button"===type?react.createElement("button",_object_spread({ref,"data-element":dataElement,"aria-label":ariaLabel},props),children):react.createElement("div",_object_spread({ref,"data-element":dataElement},props),children)}));DataElementWrapper.displayName="DataElementWrapper",DataElementWrapper.propTypes=propTypes;const DataElementWrapper_DataElementWrapper=DataElementWrapper;DataElementWrapper.__docgenInfo={description:"",methods:[],displayName:"DataElementWrapper",props:{type:{defaultValue:{value:"'div'",computed:!1},description:"",type:{name:"string"},required:!1},id:{description:"",type:{name:"string"},required:!1},children:{description:"",type:{name:"node"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},ariaLabel:{description:"Accessibility",type:{name:"string"},required:!1}}};const components_DataElementWrapper=DataElementWrapper_DataElementWrapper;DataElementWrapper_DataElementWrapper.__docgenInfo={description:"",methods:[],displayName:"DataElementWrapper",props:{type:{defaultValue:{value:"'div'",computed:!1},description:"",type:{name:"string"},required:!1},id:{description:"",type:{name:"string"},required:!1},children:{description:"",type:{name:"node"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},ariaLabel:{description:"Accessibility",type:{name:"string"},required:!1}}}},"./src/components/ScaleOverlay/ScaleSelector.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var classnames__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_0__),components_Icon__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/Icon/index.js"),components_DataElementWrapper__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/DataElementWrapper/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_10__),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/index.js"),react_i18next__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),actions__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/redux/actions/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react-redux/es/index.js"),selectors__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/redux/selectors/index.js"),core__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/core/index.js"),hooks_useOnClickOutside__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/hooks/useOnClickOutside.js"),components_Button__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/components/Button/index.js");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _sliced_to_array(arr,i){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||_unsupported_iterable_to_array(arr,i)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _to_consumable_array(arr){return function _array_without_holes(arr){if(Array.isArray(arr))return _array_like_to_array(arr)}(arr)||function _iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupported_iterable_to_array(arr)||function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupported_iterable_to_array(o,minLen){if(o){if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_array_like_to_array(o,minLen):void 0}}var propTypes={scales:prop_types__WEBPACK_IMPORTED_MODULE_10___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_10___default().object).isRequired,selectedScales:prop_types__WEBPACK_IMPORTED_MODULE_10___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_10___default().string).isRequired,onScaleSelected:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func.isRequired,onAddingNewScale:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func.isRequired},Scale=window.Core.Scale,ScaleSelector=function(param){var _param_scales=param.scales,scales=void 0===_param_scales?[]:_param_scales,_param_selectedScales=param.selectedScales,selectedScales=void 0===_param_selectedScales?[]:_param_selectedScales,onScaleSelected=param.onScaleSelected,onAddingNewScale=param.onAddingNewScale,ariaLabelledBy=param.ariaLabelledBy,t=_sliced_to_array((0,react_i18next__WEBPACK_IMPORTED_MODULE_11__.B)(),1)[0],dispatch=(0,react_redux__WEBPACK_IMPORTED_MODULE_5__.wA)(),isMultipleScalesMode=(0,react_redux__WEBPACK_IMPORTED_MODULE_5__.d4)((function(state){return selectors__WEBPACK_IMPORTED_MODULE_6__.A.getIsMultipleScalesMode(state)})),isMultipleScales=selectedScales.length>1,getScaleInfo=function(deleteScale){var scales=core__WEBPACK_IMPORTED_MODULE_7__.A.getScales(),measurements=[],relatedPages=new Set;return scales[deleteScale.toString()].forEach((function(measurementItem){(function _instanceof(left,right){return null!=right&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?!!right[Symbol.hasInstance](left):left instanceof right})(measurementItem,window.Core.Annotations.Annotation)&&(relatedPages.add(measurementItem.PageNumber),measurements.push(measurementItem))})),{measurementsNum:measurements.length,pages:_to_consumable_array(relatedPages)}},openScaleDeletionModal=function(scale){if(scale){var deleteScale=new Scale(scale),scaleInfo=getScaleInfo(deleteScale),warning={message:!!scaleInfo.pages.length?react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:"customMessage"},react__WEBPACK_IMPORTED_MODULE_3__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_3__.createElement("span",null,t("option.measurement.deleteScaleModal.scaleIsOn-delete-info"),react__WEBPACK_IMPORTED_MODULE_3__.createElement("b",null," ".concat(t("option.measurement.deleteScaleModal.page-delete-info")," ").concat(scaleInfo.pages.join(", ")," ")),t("option.measurement.deleteScaleModal.appliedTo-delete-info"),react__WEBPACK_IMPORTED_MODULE_3__.createElement("b",null," ".concat(scaleInfo.measurementsNum," ").concat(scaleInfo.measurementsNum>1?t("option.measurement.deleteScaleModal.measurements"):t("option.measurement.deleteScaleModal.measurement"),"."))),react__WEBPACK_IMPORTED_MODULE_3__.createElement("span",null," "),react__WEBPACK_IMPORTED_MODULE_3__.createElement("span",null,t("option.measurement.deleteScaleModal.deletionIs"),react__WEBPACK_IMPORTED_MODULE_3__.createElement("b",null," ".concat(t("option.measurement.deleteScaleModal.irreversible")," ")),t("option.measurement.deleteScaleModal.willDeleteMeasurement"))),react__WEBPACK_IMPORTED_MODULE_3__.createElement("p",null,t("option.measurement.deleteScaleModal.confirmDelete"))):react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:"customMessage"},react__WEBPACK_IMPORTED_MODULE_3__.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_3__.createElement("span",null,t("option.measurement.deleteScaleModal.confirmDelete"),t("option.measurement.deleteScaleModal.thisCantBeUndone")))),title:"".concat(t("option.measurement.deleteScaleModal.deleteScale")," ").concat(deleteScale.toString()),confirmBtnText:t("action.confirm"),onConfirm:function(){return core__WEBPACK_IMPORTED_MODULE_7__.A.deleteScale(deleteScale)}};dispatch(actions__WEBPACK_IMPORTED_MODULE_4__.A.showWarningMessage(warning))}},renderScale=function(scale){var precision=core__WEBPACK_IMPORTED_MODULE_7__.A.getScalePrecision(scale),pageScaleStr=Scale.getFormattedValue(scale.pageScale.value,scale.pageScale.unit,precision,!1),worldScaleStr=Scale.getFormattedValue(scale.worldScale.value,scale.worldScale.unit,precision,!1),scaleDisplay="".concat(pageScaleStr," = ").concat(worldScaleStr);return react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",null,scaleDisplay)},title=t("option.measurement.scaleOverlay.multipleScales");if(selectedScales.length&&!isMultipleScales){var selectedScale=new Scale(selectedScales[0]);title=renderScale(selectedScale)}var _useState=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(!1),2),isDropDownOpen=_useState[0],setOpenDropDown=_useState[1],toggleDropdown=function(){setOpenDropDown((function(prevValue){return!prevValue}))},selectorRef=(0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);(0,hooks_useOnClickOutside__WEBPACK_IMPORTED_MODULE_8__.A)(selectorRef,(function(){setOpenDropDown(!1)}));return react__WEBPACK_IMPORTED_MODULE_3__.createElement(components_DataElementWrapper__WEBPACK_IMPORTED_MODULE_2__.A,{className:"scale-overlay-selector",dataElement:"scaleSelector",tabIndex:-1,ref:selectorRef,onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||toggleDropdown()},onClick:toggleDropdown},react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{"data-testid":"scale-selector",className:"scale-overlay-selection","aria-expanded":isDropDownOpen,"aria-labelledby":ariaLabelledBy,role:"combobox",tabIndex:0},react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:"scale-overlay-item"},react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:"scale-overlay-name"},title),react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:"scale-overlay-arrow"},react__WEBPACK_IMPORTED_MODULE_3__.createElement(components_Icon__WEBPACK_IMPORTED_MODULE_1__.A,{glyph:"icon-chevron-down",ariaHidden:!0})))),isDropDownOpen&&react__WEBPACK_IMPORTED_MODULE_3__.createElement("ul",{className:classnames__WEBPACK_IMPORTED_MODULE_0___default()("scale-overlay-list")},react__WEBPACK_IMPORTED_MODULE_3__.createElement("li",null,react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:"scale-overlay-name"},title),react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:"scale-overlay-arrow"},react__WEBPACK_IMPORTED_MODULE_3__.createElement("button",{className:"scale-overlay-selected-arrow"},react__WEBPACK_IMPORTED_MODULE_3__.createElement(components_Icon__WEBPACK_IMPORTED_MODULE_1__.A,{glyph:"icon-chevron-up",ariaHidden:!0})))),scales.map((function(value){return react__WEBPACK_IMPORTED_MODULE_3__.createElement("li",{key:value.toString(),className:classnames__WEBPACK_IMPORTED_MODULE_0___default()({'className="scale-overlay-item':!0,"option-selected":selectedScales.includes(value.toString())})},react__WEBPACK_IMPORTED_MODULE_3__.createElement("button",{className:classnames__WEBPACK_IMPORTED_MODULE_0___default()({options:!0}),onClick:function(){return onScaleSelected(selectedScales,value.toString())},onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),onScaleSelected(selectedScales,value.toString()))}},renderScale(value)),react__WEBPACK_IMPORTED_MODULE_3__.createElement("button",{className:"delete",tabIndex:0,onClick:function(e){e.preventDefault(),e.stopPropagation(),openScaleDeletionModal(value.toString())},onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),openScaleDeletionModal(value.toString()))},disabled:scales.length<=1,"aria-label":"".concat(t("action.delete")," ").concat(value.toString())},react__WEBPACK_IMPORTED_MODULE_3__.createElement(components_Icon__WEBPACK_IMPORTED_MODULE_1__.A,{glyph:"icon-delete-line"})))})),isMultipleScalesMode&&react__WEBPACK_IMPORTED_MODULE_3__.createElement("li",null,react__WEBPACK_IMPORTED_MODULE_3__.createElement(components_Button__WEBPACK_IMPORTED_MODULE_9__.A,{onClick:onAddingNewScale,label:t("option.measurement.scaleOverlay.addNewScale"),className:"add-new-scale"}))))};ScaleSelector.propTypes=propTypes;const __WEBPACK_DEFAULT_EXPORT__=ScaleSelector;ScaleSelector.__docgenInfo={description:"",methods:[],displayName:"ScaleSelector",props:{scales:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"object"}},required:!1},selectedScales:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},onScaleSelected:{description:"",type:{name:"func"},required:!0},onAddingNewScale:{description:"",type:{name:"func"},required:!0}}}},"./src/hooks/useOnClickOutside.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),helpers_getRootNode__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/helpers/getRootNode.js");function __WEBPACK_DEFAULT_EXPORT__(ref,handler){(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var listener=function(event){ref.current&&!ref.current.contains(event.target)&&handler(event)},browserDocument=document;return window.isApryseWebViewerWebComponent&&(browserDocument=(0,helpers_getRootNode__WEBPACK_IMPORTED_MODULE_1__.Ay)().getElementById("app")),browserDocument.addEventListener("mousedown",listener),browserDocument.addEventListener("touchstart",listener),function(){browserDocument.removeEventListener("mousedown",listener),browserDocument.removeEventListener("touchstart",listener)}}),[ref,handler])}}}]);