(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[41949],{"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ScaleModal/ScaleModal.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".open.ScaleModal{visibility:visible}.closed.ScaleModal{visibility:hidden}:host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.ScaleModal .footer .modal-button.confirm:hover{background:var(--primary-button-hover);border-color:var(--primary-button-hover);color:var(--gray-0)}.ScaleModal .footer .modal-button.confirm{background:var(--primary-button);border-color:var(--primary-button);color:var(--primary-button-text)}.ScaleModal .footer .modal-button.confirm.disabled{cursor:default;background:var(--disabled-button-color);color:var(--primary-button-text)}.ScaleModal .footer .modal-button.confirm.disabled span{color:var(--primary-button-text)}.ScaleModal .footer .modal-button.cancel:hover,.ScaleModal .footer .modal-button.secondary-btn-custom:hover{border:none;box-shadow:inset 0 0 0 1px var(--blue-6);color:var(--blue-6)}.ScaleModal .footer .modal-button.cancel,.ScaleModal .footer .modal-button.secondary-btn-custom{border:none;box-shadow:inset 0 0 0 1px var(--primary-button);color:var(--primary-button)}.ScaleModal .footer .modal-button.cancel.disabled,.ScaleModal .footer .modal-button.secondary-btn-custom.disabled{cursor:default;border:none;box-shadow:inset 0 0 0 1px rgba(43,115,171,.5);color:rgba(43,115,171,.5)}.ScaleModal .footer .modal-button.cancel.disabled span,.ScaleModal .footer .modal-button.secondary-btn-custom.disabled span{color:rgba(43,115,171,.5)}.ScaleModal{position:fixed;inset-inline-start:0;inset-block-end:0;z-index:100;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:var(--modal-negative-space)}.ScaleModal .modal-container .wrapper .modal-content{padding:10px}.ScaleModal .footer{display:flex;flex-direction:row;justify-content:flex-end;width:100%;margin-top:13px}.ScaleModal .footer.modal-footer{padding:16px;margin:0;border-top:1px solid var(--divider)}.ScaleModal .footer .modal-button{display:flex;justify-content:center;align-items:center;padding:6px 18px;margin:8px 0 0;width:auto;width:-moz-fit-content;width:fit-content;border-radius:4px;height:30px;cursor:pointer}.ScaleModal .footer .modal-button.confirm{margin-inline-start:4px}.ScaleModal .footer .modal-button.secondary-btn-custom{border-radius:4px;padding:2px 20px 4px;cursor:pointer}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .footer .modal-button{padding:23px 8px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .footer .modal-button{padding:23px 8px}}.ScaleModal .swipe-indicator{background:var(--swipe-indicator-bg);border-radius:2px;height:4px;width:38px;position:absolute;inset-block-start:12px;margin-inline-start:auto;margin-inline-end:auto;inset-inline-start:0;inset-inline-end:0}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .swipe-indicator{display:none}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .swipe-indicator{display:none}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .swipe-indicator{width:32px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .swipe-indicator{width:32px}}.ScaleModal .modal-container{width:480px;overflow-y:visible}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container{width:100%;position:fixed;border-radius:0;inset-inline-start:0;inset-block-end:0}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container{width:100%;position:fixed;border-radius:0;inset-inline-start:0;inset-block-end:0}}.ScaleModal .modal-container .content-container{padding:24px 16px 16px}.ScaleModal .modal-container .content-container .ui__choice__label{font-weight:700;font-size:13px;line-height:16px;display:flex;align-items:center}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-option{padding:4px 0}.ScaleModal .modal-container .content-container .scaleSetting .custom-option-wrapper{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}.ScaleModal .modal-container .content-container .scaleSetting .custom-option-wrapper .calibrate-btn{font-weight:400;line-height:16px;display:flex;align-items:center;text-align:center;color:var(--blue-5);background-color:transparent;border:none;cursor:pointer}.ScaleModal .modal-container .content-container .scaleSetting .custom-option-wrapper .calibrate-btn:hover{color:var(--blue-6)}.ScaleModal .modal-container .content-container .scaleSetting .selector{margin-top:16px;width:100%;height:32px;margin-bottom:18px}.ScaleModal .modal-container .content-container .scaleSetting .selector .Dropdown__wrapper{width:100%;height:100%}.ScaleModal .modal-container .content-container .scaleSetting .selector .Dropdown__wrapper .Dropdown{height:100%;width:100%!important;text-align:start}.ScaleModal .modal-container .content-container .scaleSetting .selector .Dropdown__wrapper .Dropdown .arrow{flex:0 1 auto}.ScaleModal .modal-container .content-container .scaleSetting .selector .Dropdown__wrapper .Dropdown__items{width:100%}.ScaleModal .modal-container .content-container .scaleSetting .block{height:18px}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container{margin-top:8px;margin-bottom:8px}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display{display:flex;flex-direction:row;align-items:center;justify-content:space-between;grid-gap:8px;gap:8px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .left-container,.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .left-container .input-wrapper>div,.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .right-container,.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .right-container .input-wrapper>div{flex:1}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .left-container,.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .left-container .input-wrapper>div,.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .right-container,.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .right-container .input-wrapper>div{flex:1}}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .unit-label{padding-bottom:8px}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .scale-ratio-display .scale-ratio-equal{padding-top:24px;font-size:20px;width:28px;text-align:center}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper{display:flex;flex-direction:row}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .scale-input{border-radius:var(--border-radius);border:1px solid var(--border);width:94px;height:32px;margin-inline-end:8px;padding-inline-start:8px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .scale-input{width:79px;height:32px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .scale-input{width:79px;height:32px}}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .scale-input.invalid-value{border-color:var(--red)}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .scale-input:not(.invalid-value):focus{border:1px solid var(--blue-5)}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .unit-input{width:100px;height:32px}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .unit-input .Dropdown__wrapper{width:100%;height:100%}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .unit-input .Dropdown__wrapper .Dropdown{height:100%;text-align:start}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .unit-input .Dropdown__wrapper .Dropdown__items{width:100%}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .unit-input{width:4rem;height:2rem}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper .unit-input{width:4rem;height:2rem}}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper input::-webkit-inner-spin-button,.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .input-wrapper input[type=number]{-moz-appearance:textfield}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .warning-alert{position:relative;margin-inline-end:8px}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .warning-alert input{margin-inline-end:0!important}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .warning-alert .Icon{text-align:center;position:absolute;inset-block-start:50%;inset-inline-end:5px;margin:auto;transform:translateY(-50%);color:var(--red);display:block}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .warning-alert-icon{display:none}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .warning-messages{height:16px;font-weight:400;color:var(--red);margin-top:4px;position:relative;display:flex}.ScaleModal .modal-container .content-container .scaleSetting .custom-scale-container .warning-messages .world-value-warning{position:absolute;inset-inline-start:246px}.ScaleModal .modal-container .content-container .precision-container{display:flex;font-size:13px;font-weight:400;margin-top:16px;align-items:center;justify-content:space-between;border-top:1px solid var(--modal-stroke-and-border);padding-top:16px;grid-gap:16px;gap:16px}.ScaleModal .modal-container .content-container .precision-container .precision-selector{display:flex;justify-content:space-between;align-items:center;width:288px;height:32px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .precision-container .precision-selector{flex:2}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .precision-container .precision-selector{flex:2}}.ScaleModal .modal-container .content-container .precision-container .precision-selector .precision-title{height:1rem;font-weight:400;font-size:13px;line-height:16px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .precision-container .precision-selector .precision-title{margin-inline-end:8px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .precision-container .precision-selector .precision-title{margin-inline-end:8px}}.ScaleModal .modal-container .content-container .precision-container .precision-selector .selector{width:223px;height:32px;z-index:0}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .precision-container .precision-selector .selector{width:100%}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .precision-container .precision-selector .selector{width:100%}}.ScaleModal .modal-container .content-container .precision-container .precision-selector .selector .Dropdown__wrapper{width:100%;height:100%}.ScaleModal .modal-container .content-container .precision-container .precision-selector .selector .Dropdown__wrapper .Dropdown{height:100%;width:100%!important;text-align:start}.ScaleModal .modal-container .content-container .precision-container .precision-selector .selector .Dropdown__wrapper .Dropdown .arrow{flex:0 1 auto}.ScaleModal .modal-container .content-container .precision-container .precision-selector .selector .Dropdown__wrapper .Dropdown__items{width:100%}.ScaleModal .modal-container .content-container .precision-container .ui__choice__label{font-weight:400}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .content-container .precision-container .fractional-units-container{flex:1}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .content-container .precision-container .fractional-units-container{flex:1}}.ScaleModal .modal-container .footer{display:flex;padding:16px;align-items:center;justify-content:flex-end;width:100%;box-shadow:inset 0 1px 0 var(--modal-stroke-and-border);margin:0}.ScaleModal .modal-container .footer .scale-update{height:32px;min-width:72px;display:flex;align-items:center;justify-content:center;color:var(--blue-5);background-color:transparent;border:1px solid var(--blue-5);box-sizing:border-box;border-radius:var(--border-radius);cursor:pointer;margin-inline-end:8px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .footer .scale-update{font-size:13px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .footer .scale-update{font-size:13px}}.ScaleModal .modal-container .footer .scale-update:enabled:hover{border:1px solid var(--blue-6);color:var(--blue-6)}.ScaleModal .modal-container .footer .scale-update:disabled{opacity:.5;cursor:not-allowed}.ScaleModal .modal-container .footer .scale-create{border:none;background-color:transparent;background:var(--primary-button);border-radius:var(--border-radius);padding:0 8px;height:32px;min-width:72px;display:flex;align-items:center;justify-content:center;position:relative;color:var(--primary-button-text);cursor:pointer}:host(:not([data-tabbing=true])) .ScaleModal .modal-container .footer .scale-create,html:not([data-tabbing=true]) .ScaleModal .modal-container .footer .scale-create{outline:none}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ScaleModal .modal-container .footer .scale-create{font-size:13px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ScaleModal .modal-container .footer .scale-create{font-size:13px}}.ScaleModal .modal-container .footer .scale-create:enabled:hover{background:var(--primary-button-hover)}.ScaleModal .modal-container .footer .scale-create:disabled{opacity:.5;cursor:not-allowed}.ScaleModal .ui__choice__input__check.ui__choice__input__check--checked{border:3px solid var(--gray-0);outline:solid 1px var(--blue-5);background-color:var(--blue-5)}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./src/components/ScaleModal/ScaleModal.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_ScaleModal_ScaleModal});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),Choice=__webpack_require__("./node_modules/@pdftron/webviewer-react-toolkit/dist/esm/components/Choice/Choice.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),measurementScale=__webpack_require__("./src/constants/measurementScale.js"),core=__webpack_require__("./src/core/index.js"),actions=__webpack_require__("./src/redux/actions/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),Tooltip=__webpack_require__("./src/components/Tooltip/index.js"),Dropdown=__webpack_require__("./src/components/Dropdown/index.js"),Icon=__webpack_require__("./src/components/Icon/index.js");const Scale=window.Core.Scale,ScaleCustomProps={scale:prop_types_default().array,onScaleChange:prop_types_default().func,precision:prop_types_default().number};function ScaleCustom({scale,onScaleChange,precision}){const[measurementUnits]=(0,es.d4)((state=>[selectors.A.getMeasurementUnits(state)]),es.bN),[pageValueDisplay,setPageValueDisplay]=(0,react.useState)(""),[worldValueDisplay,setWorldValueDisplay]=(0,react.useState)(""),[isFractionalPrecision,setIsFractionalPrecision]=(0,react.useState)(!1),[pageWarningMessage,setPageWarningMessage]=(0,react.useState)(""),[worldWarningMessage,setWorldWarningMessage]=(0,react.useState)(""),[scaleValueBlurFlag,setScaleValueBlurFlag]=(0,react.useState)(!1),[leftDropdownWidth,setLeftDropdownWidth]=(0,react.useState)(0),pageValueInput=(0,react.useRef)(null),worldValueInput=(0,react.useRef)(null),leftContainerRef=(0,react.useRef)(null),[t]=(0,useTranslation.B)(),filterFractionalUnits=units=>units.filter((unit=>measurementScale.Ph.includes(unit))),unitFromOptions=isFractionalPrecision?filterFractionalUnits(measurementUnits.from):measurementUnits.from,unitToOptions=isFractionalPrecision?filterFractionalUnits(measurementUnits.to):measurementUnits.to;(0,react.useEffect)((()=>{unitFromOptions.includes(scale[0][1])||onScaleUnitChange(unitFromOptions[0],!0)}),[scale[0][1]]),(0,react.useEffect)((()=>{unitFromOptions.includes(scale[0][1])&&!unitToOptions.includes(scale[1][1])&&onScaleUnitChange(unitToOptions[0],!1)}),[scale[0][1],scale[1][1]]),(0,react.useEffect)((()=>{const formatDecimal=value=>value?.toFixed((1/precision).toString().length-1);scale[0][0]&&pageValueInput?.current!==document.activeElement&&setPageValueDisplay(isFractionalPrecision?Scale.getFormattedValue(scale[0][0],scale[0][1],precision,!1,!0)||"":formatDecimal(scale[0][0])||""),!scale[1][0]||worldValueInput&&worldValueInput.current===document.activeElement||(isFractionalPrecision||"ft-in"===scale[1][1]?setWorldValueDisplay(Scale.getFormattedValue(scale[1][0],scale[1][1],precision,!1,!0)||""):setWorldValueDisplay(formatDecimal(scale[1][0])||""))}),[scale,precision,worldValueInput,pageValueInput,isFractionalPrecision,scaleValueBlurFlag]),(0,react.useEffect)((()=>{setIsFractionalPrecision((0,measurementScale.fM)(precision))}),[precision]),(0,react.useEffect)((()=>{isFractionalPrecision?(setPageWarningMessage(measurementScale.OR[scale[0][1]]),setWorldWarningMessage(measurementScale.OR[scale[1][1]])):"ft-in"===scale[1][1]?(setPageWarningMessage(""),setWorldWarningMessage(measurementScale.OR["ft-in decimal"])):(setPageWarningMessage(""),setWorldWarningMessage(""))}),[scale,isFractionalPrecision]),(0,react.useEffect)((()=>{!isWorldValueValid&&onInputValueChange(worldValueInput.current.value,!1)}),[scale[1][1]]),(0,react.useEffect)((()=>{if(isPageValueValid||isWorldValueValid)!isPageValueValid&&onInputValueChange(pageValueInput.current.value,!0),!isWorldValueValid&&onInputValueChange(worldValueInput.current.value,!1);else{let pageScale={value:scale[0][0],unit:scale[0][1]};onInputValueChange(pageValueInput.current.value,!0,(newScale=>{pageScale=newScale.pageScale}));let worldScale={value:scale[1][0],unit:scale[1][1]};onInputValueChange(worldValueInput.current.value,!1,(newScale=>{worldScale=newScale.worldScale})),_onScaleChange(new Scale({pageScale,worldScale}))}}),[isFractionalPrecision]),(0,react.useEffect)((()=>{leftContainerRef.current&&setLeftDropdownWidth((leftContainerRef.current.clientWidth-8)/2)}),[leftContainerRef]);const isPageValueValid=!!scale[0][0],isWorldValueValid=!!scale[1][0],pageValueClass=classnames_default()("scale-input",{"invalid-value":!isPageValueValid}),worldValueClass=classnames_default()("scale-input",{"invalid-value":!isWorldValueValid}),_onScaleChange=newScale=>{const getPrecision=unit=>"ft-in"===unit?precision/12:precision;newScale.pageScale.value&&newScale.pageScale.value<precision&&(newScale.pageScale.value=getPrecision(newScale.pageScale.unit)),newScale.worldScale.value&&newScale.worldScale.value<precision&&(newScale.worldScale.value=getPrecision(newScale.worldScale.unit)),onScaleChange(newScale)},onInputValueChange=(value,isPageValue,getNewScale)=>{const updateScaleValue=scaleValue=>{if(isPageValue&&scaleValue!==scale[0][0]||!isPageValue&&scaleValue!==scale[1][0]){const newScale=new Scale({pageScale:{value:isPageValue?scaleValue:scale[0][0],unit:scale[0][1]},worldScale:{value:isPageValue?scale[1][0]:scaleValue,unit:scale[1][1]}});getNewScale?getNewScale(newScale):_onScaleChange(newScale)}};isPageValue?setPageValueDisplay(value):setWorldValueDisplay(value);const inputValue=value.trim();if(isFractionalPrecision){const scaleUnit=isPageValue?scale[0][1]:scale[1][1];if("in"===scaleUnit){if(measurementScale.yQ.test(inputValue)){const result=(0,measurementScale.cX)(inputValue);if(result>0)return void updateScaleValue(result)}}else if("ft-in"===scaleUnit&&measurementScale.CR.test(inputValue)){const result=(0,measurementScale.QQ)(inputValue);if(result>0)return void updateScaleValue(result)}}else if(isPageValue||"ft-in"!==scale[1][1]){if(measurementScale.SY.test(inputValue)){return void updateScaleValue(parseFloat(inputValue)||0)}}else if(measurementScale.oi.test(inputValue)){const result=(0,measurementScale.Cg)(inputValue);if(result>0)return void updateScaleValue(result)}updateScaleValue(void 0)},onScaleUnitChange=(newUnit,isPageUnit)=>{let newPageScale,newWorldScale;newPageScale=isPageUnit&&newUnit!==scale[0][1]?{value:scale[0][0]?(0,measurementScale.oU)(scale[0][0],scale[0][1],newUnit):scale[0][0],unit:newUnit}:{value:scale[0][0],unit:scale[0][1]},newWorldScale=isPageUnit||newUnit===scale[1][1]?{value:scale[1][0],unit:scale[1][1]}:{value:scale[1][0]?(0,measurementScale.oU)(scale[1][0],scale[1][1],newUnit):scale[1][0],unit:newUnit},_onScaleChange(new Scale({pageScale:newPageScale,worldScale:newWorldScale}))},getInputPlaceholder=isPageValue=>{const unit=isPageValue?scale[0][1]:scale[1][1];return isFractionalPrecision?measurementScale.OR[unit]:"ft-in"===unit?measurementScale.OR["ft-in decimal"]:""},onInputBlur=()=>{setScaleValueBlurFlag((flag=>!flag))};return(0,jsx_runtime.jsxs)("div",{className:"custom-scale-container",children:[(0,jsx_runtime.jsx)("div",{className:"scale-ratio-input-container",children:(0,jsx_runtime.jsxs)("div",{className:"scale-ratio-display",children:[(0,jsx_runtime.jsxs)("div",{className:"left-container",ref:leftContainerRef,children:[(0,jsx_runtime.jsx)("div",{className:"unit-label",id:"paper-units-dropdown-label",children:t("option.measurement.scaleModal.paperUnits")}),(0,jsx_runtime.jsxs)("div",{className:"input-wrapper",children:[(0,jsx_runtime.jsxs)("div",{className:classnames_default()({"warning-alert":!isPageValueValid}),children:[(0,jsx_runtime.jsx)("input",{type:isFractionalPrecision?"text":"number",min:"0",className:pageValueClass,value:pageValueDisplay,"aria-label":t("insertPageModal.pageDimensions.units"),"data-element":"customPageScaleValue",onChange:e=>onInputValueChange(e.target.value,!0),placeholder:getInputPlaceholder(!0),ref:pageValueInput,onBlur:onInputBlur}),(0,jsx_runtime.jsx)(Icon.A,{glyph:"icon-alert",className:"warning-alert-icon"})]}),(0,jsx_runtime.jsx)(Tooltip.A,{content:"option.measurement.scaleModal.paperUnits",children:(0,jsx_runtime.jsx)("div",{className:"unit-input",children:(0,jsx_runtime.jsx)(Dropdown.A,{id:"paper-units-dropdown",labelledById:"paper-units-dropdown-label",dataElement:"customPageScaleUnit",items:unitFromOptions,onClickItem:value=>onScaleUnitChange(value,!0),currentSelectionKey:scale[0][1],width:leftDropdownWidth})})})]})]}),(0,jsx_runtime.jsx)("div",{className:"scale-ratio-equal",children:" = "}),(0,jsx_runtime.jsxs)("div",{className:"right-container",children:[(0,jsx_runtime.jsx)("div",{className:"unit-label",id:"display-units-dropdown-label",children:t("option.measurement.scaleModal.displayUnits")}),(0,jsx_runtime.jsxs)("div",{className:"input-wrapper",children:[(0,jsx_runtime.jsxs)("div",{className:classnames_default()({"warning-alert":!isWorldValueValid}),children:[(0,jsx_runtime.jsx)("input",{type:isFractionalPrecision||"ft-in"===scale[1][1]?"text":"number",min:"0",className:worldValueClass,value:worldValueDisplay,"aria-label":t("insertPageModal.pageDimensions.units"),"data-element":"customDisplayScaleValue",onChange:e=>onInputValueChange(e.target.value,!1),placeholder:getInputPlaceholder(!1),ref:worldValueInput,onBlur:onInputBlur}),(0,jsx_runtime.jsx)(Icon.A,{glyph:"icon-alert",className:"warning-alert-icon"})]}),(0,jsx_runtime.jsx)(Tooltip.A,{content:"option.measurement.scaleModal.displayUnits",children:(0,jsx_runtime.jsx)("div",{className:"unit-input",children:(0,jsx_runtime.jsx)(Dropdown.A,{id:"display-units-dropdown",labelledById:"display-units-dropdown-label",items:unitToOptions,dataElement:"customDisplayScaleUnit",onClickItem:value=>onScaleUnitChange(value,!1),currentSelectionKey:scale[1][1],width:leftDropdownWidth})})})]})]})]})}),(0,jsx_runtime.jsxs)("div",{className:"warning-messages","aria-live":"assertive",children:[!isPageValueValid&&(0,jsx_runtime.jsx)("p",{className:"no-margin",children:`${t("option.measurement.scaleModal.incorrectSyntax")} ${pageWarningMessage}`}),!isWorldValueValid&&(0,jsx_runtime.jsx)("p",{className:"world-value-warning no-margin",children:`${t("option.measurement.scaleModal.incorrectSyntax")} ${worldWarningMessage}`})]})]})}ScaleCustom.propTypes=ScaleCustomProps;const ScaleModal_ScaleCustom=ScaleCustom;ScaleCustom.__docgenInfo={description:"",methods:[],displayName:"ScaleCustom",props:{scale:{description:"",type:{name:"array"},required:!1},onScaleChange:{description:"",type:{name:"func"},required:!1},precision:{description:"",type:{name:"number"},required:!1}}};var dataElement=__webpack_require__("./src/constants/dataElement.js"),useDidUpdate=__webpack_require__("./src/hooks/useDidUpdate.js"),DataElementWrapper=__webpack_require__("./src/components/DataElementWrapper/index.js"),ModalWrapper=__webpack_require__("./src/components/ModalWrapper/index.js");__webpack_require__("./src/components/ScaleModal/ScaleModal.scss"),__webpack_require__("./src/components/Choice/Choice.scss");const ScaleModal_Scale=window.Core.Scale,scaleOptions_CUSTOM="custom",scaleOptions_PRESET="preset",ScaleModal_ScaleModal=({annotations,selectedTool})=>{const dispatch=(0,es.wA)(),[t]=(0,useTranslation.B)(),[isDisabled,isOpen,isHidden,currentToolbarGroup,selectedScale,activeToolName,isAddingNewScale,measurementScalePreset,{tempScale,isFractionalUnit},isMultipleScalesMode]=(0,es.d4)((state=>[selectors.A.isElementDisabled(state,dataElement.A.SCALE_MODAL),selectors.A.isElementOpen(state,dataElement.A.SCALE_MODAL),selectors.A.isElementHidden(state,dataElement.A.SCALE_MODAL),selectors.A.getCurrentToolbarGroup(state),selectors.A.getSelectedScale(state),selectors.A.getActiveToolName(state),selectors.A.getIsAddingNewScale(state),selectors.A.getMeasurementScalePreset(state),selectors.A.getCalibrationInfo(state),selectors.A.getIsMultipleScalesMode(state)])),[isFractionalPrecision,setIsFractionalPrecision]=(0,react.useState)(!1),[precisionOption,setPrecisionOption]=(0,react.useState)(measurementScale.dz[measurementScale.D4.DECIMAL][0]),[scaleOption,setScaleOption]=(0,react.useState)(scaleOptions_CUSTOM),[presetScale,setPresetScale]=(0,react.useState)(measurementScalePreset[measurementScale.gJ.METRIC][0]),[customScale,setCustomScale]=(0,react.useState)(new ScaleModal_Scale("")),[hasScaleChanged,setHasScaleChanged]=(0,react.useState)(!1),totalScalesCount=Object.keys(core.A.getScales()).length;(0,react.useEffect)((()=>{measurementScale.dz[precisionType].includes(precisionOption)||setPrecisionOption(measurementScale.dz[precisionType][0]),setPresetScale(measurementScalePreset[presetMeasurementSystem][0])}),[isFractionalPrecision]),(0,react.useEffect)((()=>{setScaleOption(scaleOptions_CUSTOM),setCustomScale(new ScaleModal_Scale(selectedScale.getScaleRatioAsArray()));const precision=core.A.getScalePrecision(selectedScale);if(!precision)return;const isFractional=(0,measurementScale.fM)(precision);setIsFractionalPrecision(isFractional);const precisionItem=measurementScale.dz[getPrecisionType(isFractional)].find((item=>item[1]===precision));setPrecisionOption(precisionItem),setTimeout((()=>{setHasScaleChanged(!1)}))}),[selectedScale]),(0,useDidUpdate.A)((()=>{if(scaleOption===scaleOptions_CUSTOM)setCustomScale(presetScale[1]);else{const presetPrecisionOption=measurementScale.Oh[presetScale[0]];presetPrecisionOption&&presetPrecisionOption!==precisionOption&&setPrecisionOption(presetPrecisionOption)}}),[scaleOption]),(0,useDidUpdate.A)((()=>{"toolbarGroup-Measure"===currentToolbarGroup&&closeModal()}),[currentToolbarGroup]),(0,react.useEffect)((()=>{const newPrecisionOption=measurementScale.Oh[presetScale[0]];newPrecisionOption&&scaleOption===scaleOptions_PRESET&&setPrecisionOption(newPrecisionOption)}),[presetScale]),(0,react.useEffect)((()=>{!isHidden&&tempScale&&(setCustomScale(new ScaleModal_Scale(tempScale)),dispatch(actions.A.updateCalibrationInfo({isCalibration:!1})),setIsFractionalPrecision(isFractionalUnit))}),[isHidden]),(0,react.useEffect)((()=>{setHasScaleChanged(!0)}),[precisionOption,customScale,presetScale,scaleOption]),(0,react.useEffect)((()=>{isOpen&&isAddingNewScale&&!tempScale&&(setScaleOption(scaleOptions_CUSTOM),setCustomScale(measurementScale.Br),setIsFractionalPrecision(!1),setPrecisionOption(measurementScale.dz[measurementScale.D4.DECIMAL][0]))}),[isOpen,isAddingNewScale]);const closeModal=()=>{dispatch(actions.A.closeElement(dataElement.A.SCALE_MODAL))},getCurrentScale=()=>{const getPrecisionsValue=(value,unit)=>{let temp=value,precisionValue=precisionOption[1];return isFractionalPrecision?("ft-in"===unit&&(precisionValue/=12),temp=Math.round(temp/precisionValue)*precisionValue):"ft-in"!==unit&&(temp=temp.toFixed((1/precisionValue).toString().length-1)),1*temp};if(isCustomOption){const scale=customScale.getScaleRatioAsArray();return scale[0][0]=getPrecisionsValue(scale[0][0],scale[0][1]),scale[1][0]=getPrecisionsValue(scale[1][0],scale[1][1]),scale}return presetScale[1].toString()},modalClass=classnames_default()("Modal","ScaleModal",{open:!isHidden,closed:isHidden}),isCustomOption=scaleOption===scaleOptions_CUSTOM,presetMeasurementSystem=isFractionalPrecision?measurementScale.gJ.IMPERIAL:measurementScale.gJ.METRIC,getPrecisionType=isFractional=>isFractional?measurementScale.D4.FRACTIONAL:measurementScale.D4.DECIMAL,precisionType=getPrecisionType(isFractionalPrecision),isCurrentScaleValid=!isCustomOption||customScale.isValid(),isFractionalUnitsToggleDisabled=isCustomOption&&!(measurementScale.Ph.includes(customScale.pageScale?.unit)&&measurementScale.Ph.includes(customScale.worldScale?.unit));return!isDisabled&&(0,jsx_runtime.jsx)("div",{className:modalClass,"data-element":dataElement.A.SCALE_MODAL,children:(0,jsx_runtime.jsxs)(ModalWrapper.A,{title:"option.measurementOption.scale",isOpen,onCloseClick:closeModal,closeHandler:closeModal,swipeToClose:!0,children:[(0,jsx_runtime.jsxs)("div",{className:"content-container",children:[(0,jsx_runtime.jsxs)("div",{className:"scaleSetting",children:[(0,jsx_runtime.jsxs)("div",{className:"custom-option-wrapper",children:[(0,jsx_runtime.jsx)("div",{className:"custom-scale-option",children:(0,jsx_runtime.jsx)(Choice.G,{"data-element":"customScaleOption",radio:!0,name:"setting",onChange:()=>setScaleOption(scaleOptions_CUSTOM),checked:isCustomOption,label:`${t("option.measurement.scaleModal.custom")}:`,center:!0})}),isCustomOption&&(0,jsx_runtime.jsx)("button",{"data-element":"calibrate",className:"calibrate-btn",onClick:()=>{core.A.setToolMode("AnnotationCreateCalibrationMeasurement");const unit=isCustomOption?customScale.worldScale?.unit||"":presetScale[1].worldScale.unit;dispatch(actions.A.updateCalibrationInfo({isCalibration:!0,previousToolName:activeToolName,defaultUnit:unit})),dispatch(actions.A.setIsElementHidden(dataElement.A.SCALE_MODAL,!0))},children:t("option.measurement.scaleModal.calibrate")})]}),isCustomOption?(0,jsx_runtime.jsx)(ScaleModal_ScaleCustom,{scale:customScale.getScaleRatioAsArray(),onScaleChange:setCustomScale,precision:precisionOption[1]}):null,(0,jsx_runtime.jsx)("div",{className:"custom-scale-option",children:(0,jsx_runtime.jsx)(Choice.G,{"data-element":"presetScaleOption",radio:!0,onChange:()=>setScaleOption(scaleOptions_PRESET),name:"setting",checked:!isCustomOption,label:`${t("option.measurement.scaleModal.preset")}:`,center:!0})}),!isCustomOption&&(0,jsx_runtime.jsx)("div",{className:"scaleModal__preset-container",children:(0,jsx_runtime.jsx)("div",{className:"selector",children:(0,jsx_runtime.jsx)(Dropdown.A,{id:"preset-scale-dropdown",dataElement:"presetScales",items:measurementScalePreset[presetMeasurementSystem].map((item=>item[0])),currentSelectionKey:presetScale[0],onClickItem:(_item,i)=>setPresetScale(measurementScalePreset[presetMeasurementSystem][i])})})}),isCustomOption?null:(0,jsx_runtime.jsx)("div",{className:"block"})]}),(0,jsx_runtime.jsxs)("div",{className:"precision-container",children:[(0,jsx_runtime.jsxs)("div",{className:"precision-selector",children:[(0,jsx_runtime.jsxs)("div",{className:"precision-title",id:"scale-precision-dropdown-label",children:[t("option.shared.precision"),":"]}),(0,jsx_runtime.jsx)("div",{className:"selector",children:(0,jsx_runtime.jsx)(Dropdown.A,{id:"scale-precision-dropdown",labelledById:"scale-precision-dropdown-label",dataElement:"scalePrecisions",items:measurementScale.dz[precisionType].map((item=>item[0])),currentSelectionKey:precisionOption[0],onClickItem:(_item,i)=>setPrecisionOption(measurementScale.dz[precisionType][i]),ariaLabel:t("option.shared.precision")})})]}),(0,jsx_runtime.jsx)(Tooltip.A,{content:t("option.measurement.scaleModal.fractionUnitsTooltip"),children:(0,jsx_runtime.jsx)("div",{className:"fractional-units-container",children:(0,jsx_runtime.jsx)(Choice.G,{isSwitch:!0,leftLabel:!0,id:"scale-modal-fractional-units",label:t("option.measurement.scaleModal.fractionalUnits"),checked:isFractionalPrecision,onChange:()=>{setIsFractionalPrecision((isFractionalPrecision=>!isFractionalPrecision))},disabled:isFractionalUnitsToggleDisabled})})})]})]}),(0,jsx_runtime.jsxs)("div",{className:"footer",children:[(0,jsx_runtime.jsx)(DataElementWrapper.A,{type:"button",onClick:()=>{var originalScales,scale;originalScales=[selectedScale],scale=new ScaleModal_Scale(getCurrentScale(),precisionOption[1]),core.A.replaceScales(originalScales,scale),closeModal()},className:"scale-update",dataElement:"updateScale",disabled:isAddingNewScale||!isCurrentScaleValid||!hasScaleChanged,children:t("action.update")}),(0,jsx_runtime.jsx)("button",{onClick:()=>{var scale,applyTo;scale=new ScaleModal_Scale(getCurrentScale(),precisionOption[1]),applyTo=[...annotations,selectedTool],core.A.createAndApplyScale(scale,applyTo),closeModal()},className:"scale-create","data-element":"createScale",disabled:!isCurrentScaleValid||!isMultipleScalesMode&&totalScalesCount||!isAddingNewScale&&!hasScaleChanged,children:t("action.create")})]})]})})},components_ScaleModal_ScaleModal=ScaleModal_ScaleModal;ScaleModal_ScaleModal.__docgenInfo={description:"",methods:[],displayName:"ScaleModal"}},"./src/components/ScaleModal/ScaleModal.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ScaleModal/ScaleModal.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}}}]);