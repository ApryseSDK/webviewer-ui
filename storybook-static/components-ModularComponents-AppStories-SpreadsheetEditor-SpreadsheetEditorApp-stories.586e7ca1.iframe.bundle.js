"use strict";(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[88052],{"./src/components/ModularComponents/AppStories/SpreadsheetEditor/SpreadsheetEditorApp.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EditingModeHeaderKeyboardNavigationTest:()=>EditingModeHeaderKeyboardNavigationTest,EditingModeUI:()=>EditingModeUI,ViewOnlyUI:()=>ViewOnlyUI,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var components_App__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/App/index.js"),helpers_storybookHelper__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/helpers/storybookHelper.js"),src_constants_customizationVariables__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/constants/customizationVariables.js"),src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/redux/spreadsheetEditorComponents.js"),storybook_test__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("storybook/test"),src_redux_initialState__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/redux/initialState.js");const __WEBPACK_DEFAULT_EXPORT__={title:"SpreadsheetEditor/App",component:components_App__WEBPACK_IMPORTED_MODULE_0__.A},editingModeTemplate={uiConfiguration:src_constants_customizationVariables__WEBPACK_IMPORTED_MODULE_2__.jq.SPREADSHEET_EDITOR,headers:src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_3__.d6,components:src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_3__.hy,flyoutMap:src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_3__.ZD,viewerRedux:{flyoutMap:{},openElements:{spreadsheetSwitcher:!0},disabledElements:{newSpreadsheetButton:{disabled:!1},logoBar:{disabled:!0}},isSpreadsheetEditorModeEnabled:!0},spreadsheetEditorRedux:{editMode:"editing",cellProperties:{cellType:null,cellFormula:null,stringCellValue:null,topLeftRow:null,topLeftColumn:null,bottomRightRow:null,bottomRightColumn:null,canCopy:!0,canPaste:!0,canCut:!0,styles:{verticalAlignment:null,horizontalAlignment:null,font:{fontFace:"Arial",pointSize:8,bold:!1,italic:!1,underline:!1,strikeout:!1},formatType:null}}}},EditingModeUI=(0,helpers_storybookHelper__WEBPACK_IMPORTED_MODULE_1__.Xu)(editingModeTemplate),EditingModeHeaderKeyboardNavigationTest=(0,helpers_storybookHelper__WEBPACK_IMPORTED_MODULE_1__.Xu)(editingModeTemplate);EditingModeUI.play=async({canvasElement})=>{const canvas=(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.within)(canvasElement),contentContainer=canvasElement.querySelector(".content"),documentContainer=canvas.getByRole("tabpanel");(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(documentContainer).toBeInTheDocument();const containerRect=documentContainer.getBoundingClientRect(),contentRect=contentContainer.getBoundingClientRect(),{bottomHeaders}=src_redux_initialState__WEBPACK_IMPORTED_MODULE_5__.A.viewer.modularHeadersHeight;(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(containerRect.height+bottomHeaders).toEqual(contentRect.height)},EditingModeHeaderKeyboardNavigationTest.play=async({canvasElement})=>{const canvas=(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.within)(canvasElement);await storybook_test__WEBPACK_IMPORTED_MODULE_4__.userEvent.tab();const menuButton=canvas.getByRole("button",{name:"Menu"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(menuButton).toHaveFocus();const topHeaderItems=[{role:"textbox",name:"Set zoom"},{role:"button",name:"Zoom Options"},{role:"button",name:"Zoom out"},{role:"button",name:"Zoom in"},{role:"button",name:/^Edit File Name/}];for(const item of topHeaderItems){await storybook_test__WEBPACK_IMPORTED_MODULE_4__.userEvent.keyboard("{ArrowRight}");const headerItem=canvas.getByRole(item.role,{name:item.name});(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(headerItem).toHaveFocus()}const toolbarItems=[{role:"button",name:"Cut"},{role:"button",name:"Copy"},{role:"button",name:"Paste"},{role:"combobox",name:"Font Family"},{role:"combobox",name:"Font Size"},{role:"button",name:"Bold"},{role:"button",name:"Italic"},{role:"button",name:"Underline"},{role:"button",name:"Strikeout"},{role:"button",name:"Text Color"},{role:"button",name:"Background Color"},{role:"button",name:"Text Alignment"},{role:"button",name:"Cell Adjustment"},{role:"button",name:"Border Style"},{role:"button",name:"Merge"},{role:"button",name:"Currency"},{role:"button",name:"Percent"},{role:"button",name:"Decrease decimal"},{role:"button",name:"Increase decimal"},{role:"button",name:"More cell format options"}];await storybook_test__WEBPACK_IMPORTED_MODULE_4__.userEvent.tab();let currentItem=canvas.getByRole(toolbarItems[0].role,{name:toolbarItems[0].name});(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(currentItem).toHaveFocus();for(let i=1;i<toolbarItems.length;i++)await storybook_test__WEBPACK_IMPORTED_MODULE_4__.userEvent.keyboard("{ArrowRight}"),currentItem=canvas.getByRole(toolbarItems[i].role,{name:toolbarItems[i].name}),(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(currentItem).toHaveFocus();await storybook_test__WEBPACK_IMPORTED_MODULE_4__.userEvent.keyboard("{Home}"),currentItem=canvas.getByRole(toolbarItems[0].role,{name:toolbarItems[0].name}),(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(currentItem).toHaveFocus(),await storybook_test__WEBPACK_IMPORTED_MODULE_4__.userEvent.keyboard("{End}"),currentItem=canvas.getByRole(toolbarItems[toolbarItems.length-1].role,{name:toolbarItems[toolbarItems.length-1].name}),(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(currentItem).toHaveFocus(),await storybook_test__WEBPACK_IMPORTED_MODULE_4__.userEvent.tab({shift:!0});const fileNameButton=canvas.getByRole("button",{name:/^Edit File Name/});(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(fileNameButton).toHaveFocus();const searchToggle=canvas.getByRole("button",{name:"Search"});await storybook_test__WEBPACK_IMPORTED_MODULE_4__.userEvent.click(searchToggle),(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(searchToggle).toHaveFocus();const searchPanel=canvasElement.querySelector('[data-element="searchPanel"]');(0,storybook_test__WEBPACK_IMPORTED_MODULE_4__.expect)(searchPanel).toBeInTheDocument()};const ViewOnlyUI=(0,helpers_storybookHelper__WEBPACK_IMPORTED_MODULE_1__.Xu)({headers:src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_3__.d6,components:src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_3__.hy,flyoutMap:src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_3__.ZD,viewerRedux:{uiConfiguration:src_constants_customizationVariables__WEBPACK_IMPORTED_MODULE_2__.jq.SPREADSHEET_EDITOR,disabledElements:{spreadsheetEditorToolsHeader:{disabled:!0},newSpreadsheetButton:{disabled:!0},logoBar:{disabled:!0}},openElements:{spreadsheetSwitcher:!0},isSpreadsheetEditorModeEnabled:!0},spreadsheetEditorRedux:{editMode:"viewOnly"}}),__namedExportsOrder=["EditingModeUI","EditingModeHeaderKeyboardNavigationTest","ViewOnlyUI"]}}]);