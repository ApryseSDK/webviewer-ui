(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[6241],{"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[14].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/CalibrationModal/CalibrationModal.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".open.CalibrationModal{visibility:visible}.closed.CalibrationModal{visibility:hidden}:host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.CalibrationModal{position:fixed;left:0;bottom:0;z-index:100;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:var(--modal-negative-space)}.CalibrationModal .modal-container .wrapper .modal-content{padding:10px}.CalibrationModal .footer{display:flex;flex-direction:row;justify-content:flex-end;width:100%;margin-top:13px}.CalibrationModal .footer.modal-footer{padding:16px;margin:0;border-top:1px solid var(--divider)}.CalibrationModal .footer .modal-button{display:flex;justify-content:center;align-items:center;padding:6px 18px;margin:8px 0 0;width:auto;width:-moz-fit-content;width:fit-content;border-radius:4px;height:30px;cursor:pointer}.CalibrationModal .footer .modal-button.cancel{color:var(--secondary-button-text);border:1px solid var(--secondary-button-text)}.CalibrationModal .footer .modal-button.cancel:hover{background-color:var(--document-background-color);color:var(--secondary-button-hover);border:1px solid var(--secondary-button-hover)}.CalibrationModal .footer .modal-button.confirm{margin-left:4px;color:var(--primary-button-text);font-weight:600;background:var(--primary-button)}.CalibrationModal .footer .modal-button.confirm:hover{background:var(--primary-button-hover)}.CalibrationModal .footer .modal-button.confirm.disabled{background:var(--primary-button)!important;opacity:.5}.CalibrationModal .footer .modal-button.secondary-btn-custom{border-radius:4px;border:1px solid var(--primary-button);color:var(--primary-button);padding:2px 20px 4px;cursor:pointer;background-color:#fff}.CalibrationModal .footer .modal-button.secondary-btn-custom:hover{color:var(--secondary-button-hover)}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .CalibrationModal .footer .modal-button{padding:23px 8px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .CalibrationModal .footer .modal-button{padding:23px 8px}}.CalibrationModal .swipe-indicator{background:var(--divider);border-radius:2px;height:4px;width:38px;position:absolute;top:12px;margin-left:auto;margin-right:auto;left:0;right:0}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .CalibrationModal .swipe-indicator{display:none}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .CalibrationModal .swipe-indicator{display:none}}.CalibrationModal .container{border-radius:4px;overflow-y:auto;max-height:100%}@media(max-height:500px){.App:not(.is-web-component) .CalibrationModal .container,.CalibrationModal .App:not(.is-web-component) .container{overflow:auto;max-height:100%}}@container (max-height: 500px){.App.is-web-component .CalibrationModal .container,.CalibrationModal .App.is-web-component .container{overflow:auto;max-height:100%}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .CalibrationModal .container,.CalibrationModal .App:not(.is-in-desktop-only-mode):not(.is-web-component) .container{width:100%;position:fixed;left:0;bottom:0;padding-top:4px;min-width:100px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .CalibrationModal .container,.CalibrationModal .App.is-web-component:not(.is-in-desktop-only-mode) .container{width:100%;position:fixed;left:0;bottom:0;padding-top:4px;min-width:100px}}.CalibrationModal .container{display:flex;flex-direction:column;min-width:400px;box-shadow:0 0 3px 0 var(--document-box-shadow);padding:8px;background:var(--component-background)}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .CalibrationModal .container{padding:24px 24px 16px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .CalibrationModal .container{padding:24px 24px 16px}}.CalibrationModal .container .calibration__header{font-size:16px;margin-top:8px;margin-bottom:8px}.CalibrationModal .container .calibration__body{padding-top:8px}.CalibrationModal .container .calibration__body .calibration__input{margin-top:8px;display:flex;flex-direction:row;justify-content:space-between}.CalibrationModal .container .calibration__body input{width:100%;height:30px;font-size:13px;border:1px solid var(--border);border-radius:4px;color:var(--text-color);padding:4px 42px 6px 8px;margin-right:8px}.CalibrationModal .container .calibration__body input:focus{outline:none;border:1px solid var(--focus-border)}.CalibrationModal .container .calibration__body input::-moz-placeholder{color:var(--placeholder-text)}.CalibrationModal .container .calibration__body input::placeholder{color:var(--placeholder-text)}.CalibrationModal .container .calibration__body .error{border:1px solid var(--error-border-color)}.CalibrationModal .container .calibration__body .unitToInput{height:29px;width:45px;border-radius:5px;border:1px solid var(--border);font-size:13px}.CalibrationModal .container .calibration__body .unitToInput:focus{outline:none;border:1px solid var(--focus-border)}.CalibrationModal .container .calibration__body .unitToInput::-moz-placeholder{color:var(--placeholder-text)}.CalibrationModal .container .calibration__body .unitToInput::placeholder{color:var(--placeholder-text)}.CalibrationModal .container .calibration__body .errorMeasurement{font-size:13px;margin-top:8px;margin-bottom:8px;color:var(--error-text-color);max-width:400px}.CalibrationModal .container .calibration__footer{display:flex;justify-content:flex-end;margin-top:8px}.CalibrationModal .container .calibration__footer .Button{display:flex;justify-content:center;align-items:center;color:var(--primary-button-text);font-weight:600;padding:6px 18px;margin-top:8px;margin-left:5px;width:auto;width:-moz-fit-content;width:fit-content;background:var(--primary-button);border-radius:4px;height:30px;cursor:pointer}.CalibrationModal .container .calibration__footer .Button:hover{background:var(--primary-button-hover)}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./src/components/CalibrationModal/CalibrationModal.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[14].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/CalibrationModal/CalibrationModal.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/CalibrationModal/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>components_CalibrationModal});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),es=__webpack_require__("./node_modules/react-redux/es/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),Button=__webpack_require__("./src/components/Button/index.js"),core=__webpack_require__("./src/core/index.js"),map=__webpack_require__("./src/constants/map.js"),setToolStyles=__webpack_require__("./src/helpers/setToolStyles.js");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _sliced_to_array(arr,i){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr,i)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function evalFraction(fraction){var _fraction_split=_sliced_to_array(fraction.split("/"),2),numerator=_fraction_split[0],denominator=_fraction_split[1];return Number(numerator)/Number(denominator)}var actions=__webpack_require__("./src/redux/actions/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js"),react_swipeable_es=__webpack_require__("./node_modules/react-swipeable/es/index.js"),dataElement=__webpack_require__("./src/constants/dataElement.js");__webpack_require__("./src/components/CalibrationModal/CalibrationModal.scss");function CalibrationModal_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CalibrationModal_sliced_to_array(arr,i){return function CalibrationModal_array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function CalibrationModal_iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function CalibrationModal_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return CalibrationModal_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CalibrationModal_array_like_to_array(o,minLen)}(arr,i)||function CalibrationModal_non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var parseMeasurementContentsByAnnotation=function(annotation){var factor=annotation.Measure.axis[0].factor;return"ft-in"===annotation.Scale[1][1]?annotation.getLineLength()*factor/12:annotation.getLineLength()*factor},numberRegex=/^\d*(\.\d*)?$/,fractionRegex=/^\d*(\s\d\/\d*)$/,pureFractionRegex=/^(\d\/\d*)*$/,CalibrationModal_CalibrationModal=function(){var _useSelector=CalibrationModal_sliced_to_array((0,es.d4)((function(state){return[selectors.A.isElementOpen(state,dataElement.A.CALIBRATION_MODAL),selectors.A.isElementDisabled(state,dataElement.A.CALIBRATION_MODAL),selectors.A.getMeasurementUnits(state)]}),es.bN),3),isOpen=_useSelector[0],isDisabled=_useSelector[1],units=_useSelector[2],dispatch=(0,es.wA)(),_useState=CalibrationModal_sliced_to_array((0,react.useState)(null),2),annotation=_useState[0],setAnnotation=_useState[1],_useState1=CalibrationModal_sliced_to_array((0,react.useState)(""),2),value=_useState1[0],setValue=_useState1[1],_useState2=CalibrationModal_sliced_to_array((0,react.useState)(0),2),newDistance=_useState2[0],setNewDistance=_useState2[1],_useState3=CalibrationModal_sliced_to_array((0,react.useState)(""),2),unitTo=_useState3[0],setUnitTo=_useState3[1],_useState4=CalibrationModal_sliced_to_array((0,react.useState)(!1),2),showError=_useState4[0],setShowError=_useState4[1],t=CalibrationModal_sliced_to_array((0,useTranslation.B)(),1)[0],inputRef=(0,react.useRef)(null);(0,react.useEffect)((function(){var _inputRef_current;isOpen&&(null==inputRef||null===(_inputRef_current=inputRef.current)||void 0===_inputRef_current||_inputRef_current.focus()),handleAnnotationsSelected(core.A.getSelectedAnnotations())}),[isOpen]),(0,react.useEffect)((function(){var onAnnotationSelected=function(annotations,action){"selected"===action?handleAnnotationsSelected(annotations):"deselected"===action&&(setAnnotation(null),setValue(""),setUnitTo(""),setNewDistance(0))};return core.A.addEventListener("annotationSelected",onAnnotationSelected),function(){return core.A.removeEventListener("annotationSelected",onAnnotationSelected)}}),[]),(0,react.useEffect)((function(){var onAnnotationChanged=function(annotations,action){"modify"===action&&1===annotations.length&&annotations[0]===annotation&&(setValue(parseMeasurementContentsByAnnotation(annotation).toFixed(2)),setUnitTo(annotation.Scale[1][1]))};return core.A.addEventListener("annotationChanged",onAnnotationChanged),function(){return core.A.removeEventListener("annotationChanged",onAnnotationChanged)}}),[annotation]);var handleAnnotationsSelected=function(annotations){if(1===(null==annotations?void 0:annotations.length)&&"distanceMeasurement"===(0,map.c7)(annotations[0])){var annot=annotations[0];setAnnotation(annot);var value=parseMeasurementContentsByAnnotation(annot).toFixed(2);setValue(value),setUnitTo(annot.Scale[1][1]),setNewDistance(parseFloat(value))}},handleLossOfPrecision=function(scale){return annotation.Scale=scale,getNewScale()},getNewScale=function(){var currentDistance=parseMeasurementContentsByAnnotation(annotation),ratio=newDistance/currentDistance,currentScale=annotation.Scale;return[[currentScale[0][0],currentScale[0][1]],[currentScale[1][0]*ratio,unitTo]]},closeModal=function(){dispatch(actions.A.closeElements([dataElement.A.CALIBRATION_MODAL]))};return isDisabled||!annotation?null:react.createElement(react_swipeable_es.Hx,{onSwipedUp:closeModal,onSwipedDown:closeModal,preventDefaultTouchmoveEvent:!0},react.createElement("div",{className:classnames_default()({Modal:!0,CalibrationModal:!0,open:isOpen,closed:!isOpen}),onMouseDown:closeModal}," ",react.createElement("div",{className:"container",onMouseDown:function(e){return e.stopPropagation()}},react.createElement("div",{className:"swipe-indicator"}),react.createElement("div",{className:"calibration__header"},t("component.calibration")),react.createElement("div",{className:"calibration__body"},react.createElement("div",null,t("message.enterMeasurement")),react.createElement("div",{className:"calibration__input"},react.createElement("input",{className:showError?"error":"",ref:inputRef,type:"text",value,onChange:function(e){setShowError(!1),setValue(e.target.value)},onBlur:function(e){var inputValue=e.target.value.trim();if(""===inputValue&&setShowError(!0),numberRegex.test(inputValue))0!==parseFloat(inputValue)?(setNewDistance(parseFloat(inputValue)),setValue(inputValue)):setShowError(!0);else if(fractionRegex.test(inputValue)){var _inputValue_split=CalibrationModal_sliced_to_array(inputValue.split(" "),2),whole=_inputValue_split[0],fraction=_inputValue_split[1];if(Number.isFinite(evalFraction(fraction))){var number=Number(whole)+evalFraction(fraction);setNewDistance(parseFloat(number)),setValue(number)}else setShowError(!0)}else if(pureFractionRegex.test(inputValue))if(Number.isFinite(evalFraction(inputValue))){var number1=evalFraction(inputValue);setNewDistance(parseFloat(number1)),setValue(number1)}else setShowError(!0);else setShowError(!0)}}),react.createElement("select",{className:"unitToInput",value:unitTo,onChange:function(e){setUnitTo(e.target.value)}},units.to.map((function(unit){return react.createElement("option",{key:unit,value:unit},unit)})))),showError?react.createElement("div",{className:"errorMeasurement"},t("message.errorEnterMeasurement")):null),react.createElement("div",{className:"calibration__footer"},react.createElement(Button.A,{dataElement:"passwordSubmitButton",label:t("action.apply"),onClick:function(){var newScale=getNewScale(),accurateNewScale=handleLossOfPrecision(newScale);core.A.setAnnotationStyles(annotation,{Scale:accurateNewScale}),(0,setToolStyles.A)("AnnotationCreateDistanceMeasurement","Scale",accurateNewScale),dispatch(actions.A.closeElements([dataElement.A.CALIBRATION_MODAL]))},disabled:showError})))))};const components_CalibrationModal_CalibrationModal=CalibrationModal_CalibrationModal;CalibrationModal_CalibrationModal.__docgenInfo={description:"",methods:[],displayName:"CalibrationModal"};const components_CalibrationModal=components_CalibrationModal_CalibrationModal;components_CalibrationModal_CalibrationModal.__docgenInfo={description:"",methods:[],displayName:"CalibrationModal"}}}]);