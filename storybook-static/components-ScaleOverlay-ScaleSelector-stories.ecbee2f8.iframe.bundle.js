"use strict";(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[37564],{"./src/components/Button/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./src/components/Button/Button.js").A},"./src/components/DataElementWrapper/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>components_DataElementWrapper});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js");const propTypes={id:prop_types_default().string,children:prop_types_default().node,dataElement:prop_types_default().string,type:prop_types_default().string,ariaLabel:prop_types_default().string};const DataElementWrapper=react.forwardRef((({type="div",children,dataElement,ariaLabel,...props},ref)=>function useIsDisabledWithDefaultValue(selector,defaultValue=!1){try{return(0,es.d4)(selector)}catch(e){e.message}return defaultValue}((state=>selectors.A.isElementDisabled(state,dataElement)))?null:"button"===type?(0,jsx_runtime.jsx)("button",{ref,"data-element":dataElement,"aria-label":ariaLabel,...props,children}):(0,jsx_runtime.jsx)("div",{ref,"data-element":dataElement,...props,children})));DataElementWrapper.displayName="DataElementWrapper",DataElementWrapper.propTypes=propTypes;const DataElementWrapper_DataElementWrapper=DataElementWrapper;DataElementWrapper.__docgenInfo={description:"",methods:[],displayName:"DataElementWrapper",props:{type:{defaultValue:{value:"'div'",computed:!1},description:"",type:{name:"string"},required:!1},id:{description:"",type:{name:"string"},required:!1},children:{description:"",type:{name:"node"},required:!1},dataElement:{description:"",type:{name:"string"},required:!1},ariaLabel:{description:"Accessibility",type:{name:"string"},required:!1}}};const components_DataElementWrapper=DataElementWrapper_DataElementWrapper},"./src/components/ScaleOverlay/ScaleSelector.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),components_Icon__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/Icon/index.js"),components_DataElementWrapper__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/DataElementWrapper/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_11__),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/index.js"),react_i18next__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),actions__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/redux/actions/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react-redux/es/index.js"),selectors__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/redux/selectors/index.js"),core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/core/index.js"),hooks_useOnClickOutside__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/hooks/useOnClickOutside.js"),components_Button__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/components/Button/index.js");const propTypes={scales:prop_types__WEBPACK_IMPORTED_MODULE_11___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_11___default().object).isRequired,selectedScales:prop_types__WEBPACK_IMPORTED_MODULE_11___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_11___default().string).isRequired,onScaleSelected:prop_types__WEBPACK_IMPORTED_MODULE_11___default().func.isRequired,onAddingNewScale:prop_types__WEBPACK_IMPORTED_MODULE_11___default().func.isRequired,ariaLabelledBy:prop_types__WEBPACK_IMPORTED_MODULE_11___default().string},Scale=window.Core.Scale,ScaleSelector=({scales=[],selectedScales=[],onScaleSelected,onAddingNewScale,ariaLabelledBy})=>{const[t]=(0,react_i18next__WEBPACK_IMPORTED_MODULE_12__.B)(),dispatch=(0,react_redux__WEBPACK_IMPORTED_MODULE_6__.wA)(),[scalesInfo,setScalesInfo]=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)([]);(0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>{if(!scales||0===scales.length)return void setScalesInfo([]);const scalesInfo=getScalesInfo(scales||[]);setScalesInfo(scalesInfo)}),[scales]);const isMultipleScalesMode=(0,react_redux__WEBPACK_IMPORTED_MODULE_6__.d4)((state=>selectors__WEBPACK_IMPORTED_MODULE_7__.A.getIsMultipleScalesMode(state))),isMultipleScales=selectedScales.length>1,getScalesInfo=scales=>{const scalesInfo=[],coreScales=core__WEBPACK_IMPORTED_MODULE_8__.A.getScales();return scales&&0!==scales.length&&coreScales&&0!==Object.keys(coreScales).length?(scales.forEach((scale=>{const coreScaleKey=scale.toString(),scaleData=coreScales[coreScaleKey];if(!scaleData||0===scaleData.length)return void console.warn(`No measurements found for scale ${coreScaleKey}`);const measurements=[],relatedPages=new Set;let canDelete=!0;scaleData.forEach((measurementItem=>{measurementItem instanceof window.Core.Annotations.Annotation&&(relatedPages.add(measurementItem.PageNumber),measurements.push(measurementItem),core__WEBPACK_IMPORTED_MODULE_8__.A.canModify(measurementItem)||(canDelete=!1))}));scalesInfo.some((info=>info.title===coreScaleKey))||scalesInfo.push({scale,title:scale.toString(),measurementsNum:measurements.length,pages:[...relatedPages],canDelete})})),scalesInfo):scalesInfo},openScaleDeletionModal=scaleInfo=>{if(!scaleInfo)return;const warning={message:!!scaleInfo.pages.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"customMessage",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{children:[t("option.measurement.deleteScaleModal.scaleIsOn-delete-info"),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("b",{children:` ${t("option.measurement.deleteScaleModal.page-delete-info")} ${scaleInfo.pages.join(", ")} `}),t("option.measurement.deleteScaleModal.appliedTo-delete-info"),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("b",{children:` ${scaleInfo.measurementsNum} ${scaleInfo.measurementsNum>1?t("option.measurement.deleteScaleModal.measurements"):t("option.measurement.deleteScaleModal.measurement")}.`})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{children:" "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{children:[t("option.measurement.deleteScaleModal.deletionIs"),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("b",{children:` ${t("option.measurement.deleteScaleModal.irreversible")} `}),t("option.measurement.deleteScaleModal.willDeleteMeasurement")]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:t("option.measurement.deleteScaleModal.confirmDelete")})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"customMessage",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{children:[t("option.measurement.deleteScaleModal.confirmDelete"),t("option.measurement.deleteScaleModal.thisCantBeUndone")]})})}),title:`${t("option.measurement.deleteScaleModal.deleteScale")} ${scaleInfo.title}`,confirmBtnText:t("action.confirm"),onConfirm:()=>core__WEBPACK_IMPORTED_MODULE_8__.A.deleteScale(scaleInfo.scale)};dispatch(actions__WEBPACK_IMPORTED_MODULE_5__.A.showWarningMessage(warning))},renderScale=scale=>{const precision=core__WEBPACK_IMPORTED_MODULE_8__.A.getScalePrecision(scale),scaleDisplay=`${Scale.getFormattedValue(scale.pageScale.value,scale.pageScale.unit,precision,!1)} = ${Scale.getFormattedValue(scale.worldScale.value,scale.worldScale.unit,precision,!1)}`;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{children:scaleDisplay})};let title=t("option.measurement.scaleOverlay.multipleScales");if(selectedScales.length&&!isMultipleScales){const selectedScale=new Scale(selectedScales[0]);title=renderScale(selectedScale)}const[isDropDownOpen,setOpenDropDown]=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(!1),toggleDropdown=()=>{setOpenDropDown((prevValue=>!prevValue))},selectorRef=(0,react__WEBPACK_IMPORTED_MODULE_4__.useRef)(null);(0,hooks_useOnClickOutside__WEBPACK_IMPORTED_MODULE_9__.A)(selectorRef,(()=>{setOpenDropDown(!1)}));return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(components_DataElementWrapper__WEBPACK_IMPORTED_MODULE_3__.A,{className:"scale-overlay-selector",dataElement:"scaleSelector",tabIndex:-1,ref:selectorRef,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||toggleDropdown()},onClick:toggleDropdown,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{"data-testid":"scale-selector",className:"scale-overlay-selection","aria-expanded":isDropDownOpen,"aria-labelledby":ariaLabelledBy,"aria-controls":"scale-overlay-dropdown",role:"combobox",tabIndex:0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"scale-overlay-item",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"scale-overlay-name",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"scale-overlay-arrow",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(components_Icon__WEBPACK_IMPORTED_MODULE_2__.A,{glyph:"icon-chevron-down",ariaHidden:!0})})]})}),isDropDownOpen&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ul",{id:"scale-overlay-dropdown",className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("scale-overlay-list"),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"scale-overlay-name",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"scale-overlay-arrow",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{className:"scale-overlay-selected-arrow",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(components_Icon__WEBPACK_IMPORTED_MODULE_2__.A,{glyph:"icon-chevron-up",ariaHidden:!0})})})]}),scalesInfo.map((scaleInfo=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()({'className="scale-overlay-item':!0,"option-selected":selectedScales.includes(scaleInfo.title)}),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()({options:!0}),onClick:()=>onScaleSelected(selectedScales,scaleInfo.title),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),onScaleSelected(selectedScales,scaleInfo.title))},children:renderScale(scaleInfo.scale)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{className:"delete",tabIndex:0,onClick:e=>{e.preventDefault(),e.stopPropagation(),openScaleDeletionModal(scaleInfo)},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),openScaleDeletionModal(scaleInfo))},disabled:scalesInfo.length<=1||!scaleInfo.canDelete,"aria-label":`${t("action.delete")} ${scaleInfo.title}`,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(components_Icon__WEBPACK_IMPORTED_MODULE_2__.A,{glyph:"icon-delete-line"})})]},scaleInfo.title))),isMultipleScalesMode&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(components_Button__WEBPACK_IMPORTED_MODULE_10__.A,{onClick:onAddingNewScale,label:t("option.measurement.scaleOverlay.addNewScale"),className:"add-new-scale"})})]})]})};ScaleSelector.propTypes=propTypes;const __WEBPACK_DEFAULT_EXPORT__=ScaleSelector;ScaleSelector.__docgenInfo={description:"",methods:[],displayName:"ScaleSelector",props:{scales:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"object"}},required:!1},selectedScales:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},onScaleSelected:{description:"",type:{name:"func"},required:!0},onAddingNewScale:{description:"",type:{name:"func"},required:!0},ariaLabelledBy:{description:"",type:{name:"string"},required:!1}}}},"./src/components/ScaleOverlay/ScaleSelector.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Basic:()=>Basic,NotModifiable:()=>NotModifiable,UndefinedCoreScales:()=>UndefinedCoreScales,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_ScaleSelector__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/ScaleOverlay/ScaleSelector.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),react_redux__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-redux/es/index.js"),core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/core/index.js");__webpack_require__("./src/components/ScaleOverlay/ScaleOverlay.scss");const __WEBPACK_DEFAULT_EXPORT__={title:"Components/ScaleOverlay/ScaleSelector",component:_ScaleSelector__WEBPACK_IMPORTED_MODULE_2__.A},scales=[{_pageScale:{value:1,unit:"mm"},_worldScale:{value:10,unit:"mm"},pageScale:{value:1,unit:"mm"},worldScale:{value:10,unit:"mm"},toString:()=>"1 mm = 10 mm"},{_pageScale:{value:1,unit:"in"},_worldScale:{value:50,unit:"in"},pageScale:{value:1,unit:"in"},worldScale:{value:50,unit:"in"},toString:()=>"1 in = 50 in"},{_pageScale:{value:1,unit:"cm"},_worldScale:{value:25,unit:"cm"},pageScale:{value:1,unit:"cm"},worldScale:{value:25,unit:"cm"},toString:()=>"1 cm = 25 cm"}],coreScales={"1 mm = 10 mm":[new window.Core.Annotations.ArcAnnotation],"1 in = 50 in":[new window.Core.Annotations.ArcAnnotation],"1 cm = 25 cm":[new window.Core.Annotations.ArcAnnotation]};let presetScales=["1 mm = 10 mm"];const initialState={viewer:{currentPage:1,isDocumentReadOnly:!1}};function Basic(){const[selectedScales,setSelectedScales]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(presetScales);return core__WEBPACK_IMPORTED_MODULE_4__.A.getScalePrecision=()=>.1,core__WEBPACK_IMPORTED_MODULE_4__.A.getScales=()=>coreScales,core__WEBPACK_IMPORTED_MODULE_4__.A.canModify=()=>!0,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_redux__WEBPACK_IMPORTED_MODULE_3__.Kq,{store:(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_6__.U1)({reducer:()=>initialState}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"ScaleOverlay",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"scale-overlay-header",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_ScaleSelector__WEBPACK_IMPORTED_MODULE_2__.A,{scales,selectedScales,onScaleSelected:(currentScale,selectedScale)=>{setSelectedScales([selectedScale])},onAddingNewScale:()=>{}})})})})}function NotModifiable(){const[selectedScales,setSelectedScales]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(presetScales);return core__WEBPACK_IMPORTED_MODULE_4__.A.getScalePrecision=()=>.1,core__WEBPACK_IMPORTED_MODULE_4__.A.canModify=()=>!1,core__WEBPACK_IMPORTED_MODULE_4__.A.getScales=()=>coreScales,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_redux__WEBPACK_IMPORTED_MODULE_3__.Kq,{store:(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_6__.U1)({reducer:()=>initialState}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"ScaleOverlay",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"scale-overlay-header",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_ScaleSelector__WEBPACK_IMPORTED_MODULE_2__.A,{scales,selectedScales,onScaleSelected:(currentScale,selectedScale)=>{setSelectedScales([selectedScale])},onAddingNewScale:()=>{}})})})})}function UndefinedCoreScales(){const[selectedScales,setSelectedScales]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(presetScales);return core__WEBPACK_IMPORTED_MODULE_4__.A.getScalePrecision=()=>.1,core__WEBPACK_IMPORTED_MODULE_4__.A.canModify=()=>!0,core__WEBPACK_IMPORTED_MODULE_4__.A.getScales=()=>({"1 mm = 10 mm":void 0}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_redux__WEBPACK_IMPORTED_MODULE_3__.Kq,{store:(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_6__.U1)({reducer:()=>initialState}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"ScaleOverlay",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"scale-overlay-header",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_ScaleSelector__WEBPACK_IMPORTED_MODULE_2__.A,{scales,selectedScales,onScaleSelected:(currentScale,selectedScale)=>{setSelectedScales([selectedScale])},onAddingNewScale:()=>{}})})})})}NotModifiable.parameters={chromatic:{modes:{"Light theme RTL":{disable:!0}}}},UndefinedCoreScales.parameters={chromatic:{modes:{"Light theme RTL":{disable:!0}}}};const __namedExportsOrder=["Basic","NotModifiable","UndefinedCoreScales"]},"./src/hooks/useOnClickOutside.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),helpers_getRootNode__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/helpers/getRootNode.js");const __WEBPACK_DEFAULT_EXPORT__=(ref,handler)=>{(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const listener=event=>{ref.current&&!ref.current.contains(event.target)&&handler(event)};let browserDocument=document;return window.isApryseWebViewerWebComponent&&(browserDocument=(0,helpers_getRootNode__WEBPACK_IMPORTED_MODULE_1__.Ay)().getElementById("app")),browserDocument.addEventListener("mousedown",listener),browserDocument.addEventListener("touchstart",listener),()=>{browserDocument.removeEventListener("mousedown",listener),browserDocument.removeEventListener("touchstart",listener)}}),[ref,handler])}}}]);