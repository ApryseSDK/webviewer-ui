(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[931],{"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[14].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/NoteContent/NoteContent.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.NoteContent{position:relative;display:flex;flex-direction:column;align-items:left;flex:1;color:var(--text-color);padding-bottom:12px}.NoteContent.isReply{padding-bottom:0}.NoteContent.unread.isReply{background:rgba(0,165,228,.08)}.NoteContent.unread.clicked .author-and-time span{font-weight:400}.NoteContent.unread .author-and-time span{font-weight:700}.NoteContent .container{padding-left:52px;padding-right:12px}.NoteContent .container,.NoteContent .container-reply{margin-top:8px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;-webkit-user-select:text;-moz-user-select:text;user-select:text;cursor:text}.NoteContent .edit-content{margin-top:7px;display:flex;flex-direction:column;position:relative;flex:1;padding-left:52px;padding-right:12px;padding-bottom:12px}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.NoteContent .edit-content{flex:none}}.NoteContent .edit-content textarea{width:100%;padding-left:8px;border:1px solid var(--border);border-radius:4px;color:var(--text-color);padding-top:4px;padding-bottom:4px;resize:none;overflow:hidden;box-sizing:border-box}.NoteContent .edit-content textarea:focus{outline:none;border:1px solid var(--focus-border)}.NoteContent .edit-content textarea::-moz-placeholder{color:var(--placeholder-text)}.NoteContent .edit-content textarea::placeholder{color:var(--placeholder-text)}.NoteContent .edit-content .edit-buttons{display:flex;flex-direction:row;justify-content:flex-end;margin-top:4px}.NoteContent .edit-content .edit-buttons>div{margin-right:4px}.NoteContent .edit-content .edit-buttons .save-button{border:none;background-color:transparent;cursor:pointer;flex-shrink:0;background:var(--primary-button);border-radius:4px;height:24px;display:flex;align-items:center;justify-content:center;position:relative;color:var(--primary-button-text);padding:0 13px}:host(:not([data-tabbing=true])) .NoteContent .edit-content .edit-buttons .save-button,html:not([data-tabbing=true]) .NoteContent .edit-content .edit-buttons .save-button{outline:none}.NoteContent .edit-content .edit-buttons .save-button:hover{background:var(--primary-button-hover);color:var(--primary-button-text)}.NoteContent .edit-content .edit-buttons .save-button.disabled{background:var(--gray-6);border-color:var(--gray-6);cursor:not-allowed}.NoteContent .edit-content .edit-buttons .cancel-button{border:none;background-color:transparent;color:var(--secondary-button-text);padding:0 10px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;margin-right:2px}:host(:not([data-tabbing=true])) .NoteContent .edit-content .edit-buttons .cancel-button,html:not([data-tabbing=true]) .NoteContent .edit-content .edit-buttons .cancel-button{outline:none}.NoteContent .edit-content .edit-buttons .cancel-button:hover{color:var(--secondary-button-hover)}.NoteContent .reply-content{padding-left:0}.NoteContent .contents{white-space:pre-wrap;color:var(--text-color);margin-right:5px;padding:0;word-break:normal;word-wrap:break-word;-webkit-user-select:text;-moz-user-select:text;user-select:text}.NoteContent .contents .highlight{background:#fffc95;color:#333}.NoteContent .highlight{background:#fffc95}.NoteContent .selected-text-preview{padding-left:52px;padding-top:8px}.NoteContent .reply-attachment-list{margin-bottom:8px}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[14].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/NoteTextPreview/NoteTextPreview.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".note-text-preview{font-size:13px;color:var(--gray-7);padding-right:12px;-webkit-user-select:text!important;-moz-user-select:text!important;user-select:text!important;cursor:text;height:-moz-fit-content;height:fit-content;width:calc(100% - 12px);overflow:hidden}.preview-comment{color:var(--text-color)}.note-text-preview-prompt{cursor:pointer;color:var(--primary-button)}.note-text-preview-prompt:hover{color:var(--primary-button-hover)}",""]),module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[14].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ReplyAttachmentList/ReplyAttachmentList.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".reply-attachment-list{display:flex;flex-direction:column;cursor:default}.reply-attachment-list .reply-attachment{display:flex;flex-direction:column;background-color:var(--gray-1);border-radius:4px;cursor:pointer;overflow:hidden}.reply-attachment-list .reply-attachment:not(:last-child){margin-bottom:8px}.reply-attachment-list .reply-attachment .reply-attachment-preview{width:100%;max-height:80px;display:flex;justify-content:center}.reply-attachment-list .reply-attachment .reply-attachment-preview.dirty{position:relative;margin-bottom:15px}.reply-attachment-list .reply-attachment .reply-attachment-preview img{max-width:100%;max-height:100%;-o-object-fit:contain;object-fit:contain}.reply-attachment-list .reply-attachment .reply-attachment-preview .reply-attachment-preview-message{font-size:11px;color:var(--error-text-color);position:absolute;bottom:-15px;left:10px}.reply-attachment-list .reply-attachment .reply-attachment-info{display:flex;align-items:center;height:40px;padding:8px}.reply-attachment-list .reply-attachment .reply-attachment-info .reply-attachment-icon{height:24px;min-height:24px;width:24px;min-width:24px}.reply-attachment-list .reply-attachment .reply-attachment-info .reply-file-name{height:16px;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-left:8px;margin-right:8px}.reply-attachment-list .reply-attachment .reply-attachment-info .attachment-button{height:24px;min-height:24px;width:24px;min-width:24px}.reply-attachment-list .reply-attachment .reply-attachment-info .attachment-button:hover{background-color:var(--blue-1)}.reply-attachment-list .reply-attachment .reply-attachment-info .attachment-button .Icon{height:16px;width:16px}",""]),module.exports=exports},"./src/components/NoteContent/NoteContent.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[14].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/NoteContent/NoteContent.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/NoteTextPreview/NoteTextPreview.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[14].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/NoteTextPreview/NoteTextPreview.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/ReplyAttachmentList/ReplyAttachmentList.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[14].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/ReplyAttachmentList/ReplyAttachmentList.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/NoteContent/NoteContent.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_NoteContent_NoteContent});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),es=__webpack_require__("./node_modules/react-redux/es/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),es2015=__webpack_require__("./node_modules/autolinker/dist/es2015/index.js"),dayjs_min=__webpack_require__("./node_modules/dayjs/dayjs.min.js"),dayjs_min_default=__webpack_require__.n(dayjs_min),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),localizedFormat=__webpack_require__("./node_modules/dayjs/plugin/localizedFormat.js"),localizedFormat_default=__webpack_require__.n(localizedFormat),isString=__webpack_require__("./node_modules/lodash/isString.js"),isString_default=__webpack_require__.n(isString),NoteTextarea=__webpack_require__("./src/components/NoteTextarea/index.js"),Context=__webpack_require__("./src/components/Note/Context.js"),NoteHeader=__webpack_require__("./src/components/NoteHeader/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js"),NoteTextPreview=__webpack_require__("./src/components/NoteTextPreview/NoteTextPreview.js");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function _sliced_to_array(arr,i){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr,i)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function NoteTextPreviewContainer(props){var notePanelWidth=_sliced_to_array((0,es.d4)((function(state){return[selectors.A.getNotesPanelWidth(state)]}),es.bN),1)[0];return react.createElement(NoteTextPreview.A,_object_spread_props(function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_define_property(target,key,source[key])}))}return target}({},props),{panelWidth:notePanelWidth}))}const NoteTextPreview_NoteTextPreviewContainer=NoteTextPreviewContainer;NoteTextPreviewContainer.__docgenInfo={description:"",methods:[],displayName:"NoteTextPreviewContainer"};const components_NoteTextPreview=NoteTextPreview_NoteTextPreviewContainer;NoteTextPreview_NoteTextPreviewContainer.__docgenInfo={description:"",methods:[],displayName:"NoteTextPreviewContainer"};var ReplyAttachmentList=__webpack_require__("./src/components/ReplyAttachmentList/index.js"),MentionsManager=__webpack_require__("./src/helpers/MentionsManager.js"),getLatestActivityDate=__webpack_require__("./src/helpers/getLatestActivityDate.js"),setAnnotationRichTextStyle=__webpack_require__("./src/helpers/setAnnotationRichTextStyle.js"),getAttributtes=function(element){var attr={};if(element["font-weight"]&&(attr.bold=!0),element["font-style"]&&(attr.italic=!0),element.color&&(attr.color=element.color),element["text-decoration"]){var decoration=element["text-decoration"].split(" ");decoration.includes("line-through")&&(attr.strike=!0),decoration.includes("word")&&(attr.underline=!0)}return attr};const helpers_setReactQuillContent=function(annotation,editor){for(var richTextStyle=annotation.getRichTextStyle(),indexes=Object.keys(richTextStyle),formattedText=MentionsManager.A.getFormattedTextFromDeltas(editor.getContents()),text=MentionsManager.A.extractMentionDataFromStr(formattedText).plainTextValue,ops=[],i=0;i<indexes.length;i++){var element=richTextStyle[indexes[i]],attr=getAttributtes(element);if(!isNaN(indexes[i])){var lastIndex=isNaN(indexes[i+1])?text.length:indexes[i+1],textSlice=text.slice(indexes[i],lastIndex);ops.push({insert:textSlice,attributes:attr})}}editor.setContents(ops),editor.setSelection(text.length,0)};var color=__webpack_require__("./src/helpers/color.js"),ReplyAttachmentManager=__webpack_require__("./src/helpers/ReplyAttachmentManager.js"),device=__webpack_require__("./src/helpers/device.js"),core=__webpack_require__("./src/core/index.js"),map=__webpack_require__("./src/constants/map.js"),theme=__webpack_require__("./src/constants/theme.js"),useDidUpdate=__webpack_require__("./src/hooks/useDidUpdate.js"),actions=__webpack_require__("./src/redux/actions/index.js"),dataElement=__webpack_require__("./src/constants/dataElement.js"),DataElementWrapper=__webpack_require__("./src/components/DataElementWrapper/index.js"),commonColors=__webpack_require__("./src/constants/commonColors.js");__webpack_require__("./src/components/NoteContent/NoteContent.scss");function NoteContent_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _instanceof(left,right){return null!=right&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?!!right[Symbol.hasInstance](left):left instanceof right}function NoteContent_sliced_to_array(arr,i){return function NoteContent_array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function NoteContent_iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function NoteContent_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return NoteContent_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NoteContent_array_like_to_array(o,minLen)}(arr,i)||function NoteContent_non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _ts_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}dayjs_min_default().extend(localizedFormat_default());var propTypes={annotation:prop_types_default().object.isRequired,isEditing:prop_types_default().bool,setIsEditing:prop_types_default().func,noteIndex:prop_types_default().number,isUnread:prop_types_default().bool,isNonReplyNoteRead:prop_types_default().bool,onReplyClicked:prop_types_default().func,isMultiSelected:prop_types_default().bool,isMultiSelectMode:prop_types_default().bool,handleMultiSelect:prop_types_default().func,isGroupMember:prop_types_default().bool},NoteContent_NoteContent=function(param){var annotation=param.annotation,isEditing=param.isEditing,setIsEditing=param.setIsEditing,noteIndex=param.noteIndex,isUnread=param.isUnread,isNonReplyNoteRead=param.isNonReplyNoteRead,onReplyClicked=param.onReplyClicked,isMultiSelected=param.isMultiSelected,isMultiSelectMode=param.isMultiSelectMode,handleMultiSelect=param.handleMultiSelect,isGroupMember=param.isGroupMember,_useSelector=NoteContent_sliced_to_array((0,es.d4)((function(state){return[selectors.A.getNoteDateFormat(state),selectors.A.getIconColor(state,(0,map.c7)(annotation)),selectors.A.isElementDisabled(state,"notePopupState"),selectors.A.getCurrentLanguage(state),selectors.A.notesShowLastUpdatedDate(state),selectors.A.isNotesPanelTextCollapsingEnabled(state),selectors.A.isNotesPanelRepliesCollapsingEnabled(state),selectors.A.getActiveTheme(state),selectors.A.getTimezone(state)]}),es.bN),9),noteDateFormat=_useSelector[0],iconColor=_useSelector[1],isNoteStateDisabled=_useSelector[2],language=_useSelector[3],notesShowLastUpdatedDate=_useSelector[4],canCollapseTextPreview=_useSelector[5],canCollapseReplyPreview=_useSelector[6],activeTheme=_useSelector[7],timezone=_useSelector[8],_useContext=(0,react.useContext)(Context.A),isSelected=_useContext.isSelected,searchInput=_useContext.searchInput,resize=_useContext.resize,pendingEditTextMap=_useContext.pendingEditTextMap,onTopNoteContentClicked=_useContext.onTopNoteContentClicked,sortStrategy=_useContext.sortStrategy,showAnnotationNumbering=_useContext.showAnnotationNumbering,setPendingEditText=_useContext.setPendingEditText,dispatch=(0,es.wA)(),t=NoteContent_sliced_to_array((0,useTranslation.B)(),1)[0],isReply=annotation.isReply(),isTrackedChange=(0,map.c7)(annotation)===map.oC.TRACKED_CHANGE,_useState=NoteContent_sliced_to_array((0,react.useState)([]),2),attachments=_useState[0],setAttachments=_useState[1];(0,react.useEffect)((function(){setAttachments(annotation.getAttachments())}),[annotation]),(0,react.useEffect)((function(){var annotationChangedListener=function(annotations,action){"modify"===action&&annotations.forEach((function(annot){annot.Id===annotation.Id&&setAttachments(annot.getAttachments())}))};return core.A.addEventListener("annotationChanged",annotationChangedListener),function(){core.A.removeEventListener("annotationChanged",annotationChangedListener)}}),[annotation]),(0,useDidUpdate.A)((function(){isEditing||dispatch(actions.A.finishNoteEditing()),resize()}),[isEditing]);var customData,renderAuthorName=(0,react.useCallback)((function(annotation){var name=core.A.getDisplayAuthor(annotation.Author);return name?highlightSearchInput(name,searchInput):t("option.notesPanel.noteContent.noName")}),[searchInput]),skipAutoLink=annotation.getSkipAutoLink&&annotation.getSkipAutoLink(),renderContents=(0,react.useCallback)((function(contents,richTextStyle,fontColor,skipAutoLink){var autolinkerContent=[];if(skipAutoLink||es2015.Ay.link(contents,{stripPrefix:!1,stripTrailingSlash:!1,replaceFn:function replaceFn(match){var href=match.getAnchorHref(),anchorText=match.getAnchorText(),offset=match.getOffset();switch(match.getType()){case"url":case"email":case"phone":autolinkerContent.push({href,text:anchorText,start:offset,end:offset+match.getMatchedText().length})}}}),!autolinkerContent.length){var highlightResult=highlightSearchInput(contents,searchInput,richTextStyle);if(!searchInput&&(!isReply&&canCollapseTextPreview||isReply&&canCollapseReplyPreview)){return react.createElement(components_NoteTextPreview,{linesToBreak:3,comment:!0,renderRichText,richTextStyle,resize,style:fontColor,beforeContent:function(){if(!isTrackedChange)return null;var text=1===annotation.TrackedChangeType?t("officeEditor.added"):t("officeEditor.deleted");return react.createElement("span",{style:{color:annotation.FillColor.toString(),fontWeight:700}},text)}},contents)}return highlightResult}var contentToRender=[],strIdx=0;return autolinkerContent.forEach((function(anchorData,forIdx){var start=anchorData.start,end=anchorData.end,href=anchorData.href;strIdx<start&&contentToRender.push(react.createElement("span",{key:"span_".concat(forIdx)},highlightSearchInput(contents,searchInput,richTextStyle,strIdx,start))),contentToRender.push(react.createElement("a",{href,target:"_blank",rel:"noopener noreferrer",key:"a_".concat(forIdx)},highlightSearchInput(contents,searchInput,richTextStyle,start,end))),strIdx=end})),strIdx<contents.length-1&&contentToRender.push(highlightSearchInput(contents,searchInput,richTextStyle,strIdx)),contentToRender}),[searchInput]),icon=(0,map.ap)((0,map.c7)(annotation)).icon;try{customData=JSON.parse(annotation.getCustomData("trn-mention"))}catch(e){customData=annotation.getCustomData("trn-mention")}var contents=(null==customData?void 0:customData.contents)||annotation.getContents(),contentsToRender=annotation.getContents(),richTextStyle=annotation.getRichTextStyle(),textColor=annotation.TextColor;if(activeTheme===theme.A.DARK)textColor&&(0,color.lw)(textColor.toHexString())&&(textColor=new window.Core.Annotations.Color(255,255,255,1)),richTextStyle&&Object.keys(richTextStyle).forEach((function(a){richTextStyle[a].color&&(0,color.lw)(richTextStyle[a].color)&&(richTextStyle[a].color=commonColors.z.white)}));else if(activeTheme===theme.A.LIGHT){if(textColor&&(0,color.vO)(textColor.toHexString())&&(textColor=new window.Core.Annotations.Color(0,0,0,1)),richTextStyle)Object.keys(richTextStyle).forEach((function(a){richTextStyle[a].color&&(0,color.vO)(richTextStyle[a].color)&&(richTextStyle[a].color=commonColors.z.black)}))}var textAreaValue,thereIsNoUnpostedEdit=void 0===pendingEditTextMap[annotation.Id];textAreaValue=contents&&thereIsNoUnpostedEdit?contents:pendingEditTextMap[annotation.Id];var handleContentsClicked=function(e){var _window_getSelection;(null===(_window_getSelection=window.getSelection())||void 0===_window_getSelection?void 0:_window_getSelection.toString())&&(null==e||e.stopPropagation())},noteContentClass=classnames_default()({NoteContent:!0,isReply,unread:isUnread,clicked:isNonReplyNoteRead}),content=(0,react.useMemo)((function(){var contentStyle={};return textColor&&(contentStyle.color=textColor.toHexString()),react.createElement(react.Fragment,null,isEditing&&isSelected?react.createElement(ContentArea,{annotation,noteIndex,setIsEditing,textAreaValue,onTextAreaValueChange:setPendingEditText,pendingText:pendingEditTextMap[annotation.Id]}):contentsToRender&&react.createElement("div",{className:classnames_default()("container",{"reply-content":isReply}),onClick:handleContentsClicked},isReply&&attachments.length>0&&react.createElement(ReplyAttachmentList.A,{files:attachments,isEditing:!1}),renderContents(contentsToRender,richTextStyle,contentStyle,skipAutoLink)))}),[annotation,isSelected,isEditing,setIsEditing,contents,renderContents,textAreaValue,setPendingEditText,attachments]),text=annotation.getCustomData("trn-annot-preview"),textPreview=(0,react.useMemo)((function(){if(""===text)return null;var highlightSearchResult=highlightSearchInput(text,searchInput),shouldCollapseAnnotationText=!isReply&&canCollapseTextPreview;return isString_default()(highlightSearchResult)&&shouldCollapseAnnotationText?react.createElement(DataElementWrapper.A,{className:"selected-text-preview",dataElement:"notesSelectedTextPreview"},react.createElement(components_NoteTextPreview,{linesToBreak:3},'"'.concat(highlightSearchResult,'"'))):react.createElement("div",{className:"selected-text-preview",style:{paddingRight:"12px"}},highlightSearchResult)}),[text,searchInput]),header=(0,react.useMemo)((function(){return react.createElement(NoteHeader.A,{icon,iconColor,annotation,language,noteDateFormat,isSelected,setIsEditing,notesShowLastUpdatedDate,isReply,isUnread,renderAuthorName,isNoteStateDisabled,isEditing,noteIndex,sortStrategy,activeTheme,handleMultiSelect,isMultiSelected,isMultiSelectMode,isGroupMember,showAnnotationNumbering,timezone,isTrackedChange})}),[icon,iconColor,annotation,language,noteDateFormat,isSelected,setIsEditing,notesShowLastUpdatedDate,isReply,isUnread,renderAuthorName,core.A.getDisplayAuthor(annotation.Author),isNoteStateDisabled,isEditing,noteIndex,(0,getLatestActivityDate.A)(annotation),sortStrategy,handleMultiSelect,isMultiSelected,isMultiSelectMode,isGroupMember,timezone,isTrackedChange]);return react.createElement("div",{className:noteContentClass,onClick:function(){isGroupMember||(isReply?onReplyClicked(annotation):isEditing||onTopNoteContentClicked())}},header,textPreview,content)};NoteContent_NoteContent.propTypes=propTypes;const components_NoteContent_NoteContent=NoteContent_NoteContent;var ContentArea=function(param){var annotation=param.annotation,noteIndex=param.noteIndex,setIsEditing=param.setIsEditing,textAreaValue=param.textAreaValue,onTextAreaValueChange=param.onTextAreaValueChange,pendingText=param.pendingText,_useSelector=NoteContent_sliced_to_array((0,es.d4)((function(state){return[selectors.A.getAutoFocusNoteOnAnnotationSelection(state),selectors.A.getIsMentionEnabled(state),selectors.A.isElementDisabled(state,dataElement.A.INLINE_COMMENT_POPUP),selectors.A.isElementOpen(state,dataElement.A.INLINE_COMMENT_POPUP),selectors.A.isElementOpen(state,dataElement.A.NOTES_PANEL),selectors.A.getActiveDocumentViewerKey(state),selectors.A.isAnyCustomPanelOpen(state)]})),7),autoFocusNoteOnAnnotationSelection=_useSelector[0],isMentionEnabled=_useSelector[1],isInlineCommentDisabled=_useSelector[2],isInlineCommentOpen=_useSelector[3],isNotesPanelOpen=_useSelector[4],activeDocumentViewerKey=_useSelector[5],isAnyCustomPanelOpen=_useSelector[6],t=NoteContent_sliced_to_array((0,useTranslation.B)(),1)[0],textareaRef=(0,react.useRef)(),isReply=annotation.isReply(),_useContext=(0,react.useContext)(Context.A),setCurAnnotId=_useContext.setCurAnnotId,pendingAttachmentMap=_useContext.pendingAttachmentMap,deleteAttachment=_useContext.deleteAttachment,clearAttachments=_useContext.clearAttachments,addAttachments=_useContext.addAttachments,shouldNotFocusOnInput=!isInlineCommentDisabled&&isInlineCommentOpen&&(0,device.Fr)();(0,react.useEffect)((function(){if(isAnyCustomPanelOpen||(isNotesPanelOpen||isInlineCommentOpen)&&textareaRef.current){var editor=textareaRef.current.getEditor();annotation&&_instanceof(annotation,window.Core.Annotations.FreeTextAnnotation)&&editor.setText(""),pendingText?(0,setAnnotationRichTextStyle.A)(editor,annotation):editor.getContents()&&setTimeout((function(){if(isMentionEnabled){textAreaValue=MentionsManager.A.getFormattedTextFromDeltas(editor.getContents());var _mentionsManager_extractMentionDataFromStr=MentionsManager.A.extractMentionDataFromStr(textAreaValue),plainTextValue=_mentionsManager_extractMentionDataFromStr.plainTextValue;_mentionsManager_extractMentionDataFromStr.ids.length&&editor.setText(plainTextValue)}var _textareaRef_current;shouldNotFocusOnInput||autoFocusNoteOnAnnotationSelection&&(null===(_textareaRef_current=textareaRef.current)||void 0===_textareaRef_current||_textareaRef_current.focus(),annotation.getRichTextStyle()&&helpers_setReactQuillContent(annotation,editor))}),100);var textLength=editor.getLength()-1;if(shouldNotFocusOnInput)return;setTimeout((function(){textLength&&editor.setSelection(textLength,textLength)}),100)}}),[isNotesPanelOpen,isInlineCommentOpen,shouldNotFocusOnInput]),(0,react.useEffect)((function(){if(isReply&&0===pendingAttachments.length){var attachments=annotation.getAttachments();addAttachments(annotation.Id,attachments)}}),[]);var _ref,setContents=(_ref=function _async_to_generator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}((function(e){var editor,_mentionsManager_extractMentionDataFromStr,plainTextValue,ids,source;return _ts_generator(this,(function(_state){switch(_state.label){case 0:return e.preventDefault(),editor=textareaRef.current.getEditor(),textAreaValue=MentionsManager.A.getFormattedTextFromDeltas(editor.getContents()),(0,setAnnotationRichTextStyle.A)(editor,annotation),annotation.getSkipAutoLink&&annotation.getSkipAutoLink()&&annotation.disableSkipAutoLink(),isMentionEnabled?(_mentionsManager_extractMentionDataFromStr=MentionsManager.A.extractMentionDataFromStr(textAreaValue),plainTextValue=_mentionsManager_extractMentionDataFromStr.plainTextValue,ids=_mentionsManager_extractMentionDataFromStr.ids,MentionsManager.A.extractMentionDataFromAnnot(annotation).mentions.forEach((function(mention){plainTextValue.includes(mention.value)&&ids.push(mention.id)})),annotation.setCustomData("trn-mention",JSON.stringify({contents:textAreaValue,ids})),annotation.setContents(plainTextValue)):annotation.setContents(textAreaValue),[4,(0,ReplyAttachmentManager.ET)(annotation,pendingAttachmentMap[annotation.Id])];case 1:return _state.sent(),source=_instanceof(annotation,window.Core.Annotations.FreeTextAnnotation)?"textChanged":"noteChanged",core.A.getAnnotationManager(activeDocumentViewerKey).trigger("annotationChanged",[[annotation],"modify",{source}]),_instanceof(annotation,window.Core.Annotations.FreeTextAnnotation)&&core.A.drawAnnotationsFromList([annotation]),setIsEditing(!1,noteIndex),""!==textAreaValue&&onTextAreaValueChange(void 0,annotation.Id),clearAttachments(annotation.Id),[2]}}))})),function setContents(e){return _ref.apply(this,arguments)}),contentClassName=classnames_default()("edit-content",{"reply-content":isReply}),pendingAttachments=pendingAttachmentMap[annotation.Id]||[];return react.createElement("div",{className:contentClassName},isReply&&pendingAttachments.length>0&&react.createElement(ReplyAttachmentList.A,{files:pendingAttachments,isEditing:!0,fileDeleted:function(file){return deleteAttachment(annotation.Id,file)}}),react.createElement(NoteTextarea.A,{ref:function(el){textareaRef.current=el},value:textAreaValue,onChange:function(value){return onTextAreaValueChange(value,annotation.Id)},onSubmit:setContents,isReply,onBlur:function(e){var _e_relatedTarget_getAttribute,_e_relatedTarget;(null===(_e_relatedTarget=e.relatedTarget)||void 0===_e_relatedTarget||null===(_e_relatedTarget_getAttribute=_e_relatedTarget.getAttribute("data-element"))||void 0===_e_relatedTarget_getAttribute?void 0:_e_relatedTarget_getAttribute.includes("annotationCommentButton"))?e.target.focus():setCurAnnotId(void 0)},onFocus:function(){setCurAnnotId(annotation.Id)}}),react.createElement("div",{className:"edit-buttons"},react.createElement("button",{className:"cancel-button",onClick:function(e){e.stopPropagation(),setIsEditing(!1,noteIndex),onTextAreaValueChange(void 0,annotation.Id),clearAttachments(annotation.Id)}},t("action.cancel")),react.createElement("button",{className:"save-button".concat(textAreaValue?"":" disabled"),disabled:!textAreaValue,onClick:function(e){e.stopPropagation(),setContents(e)}},t("action.save"))))};ContentArea.propTypes={noteIndex:prop_types_default().number.isRequired,annotation:prop_types_default().object.isRequired,setIsEditing:prop_types_default().func.isRequired,textAreaValue:prop_types_default().string,onTextAreaValueChange:prop_types_default().func.isRequired,pendingText:prop_types_default().string};var getRichTextSpan=function(text,richTextStyle,key){var style={fontWeight:richTextStyle["font-weight"],fontStyle:richTextStyle["font-style"],textDecoration:richTextStyle["text-decoration"],color:richTextStyle.color};return style.textDecoration&&(style.textDecoration=style.textDecoration.replace("word","underline")),react.createElement("span",{style,key},text)},renderRichText=function(text,richTextStyle,start){if(!richTextStyle||!text)return text;for(var styles={},indices=Object.keys(richTextStyle).map(Number).sort((function(a,b){return a-b})),i=0;i<indices.length;i++){var index=indices[i]-start;if(styles[index=Math.min(Math.max(index,0),text.length)]=richTextStyle[indices[i]],index===text.length)break}for(var contentToRender=[],styleIndices=Object.keys(styles).map(Number).sort((function(a,b){return a-b})),i1=1;i1<styleIndices.length;i1++)contentToRender.push(getRichTextSpan(text.slice(styleIndices[i1-1],styleIndices[i1]),styles[styleIndices[i1-1]],"richtext_span_".concat(i1)));return contentToRender},highlightSearchInput=function(fullText,searchInput,richTextStyle){var start=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,end=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fullText.length,text=fullText.slice(start,end),loweredText=text.toLowerCase(),loweredSearchInput=searchInput.toLowerCase();richTextStyle&&(richTextStyle[0]=richTextStyle[0]||{},richTextStyle[fullText.length]=richTextStyle[fullText.length]||{});var lastFoundInstance=loweredText.indexOf(loweredSearchInput);if(!loweredSearchInput.trim()||-1===lastFoundInstance)return renderRichText(text,richTextStyle,start);var contentToRender=[],allFoundPositions=[lastFoundInstance],regexSafeSearchInput=loweredSearchInput.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(new RegExp("(".concat(regexSafeSearchInput,")"),"gi").test(loweredText))for(;-1!==lastFoundInstance;)-1!==(lastFoundInstance=loweredText.indexOf(loweredSearchInput,lastFoundInstance+loweredSearchInput.length))&&allFoundPositions.push(lastFoundInstance);return allFoundPositions.forEach((function(position,idx){0===idx&&0!==position&&contentToRender.push(renderRichText(text.substring(0,position),richTextStyle,start)),contentToRender.push(react.createElement("span",{className:"highlight",key:"highlight_span_".concat(idx)},renderRichText(text.substring(position,position+loweredSearchInput.length),richTextStyle,start+position))),position+loweredSearchInput.length<loweredText.length&&position+loweredSearchInput.length!==allFoundPositions[idx+1]&&contentToRender.push(renderRichText(text.substring(position+loweredSearchInput.length,allFoundPositions[idx+1]),richTextStyle,start+position+loweredSearchInput.length))})),contentToRender};NoteContent_NoteContent.__docgenInfo={description:"",methods:[],displayName:"NoteContent",props:{annotation:{description:"",type:{name:"object"},required:!0},isEditing:{description:"",type:{name:"bool"},required:!1},setIsEditing:{description:"",type:{name:"func"},required:!1},noteIndex:{description:"",type:{name:"number"},required:!1},isUnread:{description:"",type:{name:"bool"},required:!1},isNonReplyNoteRead:{description:"",type:{name:"bool"},required:!1},onReplyClicked:{description:"",type:{name:"func"},required:!1},isMultiSelected:{description:"",type:{name:"bool"},required:!1},isMultiSelectMode:{description:"",type:{name:"bool"},required:!1},handleMultiSelect:{description:"",type:{name:"func"},required:!1},isGroupMember:{description:"",type:{name:"bool"},required:!1}}}},"./src/components/NoteTextPreview/NoteTextPreview.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_i18next__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__);__webpack_require__("./src/components/NoteTextPreview/NoteTextPreview.scss");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _sliced_to_array(arr,i){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr,i)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function NoteTextPreview(props){var text=props.children.replace(/\n$/,""),panelWidth=props.panelWidth,linesToBreak=props.linesToBreak,renderRichText=props.renderRichText,richTextStyle=props.richTextStyle,resize=props.resize,style=props.style,_props_comment=props.comment,comment=void 0!==_props_comment&&_props_comment,_props_beforeContent=props.beforeContent,beforeContent=void 0===_props_beforeContent?function(){}:_props_beforeContent,_useState=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),expanded=_useState[0],setExpand=_useState[1],_useState1=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),2),previewElementWidth=_useState1[0],setPreviewWidth=_useState1[1],_useState2=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),2),charsPerLine=_useState2[0],setCharsperLine=_useState2[1],_useState3=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),showPrompt=_useState3[0],setShowPrompt=_useState3[1],ref=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null),t=(0,react_i18next__WEBPACK_IMPORTED_MODULE_3__.B)().t,textToDisplay=expanded?text:text.substring(0,charsPerLine*linesToBreak),prompt=t(expanded?"action.showLess":"action.showMore"),noteTextPreviewClass=classnames__WEBPACK_IMPORTED_MODULE_1___default()("note-text-preview",{"preview-comment":comment});return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var textNodeWidth=ref.current.clientWidth;setPreviewWidth(textNodeWidth)}),[panelWidth]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((function(){var textWidth=function getTextWidth(text){var context=document.createElement("canvas").getContext("2d");return context.font="13px sans-serif",context.measureText(text).width}(text),averageCharWidth=textWidth/text.length,charsPerLine=Math.floor(previewElementWidth/averageCharWidth);setCharsperLine(charsPerLine),setShowPrompt(textWidth/previewElementWidth>linesToBreak)}),[text,previewElementWidth]),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:noteTextPreviewClass,ref,style},beforeContent(),renderRichText&&richTextStyle?renderRichText(textToDisplay,richTextStyle,0):textToDisplay," ",showPrompt&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("a",{className:"note-text-preview-prompt",onClick:function(event){event.stopPropagation(),setExpand(!expanded),resize&&resize()}},prompt))}const __WEBPACK_DEFAULT_EXPORT__=NoteTextPreview;NoteTextPreview.__docgenInfo={description:"",methods:[],displayName:"NoteTextPreview"}},"./src/components/NoteTextarea/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _NoteTextarea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/NoteTextarea/NoteTextarea.js");const __WEBPACK_DEFAULT_EXPORT__=_NoteTextarea__WEBPACK_IMPORTED_MODULE_0__.A;_NoteTextarea__WEBPACK_IMPORTED_MODULE_0__.A.__docgenInfo={description:"",methods:[],displayName:"NoteTextarea",props:{value:{description:"",type:{name:"string"},required:!1},placeholder:{description:"",type:{name:"string"},required:!1},onChange:{description:"",type:{name:"func"},required:!0},onBlur:{description:"",type:{name:"func"},required:!1},onFocus:{description:"",type:{name:"func"},required:!1},onSubmit:{description:"",type:{name:"func"},required:!1}}}},"./src/components/ReplyAttachmentList/ReplyAttachmentList.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_ReplyAttachmentList_ReplyAttachmentList});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js"),FileSaver_min=__webpack_require__("./node_modules/file-saver/dist/FileSaver.min.js"),Button=__webpack_require__("./src/components/Button/index.js"),Icon=__webpack_require__("./src/components/Icon/index.js"),Tooltip=__webpack_require__("./src/components/Tooltip/index.js"),ReplyAttachmentManager=__webpack_require__("./src/helpers/ReplyAttachmentManager.js"),purify=__webpack_require__("./node_modules/dompurify/dist/purify.js"),purify_default=__webpack_require__.n(purify);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _ts_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}var _ref,readAsText=function(svg){return new Promise((function(resolve){if(void 0===svg.size)resolve(svg.toString("utf-8"));else{var fileReader=new FileReader;fileReader.onload=function(){return resolve(fileReader.result)},fileReader.readAsText(svg)}}))},sanitizeSVG=(_ref=function _async_to_generator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}((function(file){var svgText,forbiddenTags,clean;return _ts_generator(this,(function(_state){switch(_state.label){case 0:return[4,readAsText(file)];case 1:return(svgText=_state.sent())?(forbiddenTags=[],purify_default().addHook("uponSanitizeElement",(function(_,hookEvent){var tagName=hookEvent.tagName;hookEvent.allowedTags[tagName]||forbiddenTags.push(tagName)})),clean=purify_default().sanitize(svgText),[2,{svg:new Blob([clean],{type:"image/svg+xml"}),isDirty:forbiddenTags.length>0}]):[2,{svg:file}]}}))})),function sanitizeSVG(file){return _ref.apply(this,arguments)});__webpack_require__("./src/components/ReplyAttachmentList/ReplyAttachmentList.scss");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ReplyAttachmentList_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function ReplyAttachmentList_async_to_generator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){ReplyAttachmentList_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){ReplyAttachmentList_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _instanceof(left,right){return null!=right&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?!!right[Symbol.hasInstance](left):left instanceof right}function _sliced_to_array(arr,i){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr,i)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ReplyAttachmentList_ts_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}var ImagePreview=function(param){var file=param.file,t=_sliced_to_array((0,useTranslation.B)(),1)[0],_useState=_sliced_to_array((0,react.useState)(),2),src=_useState[0],setSrc=_useState[1],_useState1=_sliced_to_array((0,react.useState)(!1),2),isDirtySVG=_useState1[0],setIsDirtySvg=_useState1[1];return(0,react.useEffect)((function(){var processImagePreview=function(){var _ref=ReplyAttachmentList_async_to_generator((function(){var fileToSanitize,isImageFromPDF,_ref,svg,isDirty;return ReplyAttachmentList_ts_generator(this,(function(_state){switch(_state.label){case 0:return setIsDirtySvg(!1),fileToSanitize=file,(isImageFromPDF=!_instanceof(file,File)&&!file.url)?[4,(0,ReplyAttachmentManager.jF)(file)]:[3,2];case 1:fileToSanitize=_state.sent(),_state.label=2;case 2:return _instanceof(file,File)||isImageFromPDF?function(file){return"image/svg+xml"===file.type}(file)?[4,sanitizeSVG(fileToSanitize)]:[3,4]:[3,5];case 3:return _ref=_state.sent(),svg=_ref.svg,isDirty=_ref.isDirty,setSrc(URL.createObjectURL(svg)),setIsDirtySvg(isDirty),[3,5];case 4:setSrc(URL.createObjectURL(fileToSanitize)),_state.label=5;case 5:return[2]}}))}));return function processImagePreview(){return _ref.apply(this,arguments)}}();processImagePreview()}),[file]),react.createElement("div",{className:classnames_default()({"reply-attachment-preview":!0,dirty:isDirtySVG})},react.createElement("img",{src}),isDirtySVG&&react.createElement("span",{className:"reply-attachment-preview-message"},t("message.svgMalicious")))},ReplyAttachmentList_ReplyAttachmentList=function(param){var files=param.files,isEditing=param.isEditing,fileDeleted=param.fileDeleted,_useSelector=_sliced_to_array((0,es.d4)((function(state){return[selectors.A.getTabManager(state),selectors.A.isReplyAttachmentPreviewEnabled(state)]})),2),tabManager=_useSelector[0],previewEnabled=_useSelector[1],onClick=function(){var _ref=ReplyAttachmentList_async_to_generator((function(e,file){var fileData;return ReplyAttachmentList_ts_generator(this,(function(_state){switch(_state.label){case 0:return e.preventDefault(),e.stopPropagation(),tabManager?_instanceof(file,File)?(fileData=file,[3,4]):[3,1]:[2,console.warn("Can't open attachment in non-multi-tab mode")];case 1:return file.url?(fileData=file.url,[3,4]):[3,2];case 2:return[4,(0,ReplyAttachmentManager.jF)(file)];case 3:fileData=_state.sent(),_state.label=4;case 4:return fileData&&tabManager.addTab(fileData,{filename:file.name,setActive:!0,saveCurrentActiveTabState:!0}),[2]}}))}));return function onClick(e,file){return _ref.apply(this,arguments)}}(),onDownload=function(){var _ref=ReplyAttachmentList_async_to_generator((function(e,file){var fileData,_tmp;return ReplyAttachmentList_ts_generator(this,(function(_state){switch(_state.label){case 0:return e.preventDefault(),e.stopPropagation(),file.url?(_tmp=file.url,[3,3]):[3,1];case 1:return[4,(0,ReplyAttachmentManager.jF)(file)];case 2:_tmp=_state.sent(),_state.label=3;case 3:return fileData=_tmp,(0,FileSaver_min.saveAs)(fileData,file.name),[2]}}))}));return function onDownload(e,file){return _ref.apply(this,arguments)}}();return react.createElement("div",{className:"reply-attachment-list"},files.map((function(file,i){return react.createElement("div",{className:"reply-attachment",key:i,onClick:function(e){return onClick(e,file)}},previewEnabled&&(0,ReplyAttachmentManager.wu)(file)&&react.createElement(ImagePreview,{file}),react.createElement("div",{className:"reply-attachment-info"},react.createElement(Icon.A,{className:"reply-attachment-icon",glyph:(0,ReplyAttachmentManager.HY)(file)}),react.createElement(Tooltip.A,{content:file.name},react.createElement("div",{className:"reply-file-name"},file.name)),isEditing?react.createElement(Button.A,{className:"attachment-button",img:"icon-close",onClick:function(e){return function(e,file){e.preventDefault(),e.stopPropagation(),fileDeleted(file)}(e,file)}}):react.createElement(Button.A,{className:"attachment-button",img:"icon-download",onClick:function(e){return onDownload(e,file)}})))})))};const components_ReplyAttachmentList_ReplyAttachmentList=ReplyAttachmentList_ReplyAttachmentList;ReplyAttachmentList_ReplyAttachmentList.__docgenInfo={description:"",methods:[],displayName:"ReplyAttachmentList"}},"./src/components/ReplyAttachmentList/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _ReplyAttachmentList__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/ReplyAttachmentList/ReplyAttachmentList.js");const __WEBPACK_DEFAULT_EXPORT__=_ReplyAttachmentList__WEBPACK_IMPORTED_MODULE_0__.A;_ReplyAttachmentList__WEBPACK_IMPORTED_MODULE_0__.A.__docgenInfo={description:"",methods:[],displayName:"ReplyAttachmentList"}},"./src/helpers/ReplyAttachmentManager.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _async_to_generator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _ts_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}__webpack_require__.d(__webpack_exports__,{ET:()=>setAnnotationAttachments,HY:()=>getAttachmentIcon,jF:()=>decompressFileContent,wu:()=>isImage});var icons={pdf:"ic-file-pdf",image:"ic-file-img",cad:"ic-file-cad",doc:"ic-file-doc",ppt:"ic-file-ppt",xls:"ic-file-xls",unknown:"ic-file-etc"},FileAttachmentUtils=window.Core.Annotations.FileAttachmentUtils;function decompressFileContent(file){return _decompressFileContent.apply(this,arguments)}function _decompressFileContent(){return(_decompressFileContent=_async_to_generator((function(file){return _ts_generator(this,(function(_state){return[2,FileAttachmentUtils.decompressWithFlateDecode(file.content,file.type)]}))}))).apply(this,arguments)}function setAnnotationAttachments(annotation){return _setAnnotationAttachments.apply(this,arguments)}function _setAnnotationAttachments(){return _setAnnotationAttachments=_async_to_generator((function(annotation){var files,_arguments=arguments;return _ts_generator(this,(function(_state){switch(_state.label){case 0:return files=_arguments.length>1&&void 0!==_arguments[1]?_arguments[1]:[],[4,annotation.setAttachments(files)];case 1:return _state.sent(),[2]}}))})),_setAnnotationAttachments.apply(this,arguments)}function isImage(file){return!(!file.type||!file.type.startsWith("image/"))}function getAttachmentIcon(file){var _file_name;if(isImage(file))return icons.image;switch(null===(_file_name=file.name)||void 0===_file_name?void 0:_file_name.split(".").pop().toLowerCase()){case"pdf":return icons.pdf;case"cad":return icons.cad;case"doc":case"docx":return icons.doc;case"ppt":case"pptx":return icons.ppt;case"xls":case"xlsx":return icons.xls;default:return icons.unknown}}},"./src/helpers/setAnnotationRichTextStyle.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function(editor,annotation){var richTextStyle={},ops=editor.getContents().ops,breakpoint=0;ops.forEach((function(item){var _item_insert,attributes=item.attributes,isMention=null===(_item_insert=item.insert)||void 0===_item_insert?void 0:_item_insert.mention,value=item.insert;if(isMention){var mention=item.insert.mention;value=mention.denotationChar+mention.value}var cssStyle={};(null==attributes?void 0:attributes.bold)&&(cssStyle["font-weight"]="bold"),(null==attributes?void 0:attributes.italic)&&(cssStyle["font-style"]="italic"),(null==attributes?void 0:attributes.color)&&(cssStyle.color=attributes.color),(null==attributes?void 0:attributes.underline)&&(cssStyle["text-decoration"]="word"),(null==attributes?void 0:attributes.strike)&&(cssStyle["text-decoration"]?cssStyle["text-decoration"]="".concat(cssStyle["text-decoration"]," line-through"):cssStyle["text-decoration"]="line-through"),(null==attributes?void 0:attributes.size)&&(cssStyle["font-size"]=attributes.size),(null==attributes?void 0:attributes.font)&&(cssStyle["font-family"]=attributes.font),richTextStyle[breakpoint]=cssStyle,breakpoint+=value.length})),annotation.setRichTextStyle(richTextStyle)}}}]);