(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[8254],{"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SearchOverlay/SearchOptionsFlyout.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".CustomElement{padding:0 8px}.CustomElement span:first-of-type{margin:4px 4px 4px 0}",""]),module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SearchOverlay/SearchOverlay.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.SearchOverlay.modular-ui .replace-buttons .btn-replace:hover:not(:disabled){background:var(--primary-button-hover);border-color:var(--primary-button-hover);color:var(--gray-0)}.SearchOverlay.modular-ui .replace-buttons .btn-replace-all:hover:not(:disabled){border:none;background:none;color:var(--blue-6)}.SearchOverlay.modular-ui .replace-buttons .btn-replace-all:hover:not(:disabled) .Icon{color:var(--blue-6)}.SearchOverlay.modular-ui .footer .buttons .button:hover,.SearchOverlay.modular-ui .input-container .clearSearch-button:hover{cursor:pointer;border:none;box-shadow:inset 0 0 0 1px var(--blue-6);color:var(--blue-6);background-color:var(--faded-component-background)}.SearchOverlay{position:static;display:flex;flex-direction:column;padding-inline-end:8px;flex-wrap:nowrap;border:0;border-radius:0;background:transparent;visibility:visible!important;flex-grow:0}.SearchOverlay .search-input-row{display:flex;align-items:center;grid-gap:8px;gap:8px}.SearchOverlay .search-options-button{height:32px;width:32px}.SearchOverlay .search-options-button .Icon,.SearchOverlay .search-options-button .Icon svg{width:24px;height:24px}.SearchOverlay .search-options-button .Icon svg .dot{fill:var(--blue-5)}.SearchOverlay .search-options-button .Icon svg .filter{fill:var(--gray-6)}.SearchOverlay .replace-icon{margin:0 8px 0 0}.SearchOverlay .replace-icon .Icon svg{fill:var(--gray-6);color:var(--gray-6)}.SearchOverlay .input-container{position:relative;box-sizing:border-box;border:1px solid var(--border);border-radius:4px;height:32px;display:flex;align-items:center;justify-content:flex-end;color:var(--text-color);padding:4px 8px;background:var(--component-background);flex:1}.SearchOverlay .input-container.with-replace-icon{justify-content:flex-start}.SearchOverlay .input-container input{width:100%;padding-inline-end:26px;height:24px;border:none;background:transparent;padding:0}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchOverlay .input-container input{font-size:13px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SearchOverlay .input-container input{font-size:13px}}.SearchOverlay .input-container.with-replace-icon input{padding-inline-end:0}.SearchOverlay .input-container input::-moz-placeholder{color:var(--placeholder-text)}.SearchOverlay .input-container input::placeholder{color:var(--placeholder-text)}.SearchOverlay .input-container .Icon{width:16px;height:16px}.SearchOverlay .input-container .clearSearch-button{padding:0;border:none;background-color:transparent;cursor:pointer;border-radius:4px;display:flex;align-items:center;justify-content:center;position:absolute;width:24px;height:24px}:host(:not([data-tabbing=true])) .SearchOverlay .input-container .clearSearch-button,html:not([data-tabbing=true]) .SearchOverlay .input-container .clearSearch-button{outline:none}.SearchOverlay .input-container .clearSearch-button svg{color:var(--gray-7)}.SearchOverlay .input-container .clearSearch-button:hover{background:var(--blue-1)}.SearchOverlay .search-option-buttons{display:flex;align-items:center;grid-gap:8px;gap:8px}.SearchOverlay .divider{height:1px;width:100%;background:var(--divider);margin:16px 0}.SearchOverlay .options{display:flex;flex-wrap:wrap;margin-top:8px}.SearchOverlay .options>span{margin-inline-end:16px}.SearchOverlay .options>span>label{white-space:nowrap}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchOverlay .options>span>label{font-size:13px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SearchOverlay .options>span>label{font-size:13px}}.SearchOverlay .replace-options{margin-top:8px}.SearchOverlay .replace-options .replace-buttons{display:flex;flex-direction:row;justify-content:flex-end;padding-top:10px}.SearchOverlay .replace-options .replace-buttons .spinner{margin:0;position:absolute;inset-inline-start:30px}.SearchOverlay .replace-options .replace-buttons .btn-replace{display:flex;justify-content:center;align-items:center;background-color:var(--blue-5);border:1px solid var(--blue-5);color:var(--gray-0);padding:6px 18px;width:auto;width:-moz-fit-content;width:fit-content;border-radius:4px;height:32px;cursor:pointer}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchOverlay .replace-options .replace-buttons .btn-replace{font-size:13px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SearchOverlay .replace-options .replace-buttons .btn-replace{font-size:13px}}.SearchOverlay .replace-options .replace-buttons .btn-replace-all{display:flex;justify-content:center;align-items:center;color:var(--blue-5);padding:6px 18px;width:auto;width:-moz-fit-content;width:fit-content;height:32px;cursor:pointer;margin-inline-end:5px}.SearchOverlay .replace-options .replace-buttons .btn-replace-all:hover:not(:disabled){color:var(--blue-6)}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchOverlay .replace-options .replace-buttons .btn-replace-all{font-size:13px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SearchOverlay .replace-options .replace-buttons .btn-replace-all{font-size:13px}}.SearchOverlay .replace-options .replace-buttons button:disabled{opacity:.5;cursor:default}.SearchOverlay .footer{display:flex;align-items:center;justify-content:space-between;color:var(--faded-text);margin-bottom:16px}.SearchOverlay .footer .spinner{height:25px!important;width:25px!important;margin:0}.SearchOverlay .footer .buttons{display:flex;flex-direction:row;align-self:flex-end;justify-content:space-evenly;margin-inline-start:auto;width:64px;height:28px}.SearchOverlay .footer .buttons .button{padding:0;border:none;background-color:transparent;width:28px;height:28px;border-radius:4px;display:flex;align-items:center;justify-content:center;cursor:pointer}:host(:not([data-tabbing=true])) .SearchOverlay .footer .buttons .button,html:not([data-tabbing=true]) .SearchOverlay .footer .buttons .button{outline:none}.SearchOverlay .footer .buttons .button svg{color:var(--gray-6)}.SearchOverlay .footer .buttons .button:hover{background-color:var(--blue-1)}.SearchOverlay .footer .buttons .arrow{width:18px;height:18px}.SearchOverlay.modular-ui .input-container[focus-within]{outline:none;border:1px solid var(--focus-border)}.SearchOverlay.modular-ui .input-container:focus-within{outline:none;border:1px solid var(--focus-border)}.SearchOverlay.modular-ui .input-container .search-panel-input{padding-inline-start:8px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchOverlay.modular-ui .input-container .search-panel-input{font-size:13px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SearchOverlay.modular-ui .input-container .search-panel-input{font-size:13px}}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SearchPanel/SearchPanel.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.search-panel-container{z-index:65;flex-direction:column;background-color:var(--panel-background);display:flex;flex-direction:row;position:relative;overflow:hidden}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .search-panel-container{z-index:95}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .search-panel-container{z-index:95}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .search-panel-container{border-inline-start:1px solid var(--side-panel-border)}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .search-panel-container{border-inline-start:1px solid var(--side-panel-border)}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .search-panel-container{position:fixed;inset-block-start:0;inset-inline-end:0;height:100%;width:100%}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .search-panel-container{position:fixed;inset-block-start:0;inset-inline-end:0;height:100%;width:100%}}.SearchPanel{padding:16px 8px 0 16px;display:flex;flex-direction:column;height:100%}.SearchPanel .ListSeparator:first-child{margin-top:0}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.SearchPanel .ReactVirtualized__Grid__innerScrollContainer{max-width:1000px!important}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchPanel{width:100%;min-width:100%;padding-top:0}.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchPanel .close-container{display:flex;align-items:center;justify-content:flex-end;height:28px;margin-bottom:8px;width:100%;padding-inline-end:12px}.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchPanel .close-container .close-icon-container{padding:0;border:none;background-color:transparent;z-index:3;cursor:pointer}:host(:not([data-tabbing=true])) .App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchPanel .close-container .close-icon-container,html:not([data-tabbing=true]) .App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchPanel .close-container .close-icon-container{outline:none}.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchPanel .close-container .close-icon-container .close-icon{width:24px;height:24px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SearchPanel{width:100%;min-width:100%;padding-top:0}.App.is-web-component:not(.is-in-desktop-only-mode) .SearchPanel .close-container{display:flex;align-items:center;justify-content:flex-end;height:28px;margin-bottom:8px;width:100%;padding-inline-end:12px}.App.is-web-component:not(.is-in-desktop-only-mode) .SearchPanel .close-container .close-icon-container{padding:0;border:none;background-color:transparent;z-index:3;cursor:pointer}:host(:not([data-tabbing=true])) .App.is-web-component:not(.is-in-desktop-only-mode) .SearchPanel .close-container .close-icon-container,html:not([data-tabbing=true]) .App.is-web-component:not(.is-in-desktop-only-mode) .SearchPanel .close-container .close-icon-container{outline:none}.App.is-web-component:not(.is-in-desktop-only-mode) .SearchPanel .close-container .close-icon-container .close-icon{width:24px;height:24px}}.SearchPanel .results{overflow-y:auto;overflow-y:overlay;flex:1}.SearchPanel .results.wild-card-visible{margin-top:110px!important}.SearchPanel .results .ReactVirtualized__List{overflow:overlay!important;padding-inline-end:8px;width:auto!important}.SearchPanel .results .ReactVirtualized__List:focus{outline:none}.SearchPanel .results .ReactVirtualized__List .ReactVirtualized__Grid__innerScrollContainer{max-width:unset!important}.SearchPanel .loader-wrapper{display:flex;padding:10px;justify-content:center}.SearchPanel .info{padding:15px 0}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SearchResult/SearchResult.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.SearchResult{background-color:transparent;border:1px solid transparent;display:block;width:calc(100% - 4px);text-align:start;cursor:pointer;border-radius:4px;box-shadow:0 0 3px 0 var(--box-shadow);padding:10px 12px;margin-inline-start:2px;margin-bottom:8px;background:var(--component-background);word-break:break-all}:host(:not([data-tabbing=true])) .SearchResult,html:not([data-tabbing=true]) .SearchResult{outline:none}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SearchResult{font-size:13px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SearchResult{font-size:13px}}.SearchResult .search-value{background:var(--yellow-1);word-break:break-all}.SearchResult.modular-ui.selected,.SearchResult.modular-ui:hover{border:1px solid var(--focus-border)}.SearchResult.modular-ui.selected{background-color:var(--faded-component-background);box-shadow:none}.SearchResult.modular-ui.focus-visible,.SearchResult.modular-ui:focus-visible{outline:var(--focus-visible-outline)}.SearchResult.modular-ui .search-value{font-weight:700;color:var(--blue-5);background:none}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./src/components/SearchOverlay/SearchOptionsFlyout.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SearchOverlay/SearchOptionsFlyout.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/SearchOverlay/SearchOverlay.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_SearchOverlay_SearchOverlay});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),core=__webpack_require__("./src/core/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),lodash_debounce=__webpack_require__("./node_modules/lodash.debounce/index.js"),lodash_debounce_default=__webpack_require__.n(lodash_debounce),throttle=__webpack_require__("./node_modules/lodash/throttle.js"),throttle_default=__webpack_require__.n(throttle),es=__webpack_require__("./node_modules/react-redux/es/index.js"),actions=__webpack_require__("./src/redux/actions/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),dataElement=__webpack_require__("./src/constants/dataElement.js"),Icon=__webpack_require__("./src/components/Icon/index.js"),Button=__webpack_require__("./src/components/Button/index.js"),ToggleElementButton=__webpack_require__("./src/components/ModularComponents/ToggleElementButton/index.js"),Spinner=__webpack_require__("./src/components/Spinner/index.js"),Choice=__webpack_require__("./src/components/Choice/Choice.js");__webpack_require__("./src/components/SearchOverlay/SearchOptionsFlyout.scss");const SearchOptionsFlyout_SearchOptionsFlyout=({isPanelOpen,isCaseSensitive,isWholeWord,isWildcard,onCaseSensitiveSearchOptionChange,wholeWordSearchOptionOnChange,wildcardOptionOnChange})=>{const{t}=(0,useTranslation.B)(),dispatch=(0,es.wA)(),flyoutSelector=dataElement.A.SEARCH_OPTIONS_FLYOUT,currentFlyout=(0,es.d4)((state=>selectors.A.getFlyout(state,flyoutSelector)));return(0,react.useLayoutEffect)((()=>{const searchOptionsFlyout={dataElement:flyoutSelector,className:"SearchOptionsFlyout",items:[{type:"customElement",render:()=>(0,jsx_runtime.jsx)(Choice.A,{dataElement:dataElement.A.CASE_SENSITIVE_SEARCH_OPTION,id:"case-sensitive-option",checked:isCaseSensitive,onChange:onCaseSensitiveSearchOptionChange,label:t("option.searchPanel.caseSensitive"),tabIndex:isPanelOpen?0:-1})},{type:"customElement",render:()=>(0,jsx_runtime.jsx)(Choice.A,{dataElement:dataElement.A.WHOLE_WORD_SEARCH_OPTION,id:"whole-word-option",checked:isWholeWord,onChange:wholeWordSearchOptionOnChange,label:t("option.searchPanel.wholeWordOnly"),tabIndex:isPanelOpen?0:-1})},{type:"customElement",render:()=>(0,jsx_runtime.jsx)(Choice.A,{dataElement:dataElement.A.WILD_CARD_SEARCH_OPTION,id:"wildcard-option",checked:isWildcard,onChange:wildcardOptionOnChange,label:t("option.searchPanel.wildcard"),tabIndex:isPanelOpen?0:-1})}]};dispatch(currentFlyout?actions.A.updateFlyout(searchOptionsFlyout.dataElement,searchOptionsFlyout):actions.A.addFlyout(searchOptionsFlyout))}),[isCaseSensitive,isWholeWord,isWildcard,isPanelOpen,onCaseSensitiveSearchOptionChange,wholeWordSearchOptionOnChange,wildcardOptionOnChange]),null};SearchOptionsFlyout_SearchOptionsFlyout.propTypes={isCaseSensitive:prop_types_default().bool.isRequired,isWholeWord:prop_types_default().bool.isRequired,isWildcard:prop_types_default().bool.isRequired,isPanelOpen:prop_types_default().bool,onCaseSensitiveSearchOptionChange:prop_types_default().func.isRequired,wholeWordSearchOptionOnChange:prop_types_default().func.isRequired,wildcardOptionOnChange:prop_types_default().func.isRequired};const SearchOverlay_SearchOptionsFlyout=SearchOptionsFlyout_SearchOptionsFlyout;var getRootNode=__webpack_require__("./src/helpers/getRootNode.js"),officeEditor=__webpack_require__("./src/helpers/officeEditor.js");__webpack_require__("./src/components/SearchOverlay/SearchOverlay.scss"),__webpack_require__("./src/components/Button/Button.scss");const propTypes={isPanelOpen:prop_types_default().bool,isSearchOverlayDisabled:prop_types_default().bool,searchValue:prop_types_default().string,searchStatus:prop_types_default().oneOf(["SEARCH_NOT_INITIATED","SEARCH_IN_PROGRESS","SEARCH_DONE"]),isCaseSensitive:prop_types_default().bool,isWholeWord:prop_types_default().bool,isWildcard:prop_types_default().bool,searchResults:prop_types_default().arrayOf(prop_types_default().object),activeResultIndex:prop_types_default().number,setSearchValue:prop_types_default().func.isRequired,setCaseSensitive:prop_types_default().func.isRequired,setSearchStatus:prop_types_default().func.isRequired,setWholeWord:prop_types_default().func.isRequired,setWildcard:prop_types_default().func.isRequired,executeSearch:prop_types_default().func.isRequired,selectNextResult:prop_types_default().func,selectPreviousResult:prop_types_default().func,isProcessingSearchResults:prop_types_default().bool,activeDocumentViewerKey:prop_types_default().number};function SearchOverlay_SearchOverlay(props){const{t}=(0,useTranslation.B)(),{isSearchOverlayDisabled,searchResults,activeResultIndex,selectNextResult,selectPreviousResult,isProcessingSearchResults,activeDocumentViewerKey}=props,{searchValue,setSearchValue,executeSearch,replaceValue,nextResultValue,setReplaceValue}=props,{isCaseSensitive,setCaseSensitive,isWholeWord,setWholeWord,isWildcard,setWildcard,setSearchStatus,isSearchInProgress,setIsSearchInProgress}=props,{searchStatus,isPanelOpen}=props,[isReplaceBtnDisabled,setReplaceBtnDisabled]=(0,react.useState)(!0),[isReplaceAllBtnDisabled,setReplaceAllBtnDisabled]=(0,react.useState)(!0),[showReplaceSpinner,setShowReplaceSpinner]=(0,react.useState)(!1),[isReplacementRegexValid,setReplacementRegexValid]=(0,react.useState)(!0),[allowInitialSearch,setAllowInitialSearch]=(0,react.useState)(!1),[isReplaceInputActive,setisReplaceInputActive]=(0,react.useState)(!1),isSearchAndReplaceDisabled=(0,es.d4)((state=>selectors.A.isElementDisabled(state,"searchAndReplace"))),customizableUI=(0,es.d4)((state=>selectors.A.getFeatureFlags(state)?.customizableUI)),searchTextInputRef=(0,react.useRef)();(0,react.useEffect)((()=>{try{new RegExp("(?<!</?[^>]*|&[^;]*)")}catch(error){setReplacementRegexValid(!1)}}),[]),(0,react.useEffect)((()=>{numberOfResultsFound>0&&setSearchStatus("SEARCH_DONE")}),[searchResults]),(0,react.useEffect)((()=>{searchTextInputRef.current&&isPanelOpen&&setTimeout((()=>{searchTextInputRef.current.focus(),setAllowInitialSearch(!0)}),300),isSearchAndReplaceDisabled||isReplacementRegexValid||!isPanelOpen||console.warn("Search and Replace is not supported in this browser")}),[isPanelOpen,isCaseSensitive]),(0,react.useEffect)((()=>{searchValue&&searchValue.length>0?allowInitialSearch&&executeSearch(searchValue,{caseSensitive:isCaseSensitive,wholeWord:isWholeWord,wildcard:isWildcard}):clearSearchResult()}),[isCaseSensitive,isWholeWord,isWildcard,activeDocumentViewerKey]),(0,react.useEffect)((()=>(core.A.addEventListener("pagesUpdated",onPagesUpdated),()=>{core.A.removeEventListener("pagesUpdated",onPagesUpdated)})));const onPagesUpdated=()=>{search(searchValue)},search=async searchValue=>{searchValue&&searchValue.length>0?(setIsSearchInProgress(!0),setSearchStatus("SEARCH_IN_PROGRESS"),(0,officeEditor.pb)()&&await core.A.getDocument().getOfficeEditor().updateSearchData(),executeSearch(searchValue,{caseSensitive:isCaseSensitive,wholeWord:isWholeWord,wildcard:isWildcard})):clearSearchResult()},debouncedSearch=(0,react.useCallback)(lodash_debounce_default()(search,300),[isCaseSensitive,isWholeWord,isWildcard]),throttleSearch=(0,react.useCallback)(throttle_default()(search,300),[isCaseSensitive,isWholeWord,isWildcard]);(0,react.useEffect)((()=>{const onOfficeDocumentEdited=()=>{searchValue&&searchValue.length>0&&throttleSearch(searchValue)};return core.A.getDocument()?.addEventListener("officeDocumentEdited",onOfficeDocumentEdited),()=>{core.A.getDocument()?.removeEventListener("officeDocumentEdited",onOfficeDocumentEdited)}}),[searchValue]);function clearSearchResult(){core.A.clearSearchResults(),setSearchValue(""),setSearchStatus("SEARCH_NOT_INITIATED"),setReplaceValue(""),setReplaceBtnDisabled(!0),setReplaceAllBtnDisabled(!0)}const caseSensitiveSearchOptionOnChange=(0,react.useCallback)((function caseSensitiveSearchOptionOnChangeCallback(event){const isChecked=event.target.checked;setCaseSensitive(isChecked)}),[]),wholeWordSearchOptionOnChange=(0,react.useCallback)((function wholeWordSearchOptionOnChangeCallback(event){const isChecked=event.target.checked;setWholeWord(isChecked)}),[]),wildcardOptionOnChange=(0,react.useCallback)((function wildcardOptionOnChangeCallback(event){const isChecked=event.target.checked;setWildcard(isChecked)}),[]),nextButtonOnClick=(0,react.useCallback)((function nextButtonOnClickCallback(){selectNextResult&&selectNextResult(searchResults,activeResultIndex)}),[selectNextResult,searchResults,activeResultIndex]),previousButtonOnClick=(0,react.useCallback)((function previousButtonOnClickCallback(){selectPreviousResult&&selectPreviousResult(searchResults,activeResultIndex)}),[selectPreviousResult,searchResults,activeResultIndex]),searchAndReplaceAll=(0,react.useCallback)((async function searchAndReplaceAllCallback(){isReplaceAllBtnDisabled&&nextResultValue||(setShowReplaceSpinner(!0),await(0,getRootNode.Iv)().instance.Core.ContentEdit.searchAndReplaceText({documentViewer:(0,getRootNode.Iv)().instance.Core.documentViewer,searchResults:core.A.getPageSearchResults(),replaceWith:replaceValue}),setShowReplaceSpinner(!1))}),[replaceValue]),searchAndReplaceOne=(0,react.useCallback)((async function searchAndReplaceOneCallback(){isReplaceBtnDisabled&&nextResultValue||(setShowReplaceSpinner(!0),await(0,getRootNode.Iv)().instance.Core.ContentEdit.searchAndReplaceText({documentViewer:(0,getRootNode.Iv)().instance.Core.documentViewer,replaceWith:replaceValue,searchResults:[core.A.getActiveSearchResult()]}),setShowReplaceSpinner(!1))}),[replaceValue,nextResultValue,isReplaceBtnDisabled]),dispatch=(0,es.wA)();if(isSearchOverlayDisabled)return null;const numberOfResultsFound=searchResults?searchResults.length:0,isSearchDoneAndNotProcessingResults="SEARCH_DONE"===searchStatus&&!isProcessingSearchResults,showSpinner=!isSearchDoneAndNotProcessingResults||isSearchInProgress?(0,jsx_runtime.jsx)(Spinner.A,{}):null,shouldShowReplaceToggleButton=!isSearchAndReplaceDisabled&&isReplacementRegexValid,shouldShowReplaceInput=shouldShowReplaceToggleButton&&isReplaceInputActive,shouldShowDotOnFilterButton=isCaseSensitive||isWholeWord||isWildcard;return(0,jsx_runtime.jsxs)("div",{className:classnames_default()({SearchOverlay:!0,"modular-ui":customizableUI}),children:[(0,jsx_runtime.jsxs)("div",{className:"search-input-row",children:[(0,jsx_runtime.jsxs)("div",{className:"input-container",children:[customizableUI&&(0,jsx_runtime.jsx)(Icon.A,{glyph:"icon-header-search"}),(0,jsx_runtime.jsx)("input",{className:"search-panel-input",ref:searchTextInputRef,type:"text",autoComplete:"off",onChange:event=>{setSearchValue(event.target.value),debouncedSearch(event.target.value),event.target.value&&replaceValue&&(setReplaceBtnDisabled(!1),setReplaceAllBtnDisabled(!1))},value:searchValue,placeholder:customizableUI?"":t("message.searchDocumentPlaceholder"),"aria-label":t("message.searchDocumentPlaceholder"),id:"SearchPanel__input",tabIndex:isPanelOpen?0:-1}),void 0!==searchValue&&searchValue.length>0&&(0,jsx_runtime.jsx)(Button.A,{className:"clearSearch-button",img:"icon-close",onClick:clearSearchResult,title:t("message.clearSearchResults"),ariaLabel:t("message.clearSearchResults"),onClickAnnouncement:t("message.searchResultsCleared")})]}),(0,jsx_runtime.jsxs)("div",{className:"search-option-buttons",children:[(0,jsx_runtime.jsx)(ToggleElementButton.A,{dataElement:"searchOptionsButton",title:t("message.toggleSearchOptions"),ariaLabel:t("message.toggleSearchOptions"),tabIndex:isPanelOpen?0:-1,img:shouldShowDotOnFilterButton?"ic-filter-with-dot":"ic-filter-alt",className:"search-options-button",toggleElement:dataElement.A.SEARCH_OPTIONS_FLYOUT}),shouldShowReplaceToggleButton?(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{setisReplaceInputActive(!isReplaceInputActive)},title:t("message.toggleReplaceInput"),ariaLabel:t("message.toggleReplaceInput"),tabIndex:isPanelOpen?0:-1,img:"ic_replace",className:"search-options-button",isActive:isReplaceInputActive}):null]})]}),shouldShowReplaceInput&&(0,jsx_runtime.jsxs)("div",{"data-element":"searchAndReplace",className:"replace-options",children:[(0,jsx_runtime.jsxs)("div",{className:"input-container with-replace-icon",children:[(0,jsx_runtime.jsx)(Icon.A,{disabled:!1,glyph:"ic_replace",className:"replace-icon"}),(0,jsx_runtime.jsx)("input",{type:"text","aria-label":t("option.searchPanel.replace"),onChange:event=>{setReplaceValue(event.target.value),event.target.value&&searchValue&&(setReplaceBtnDisabled(!1),setReplaceAllBtnDisabled(!1))},value:replaceValue})]}),(0,jsx_runtime.jsxs)("div",{className:"replace-buttons",children:[showReplaceSpinner?(0,jsx_runtime.jsx)(Spinner.A,{width:25,height:25}):null,(0,jsx_runtime.jsx)("button",{className:"Button btn-replace-all",disabled:isReplaceAllBtnDisabled,"aria-label":t("option.searchPanel.replaceAll"),onClick:()=>{const title=t("option.searchPanel.replaceText"),confirmationWarning={message:t("option.searchPanel.confirmMessageReplaceAll"),title,confirmBtnText:t("option.searchPanel.confirm"),onConfirm:()=>{searchAndReplaceAll()}};dispatch(actions.A.showWarningMessage(confirmationWarning))},children:t("option.searchPanel.replaceAll")}),(0,jsx_runtime.jsx)("button",{className:"Button btn-replace",disabled:isReplaceBtnDisabled||!nextResultValue||!core.A.getActiveSearchResult(),"aria-label":t("option.searchPanel.replace"),onClick:()=>{const title=t("option.searchPanel.replaceText"),confirmationWarning={message:t("option.searchPanel.confirmMessageReplaceOne"),title,confirmBtnText:t("option.searchPanel.confirm"),onConfirm:()=>{searchAndReplaceOne()}};dispatch(actions.A.showWarningMessage(confirmationWarning))},children:t("option.searchPanel.replace")})]})]}),(0,jsx_runtime.jsx)(SearchOverlay_SearchOptionsFlyout,{isCaseSensitive,isWholeWord,isWildcard,isPanelOpen,onCaseSensitiveSearchOptionChange:caseSensitiveSearchOptionOnChange,wholeWordSearchOptionOnChange,wildcardOptionOnChange}),(0,jsx_runtime.jsx)("div",{className:"divider"}),(0,jsx_runtime.jsxs)("div",{className:"footer",children:["SEARCH_NOT_INITIATED"===searchStatus?null:showSpinner,(0,jsx_runtime.jsx)("p",{className:"no-margin","aria-live":"assertive",children:isSearchDoneAndNotProcessingResults&&!isSearchInProgress?`${numberOfResultsFound} ${t("message.numResultsFound")}`:void 0}),numberOfResultsFound>0&&(0,jsx_runtime.jsxs)("div",{className:"buttons",children:[(0,jsx_runtime.jsx)("button",{className:"button",onClick:previousButtonOnClick,"aria-label":t("action.prevResult"),children:(0,jsx_runtime.jsx)(Icon.A,{className:"arrow",glyph:"icon-chevron-left"})}),(0,jsx_runtime.jsx)("button",{className:"button",onClick:nextButtonOnClick,"aria-label":t("action.nextResult"),children:(0,jsx_runtime.jsx)(Icon.A,{className:"arrow",glyph:"icon-chevron-right"})})]})]})]})}SearchOverlay_SearchOverlay.propTypes=propTypes;const components_SearchOverlay_SearchOverlay=SearchOverlay_SearchOverlay;SearchOverlay_SearchOverlay.__docgenInfo={description:"",methods:[],displayName:"SearchOverlay",props:{isPanelOpen:{description:"",type:{name:"bool"},required:!1},isSearchOverlayDisabled:{description:"",type:{name:"bool"},required:!1},searchValue:{description:"",type:{name:"string"},required:!1},searchStatus:{description:"",type:{name:"enum",value:[{value:"'SEARCH_NOT_INITIATED'",computed:!1},{value:"'SEARCH_IN_PROGRESS'",computed:!1},{value:"'SEARCH_DONE'",computed:!1}]},required:!1},isCaseSensitive:{description:"",type:{name:"bool"},required:!1},isWholeWord:{description:"",type:{name:"bool"},required:!1},isWildcard:{description:"",type:{name:"bool"},required:!1},searchResults:{description:"",type:{name:"arrayOf",value:{name:"object"}},required:!1},activeResultIndex:{description:"",type:{name:"number"},required:!1},setSearchValue:{description:"",type:{name:"func"},required:!0},setCaseSensitive:{description:"",type:{name:"func"},required:!0},setSearchStatus:{description:"",type:{name:"func"},required:!0},setWholeWord:{description:"",type:{name:"func"},required:!0},setWildcard:{description:"",type:{name:"func"},required:!0},executeSearch:{description:"",type:{name:"func"},required:!0},selectNextResult:{description:"",type:{name:"func"},required:!1},selectPreviousResult:{description:"",type:{name:"func"},required:!1},isProcessingSearchResults:{description:"",type:{name:"bool"},required:!1},activeDocumentViewerKey:{description:"",type:{name:"number"},required:!1}}}},"./src/components/SearchOverlay/SearchOverlay.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SearchOverlay/SearchOverlay.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/SearchPanel/SearchPanel.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SearchPanel/SearchPanel.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/SearchPanel/SearchPanelContainer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>SearchPanel_SearchPanelContainer});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),core=__webpack_require__("./src/core/index.js"),actions=__webpack_require__("./src/redux/actions/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js"),getDeviceSize=__webpack_require__("./src/helpers/getDeviceSize.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),index_esm=__webpack_require__("./node_modules/react-measure/dist/index.esm.js"),List=(__webpack_require__("./src/components/SearchResult/SearchResult.scss"),__webpack_require__("./node_modules/react-virtualized/dist/commonjs/List/index.js")),CellMeasurer=__webpack_require__("./node_modules/react-virtualized/dist/commonjs/CellMeasurer/index.js"),ListSeparator=__webpack_require__("./src/components/ListSeparator/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames);const SearchResultListSeparatorPropTypes={currentResultIndex:prop_types_default().number.isRequired,searchResults:prop_types_default().arrayOf(prop_types_default().object).isRequired,t:prop_types_default().func.isRequired,pageLabels:prop_types_default().arrayOf(prop_types_default().any).isRequired,isProcessingSearchResults:prop_types_default().bool};function SearchResultListSeparator(props){const{currentResultIndex,searchResults,t,pageLabels}=props,previousIndex=0===currentResultIndex?currentResultIndex:currentResultIndex-1,currentListItem=searchResults[currentResultIndex],previousListItem=searchResults[previousIndex],isFirstListItem=previousListItem===currentListItem,isInDifferentPage=previousListItem.pageNum!==currentListItem.pageNum;if(isFirstListItem||isInDifferentPage){const listSeparatorText=`${t("option.shared.page")} ${pageLabels[currentListItem.pageNum-1]}`;return(0,jsx_runtime.jsx)("div",{role:"cell",children:(0,jsx_runtime.jsx)(ListSeparator.A,{children:listSeparatorText})})}return null}SearchResultListSeparator.propTypes=SearchResultListSeparatorPropTypes;const SearchResultListItemPropTypes={result:prop_types_default().object.isRequired,currentResultIndex:prop_types_default().number.isRequired,activeResultIndex:prop_types_default().number.isRequired,onSearchResultClick:prop_types_default().func,activeDocumentViewerKey:prop_types_default().number};function SearchResultListItem(props){const[customizableUI]=(0,es.d4)((state=>[state.featureFlags.customizableUI])),{result,currentResultIndex,activeResultIndex,onSearchResultClick,activeDocumentViewerKey}=props,{ambientStr,resultStrStart,resultStrEnd,resultStr}=result,textBeforeSearchValue=ambientStr.slice(0,resultStrStart),searchValue=""===ambientStr?resultStr:ambientStr.slice(resultStrStart,resultStrEnd),textAfterSearchValue=ambientStr.slice(resultStrEnd);return(0,jsx_runtime.jsxs)("button",{role:"cell",className:classnames_default()({SearchResult:!0,selected:currentResultIndex===activeResultIndex,"modular-ui":customizableUI}),onClick:()=>{onSearchResultClick&&onSearchResultClick(currentResultIndex,result,activeDocumentViewerKey)},"aria-current":currentResultIndex===activeResultIndex,children:[textBeforeSearchValue,(0,jsx_runtime.jsx)("span",{className:"search-value",children:searchValue}),textAfterSearchValue]})}SearchResultListItem.propTypes=SearchResultListItemPropTypes;const SearchResultPropTypes={width:prop_types_default().number,height:prop_types_default().number,activeResultIndex:prop_types_default().number,searchStatus:prop_types_default().oneOf(["SEARCH_NOT_INITIATED","SEARCH_IN_PROGRESS","SEARCH_DONE"]),searchResults:prop_types_default().arrayOf(prop_types_default().object),t:prop_types_default().func.isRequired,onClickResult:prop_types_default().func,pageLabels:prop_types_default().arrayOf(prop_types_default().any),activeDocumentViewerKey:prop_types_default().number};function SearchResult_SearchResult(props){const{height,searchStatus,searchResults,activeResultIndex,t,onClickResult,pageLabels,isProcessingSearchResults,isSearchInProgress,activeDocumentViewerKey}=props,cellMeasureCache=react.useMemo((()=>new CellMeasurer.jS({defaultHeight:50,fixedWidth:!0})),[]),listRef=react.useRef(null),[listSize,setListSize]=react.useState(0);0===searchResults.length&&cellMeasureCache.clearAll(),searchResults.length&&searchResults.length!==listSize&&(setListSize(searchResults.length),cellMeasureCache.clearAll());const rowRenderer=react.useCallback((function rowRendererCallback(rendererOptions){const{index,key,parent,style}=rendererOptions,result=searchResults[index];return(0,jsx_runtime.jsx)(CellMeasurer.Ay,{cache:cellMeasureCache,columnIndex:0,parent,rowIndex:index,children:({registerChild})=>(0,jsx_runtime.jsxs)("div",{role:"row",ref:registerChild,style,children:[(0,jsx_runtime.jsx)(SearchResultListSeparator,{currentResultIndex:index,searchResults,pageLabels,t}),(0,jsx_runtime.jsx)(SearchResultListItem,{result,currentResultIndex:index,activeResultIndex,onSearchResultClick:onClickResult,activeDocumentViewerKey})]})},key)}),[cellMeasureCache,searchResults,activeResultIndex,t,pageLabels]);return react.useEffect((()=>{listRef&&listRef.current?.scrollToRow(activeResultIndex)}),[activeResultIndex]),null==height?null:"SEARCH_DONE"!==searchStatus||0!==searchResults.length||isProcessingSearchResults?(0,jsx_runtime.jsx)(List.Ay,{width:200,height,tabIndex:-1,overscanRowCount:10,rowCount:searchResults.length,deferredMeasurementCache:cellMeasureCache,rowHeight:cellMeasureCache.rowHeight,rowRenderer,ref:listRef,scrollToIndex:activeResultIndex-1}):isSearchInProgress?null:(0,jsx_runtime.jsx)("div",{className:"info",children:(0,jsx_runtime.jsx)("p",{className:"no-margin",children:t("message.noResults")})})}function SearchResultWithContentRectHOC(props){const{measureRef,contentRect,...rest}=props,{height}=contentRect.bounds;return(0,jsx_runtime.jsx)("div",{className:"results",ref:measureRef,children:(0,jsx_runtime.jsx)(SearchResult_SearchResult,{height,...rest})})}SearchResult_SearchResult.propTypes=SearchResultPropTypes,SearchResultWithContentRectHOC.propTypes={contentRect:prop_types_default().object,measureRef:prop_types_default().oneOfType([prop_types_default().func,prop_types_default().shape({current:prop_types_default().any})])};const SearchResultWithContentRectHOCAndBounds=(0,index_esm.m)("bounds")(SearchResultWithContentRectHOC),SearchResultsContainer=props=>(0,jsx_runtime.jsx)(SearchResultWithContentRectHOCAndBounds,{...props}),components_SearchResult_SearchResult=SearchResultsContainer;SearchResultsContainer.__docgenInfo={description:"",methods:[],displayName:"SearchResultsContainer"};const components_SearchResult=components_SearchResult_SearchResult;var SearchOverlay=__webpack_require__("./src/components/SearchOverlay/SearchOverlay.js"),search=__webpack_require__("./src/helpers/search.js"),apis_searchTextFull=__webpack_require__("./src/apis/searchTextFull.js");function SearchOverlayContainer(props){const dispatch=(0,es.wA)(),store=(0,es.Pj)();return(0,jsx_runtime.jsx)(SearchOverlay.A,{executeSearch:(searchValue,options={})=>{!function executeSearch(searchValue,options,store){const searchOptions={regex:!1,...options};if(null!=searchValue){const overrideSearchExecution=(0,search.dp)();overrideSearchExecution?overrideSearchExecution(searchValue,searchOptions):(0,apis_searchTextFull.A)(store)(searchValue,searchOptions,!1)}}(searchValue,options,store)},selectNextResult:(searchResults=[],activeResultIndex)=>{!function selectNextResult(searchResults=[],activeResultIndex,dispatch){if(searchResults.length>0){const nextResultIndex=activeResultIndex===searchResults.length-1?0:activeResultIndex+1;if(core.A.setActiveSearchResult(searchResults[nextResultIndex]),dispatch){const nextIndex=nextResultIndex>0?nextResultIndex-1:0;dispatch(actions.A.setNextResultValue(searchResults[nextResultIndex],nextIndex))}}}(searchResults,activeResultIndex,dispatch)},selectPreviousResult:(searchResults=[],activeResultIndex)=>{!function selectPreviousResult(searchResults=[],activeResultIndex,dispatch){if(searchResults.length>0){const prevResultIndex=activeResultIndex<=0?searchResults.length-1:activeResultIndex-1;core.A.setActiveSearchResult(searchResults[prevResultIndex]),dispatch&&dispatch(actions.A.setNextResultValue(searchResults[prevResultIndex]))}}(searchResults,activeResultIndex,dispatch)},...props})}const SearchOverlay_SearchOverlayContainer=SearchOverlayContainer;SearchOverlayContainer.__docgenInfo={description:"",methods:[],displayName:"SearchOverlayContainer"};var constants_dataElement=__webpack_require__("./src/constants/dataElement.js");const mapDispatchToProps={closeElements:actions.A.closeElements,setSearchValue:actions.A.setSearchValue,setReplaceValue:actions.A.setReplaceValue,setCaseSensitive:actions.A.setCaseSensitive,setWholeWord:actions.A.setWholeWord,setWildcard:actions.A.setWildcard};const ConnectedSearchOverlayRedux=(0,es.Ng)((state=>({isSearchOverlayDisabled:selectors.A.isElementDisabled(state,constants_dataElement.A.SEARCH_OVERLAY),searchValue:selectors.A.getSearchValue(state),replaceValue:selectors.A.getReplaceValue(state),nextResultValue:selectors.A.getNextResultValue(state),isCaseSensitive:selectors.A.isCaseSensitive(state),isWholeWord:selectors.A.isWholeWord(state),isWildcard:selectors.A.isWildcard(state),isProcessingSearchResults:selectors.A.isProcessingSearchResults(state)})),mapDispatchToProps)((function SearchOverlayRedux(props){return(0,jsx_runtime.jsx)(SearchOverlay_SearchOverlayContainer,{...props})})),connectedComponent=props=>(0,jsx_runtime.jsx)(ConnectedSearchOverlayRedux,{...props}),SearchOverlay_SearchOverlayRedux=connectedComponent;connectedComponent.__docgenInfo={description:"",methods:[],displayName:"connectedComponent"};const components_SearchOverlay=SearchOverlay_SearchOverlayRedux;var Icon=__webpack_require__("./src/components/Icon/index.js"),getClassName=__webpack_require__("./src/helpers/getClassName.js"),DataElementWrapper=__webpack_require__("./src/components/DataElementWrapper/index.js"),officeEditor=__webpack_require__("./src/helpers/officeEditor.js"),getDocument=__webpack_require__("./src/core/getDocument.js");__webpack_require__("./src/components/SearchPanel/SearchPanel.scss");const hooks_useSearch=function useSearch(activeDocumentViewerKey){const[searchResults,setSearchResults]=react.useState([]),[activeSearchResult,setActiveSearchResult]=react.useState(),[activeSearchResultIndex,setActiveSearchResultIndex]=react.useState(0),[searchStatus,setSearchStatus]=react.useState("SEARCH_NOT_INITIATED"),dispatch=(0,es.wA)(),documentViewersCount=core.A.getDocumentViewers().length;return react.useEffect((()=>{const coreSearchResults=core.A.getDocumentViewer(activeDocumentViewerKey).getPageSearchResults()||[];if(coreSearchResults.length>0){const activeSearchResult=core.A.getActiveSearchResult();if(activeSearchResult){const newActiveSearchResultIndex=coreSearchResults.findIndex((searchResult=>core.A.isSearchResultEqual(searchResult,activeSearchResult)));setSearchResults(coreSearchResults),newActiveSearchResultIndex>=0&&(setActiveSearchResult(coreSearchResults[newActiveSearchResultIndex]),setActiveSearchResultIndex(newActiveSearchResultIndex))}else setSearchResults(coreSearchResults),setActiveSearchResult(coreSearchResults[0]),setActiveSearchResultIndex(0)}}),[]),react.useEffect((()=>{const activeDocumentViewer=core.A.getDocumentViewer(activeDocumentViewerKey);function activeSearchResultChanged(newActiveSearchResult){const newActiveSearchResultIndex=(activeDocumentViewer.getPageSearchResults()||[]).findIndex((searchResult=>core.A.isSearchResultEqual(searchResult,newActiveSearchResult)));newActiveSearchResultIndex>=0&&(setActiveSearchResult(newActiveSearchResult),setActiveSearchResultIndex(newActiveSearchResultIndex))}function searchResultsChanged(newSearchResults=[]){setSearchResults(newSearchResults),newSearchResults&&0===newSearchResults.length&&(setActiveSearchResult(void 0),setActiveSearchResultIndex(-1))}function searchInProgressEventHandler(isSearching){if(null==isSearching)setSearchStatus("SEARCH_NOT_INITIATED");else if(isSearching)setSearchStatus("SEARCH_IN_PROGRESS");else{const defaultActiveSearchResult=activeDocumentViewer.getActiveSearchResult();if(defaultActiveSearchResult){setActiveSearchResult(defaultActiveSearchResult);const newActiveSearchResultIndex=(activeDocumentViewer.getPageSearchResults()||[]).findIndex((searchResult=>core.A.isSearchResultEqual(searchResult,defaultActiveSearchResult)));setActiveSearchResultIndex(newActiveSearchResultIndex),dispatch(actions.A.setNextResultValue(defaultActiveSearchResult))}setSearchStatus("SEARCH_DONE")}}const documentViewers=core.A.getDocumentViewers();return documentViewers.forEach((documentViewer=>{documentViewer.addEventListener("activeSearchResultChanged",activeSearchResultChanged),documentViewer.addEventListener("searchResultsChanged",searchResultsChanged),documentViewer.addEventListener("searchInProgress",searchInProgressEventHandler)})),()=>{documentViewers.forEach((documentViewer=>{documentViewer.removeEventListener("activeSearchResultChanged",activeSearchResultChanged),documentViewer.removeEventListener("searchResultsChanged",searchResultsChanged),documentViewer.removeEventListener("searchInProgress",searchInProgressEventHandler)}))}}),[setActiveSearchResult,setActiveSearchResultIndex,setSearchStatus,dispatch,documentViewersCount,activeDocumentViewerKey]),{searchStatus,searchResults,activeSearchResult,activeSearchResultIndex,setSearchStatus}},propTypes={isOpen:prop_types_default().bool,isMobile:prop_types_default().bool,pageLabels:prop_types_default().array,currentWidth:prop_types_default().number,closeSearchPanel:prop_types_default().func,setActiveResult:prop_types_default().func,isInDesktopOnlyMode:prop_types_default().bool,isProcessingSearchResults:prop_types_default().bool,activeDocumentViewerKey:prop_types_default().number,isCustomPanel:prop_types_default().bool};function noop(){}function SearchPanel_SearchPanel(props){const{isOpen,currentWidth,pageLabels,closeSearchPanel=noop,setActiveResult=noop,setNextResultValue=noop,isMobile=!1,isInDesktopOnlyMode,isProcessingSearchResults,activeDocumentViewerKey,dataElement="searchPanel",isCustomPanel=!1}=props,{t}=(0,useTranslation.B)(),{searchStatus,searchResults,activeSearchResultIndex,setSearchStatus}=hooks_useSearch(activeDocumentViewerKey),onCloseButtonClick=react.useCallback((function onCloseButtonClick(){closeSearchPanel&&closeSearchPanel()}),[closeSearchPanel]),onClickResult=react.useCallback((function onClickResult(resultIndex,result,activeDocumentViewerKey){setActiveResult(result,activeDocumentViewerKey),!isInDesktopOnlyMode&&isMobile&&closeSearchPanel(),setNextResultValue(result)}),[closeSearchPanel,isMobile]),[isSearchInProgress,setIsSearchInProgress]=react.useState(!1),searchEventListener=()=>{setIsSearchInProgress(!1)},adjustSpreadsheetTableWidth=isUnmounting=>{if((0,officeEditor.NG)()){const editorWrapper=document.getElementById("editorWrapper");if(isUnmounting)editorWrapper.style.removeProperty("width");else{const newWidth=window.innerWidth-currentWidth+"px";editorWrapper.style.width=newWidth}(0,getDocument.A)().getSpreadsheetEditorDocument().getEditor().onSizeChanged()}};react.useEffect((()=>{adjustSpreadsheetTableWidth()}),[currentWidth]),react.useEffect((()=>{adjustSpreadsheetTableWidth(),(0,search.us)(searchEventListener)}),[]),react.useEffect((()=>()=>{adjustSpreadsheetTableWidth(!0),(0,search.pG)(searchEventListener)}),[]);const className=(0,getClassName.A)("Panel SearchPanel",{isOpen});let style={};return isCustomPanel||!isInDesktopOnlyMode&&isMobile||(style={width:`${currentWidth}px`,minWidth:`${currentWidth}px`}),(0,jsx_runtime.jsxs)(DataElementWrapper.A,{className,dataElement,style,children:[!isInDesktopOnlyMode&&isMobile&&(0,jsx_runtime.jsx)("div",{className:"close-container",children:(0,jsx_runtime.jsx)("button",{className:"close-icon-container",onClick:onCloseButtonClick,children:(0,jsx_runtime.jsx)(Icon.A,{glyph:"ic_close_black_24px",className:"close-icon"})})}),(0,jsx_runtime.jsx)(components_SearchOverlay,{searchStatus,setSearchStatus,searchResults,activeResultIndex:activeSearchResultIndex,isPanelOpen:isOpen,isSearchInProgress,setIsSearchInProgress,activeDocumentViewerKey}),(0,jsx_runtime.jsx)(components_SearchResult,{t,searchStatus,searchResults,activeResultIndex:activeSearchResultIndex,onClickResult,pageLabels,isProcessingSearchResults,isSearchInProgress,activeDocumentViewerKey})]})}SearchPanel_SearchPanel.propTypes=propTypes;const components_SearchPanel_SearchPanel=SearchPanel_SearchPanel;SearchPanel_SearchPanel.__docgenInfo={description:"",methods:[],displayName:"SearchPanel",props:{isOpen:{description:"",type:{name:"bool"},required:!1},isMobile:{description:"",type:{name:"bool"},required:!1},pageLabels:{description:"",type:{name:"array"},required:!1},currentWidth:{description:"",type:{name:"number"},required:!1},closeSearchPanel:{description:"",type:{name:"func"},required:!1},setActiveResult:{description:"",type:{name:"func"},required:!1},isInDesktopOnlyMode:{description:"",type:{name:"bool"},required:!1},isProcessingSearchResults:{description:"",type:{name:"bool"},required:!1},activeDocumentViewerKey:{description:"",type:{name:"number"},required:!1},isCustomPanel:{description:"",type:{name:"bool"},required:!1}}};var panel=__webpack_require__("./src/constants/panel.js");function SearchPanelContainer(props){const{dataElement=constants_dataElement.A.SEARCH_PANEL,parentDataElement}=props,isMobile=(0,getDeviceSize.IS)(),[isOpen,pageLabels,shouldClearSearchPanelOnClose,isInDesktopOnlyMode,isProcessingSearchResults,activeDocumentViewerKey]=(0,es.d4)((state=>[selectors.A.isElementOpen(state,dataElement),selectors.A.getPageLabels(state),selectors.A.shouldClearSearchPanelOnClose(state),selectors.A.isInDesktopOnlyMode(state),selectors.A.isProcessingSearchResults(state),selectors.A.getActiveDocumentViewerKey(state)]),es.bN);let currentWidth=(0,es.d4)((state=>parentDataElement||dataElement!==constants_dataElement.A.SEARCH_PANEL?selectors.A.getPanelWidth(state,parentDataElement||dataElement):selectors.A.getSearchPanelWidth(state)));const dispatch=(0,es.wA)(),closeSearchPanel=react.useCallback((function closeSearchPanel(){dispatch(actions.A.closeElements([dataElement]))}),[dispatch]),clearSearchInputValue=react.useCallback((function clearSearchInputValue(){dispatch(actions.A.setSearchValue(""))}),[dispatch]),setNextResultValue=react.useCallback((function setNextResultValue(searchResults){dispatch(actions.A.setNextResultValue(searchResults))}),[dispatch]),setActiveResult=react.useCallback((function setActiveResult(result,activeDocumentViewerKey){if(activeDocumentViewerKey){return core.A.getDocumentViewer(activeDocumentViewerKey).setActiveSearchResult(result)}}),[]);react.useEffect((function clearSearchResult(){!isInDesktopOnlyMode&&isMobile||!isOpen&&shouldClearSearchPanelOnClose&&(core.A.clearSearchResults(),clearSearchInputValue())}),[isMobile,isOpen,shouldClearSearchPanelOnClose,isInDesktopOnlyMode]),react.useEffect((()=>()=>{!isInDesktopOnlyMode&&isMobile||shouldClearSearchPanelOnClose&&(core.A.clearSearchResults(),clearSearchInputValue())}),[isMobile,shouldClearSearchPanelOnClose,isInDesktopOnlyMode]),dataElement!==constants_dataElement.A.SEARCH_PANEL&&(currentWidth-=16,currentWidth-=panel.Yj);const combinedProps={...props,isOpen,currentWidth,pageLabels,closeSearchPanel,setActiveResult,setNextResultValue,isMobile,isInDesktopOnlyMode,isProcessingSearchResults,activeDocumentViewerKey};return(0,jsx_runtime.jsx)(components_SearchPanel_SearchPanel,{...combinedProps})}const SearchPanel_SearchPanelContainer=SearchPanelContainer;SearchPanelContainer.__docgenInfo={description:"",methods:[],displayName:"SearchPanelContainer"}},"./src/components/SearchResult/SearchResult.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SearchResult/SearchResult.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}}}]);