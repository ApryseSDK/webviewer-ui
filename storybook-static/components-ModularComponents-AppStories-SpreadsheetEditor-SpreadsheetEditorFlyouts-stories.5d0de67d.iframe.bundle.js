"use strict";(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[9033],{"./src/components/ModularComponents/AppStories/SpreadsheetEditor/SpreadsheetEditorFlyouts.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FlyoutWithColorPickerAccessibility:()=>FlyoutWithColorPickerAccessibility,FlyoutsInTheApp:()=>FlyoutsInTheApp,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var helpers_storybookHelper__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/helpers/storybookHelper.js"),src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/redux/spreadsheetEditorComponents.js"),storybook_test__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("storybook/test"),constants_customizationVariables__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/constants/customizationVariables.js");const __WEBPACK_DEFAULT_EXPORT__={title:"SpreadsheetEditor/App/Flyouts",component:__webpack_require__("./src/components/App/index.js").A},templateObject={uiConfiguration:constants_customizationVariables__WEBPACK_IMPORTED_MODULE_3__.jq.SPREADSHEET_EDITOR,headers:src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_1__.d6,components:{...src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_1__.hy},flyoutMap:src_redux_spreadsheetEditorComponents__WEBPACK_IMPORTED_MODULE_1__.ZD,viewerRedux:{isSpreadsheetEditorModeEnabled:!0,openElements:{spreadsheetSwitcher:!0},disabledElements:{newSpreadsheetButton:{disabled:!1},logoBar:{disabled:!0}}},spreadsheetEditorRedux:helpers_storybookHelper__WEBPACK_IMPORTED_MODULE_0__.Ig},FlyoutsInTheApp=(0,helpers_storybookHelper__WEBPACK_IMPORTED_MODULE_0__.Xu)(templateObject);FlyoutsInTheApp.parameters={...FlyoutsInTheApp.parameters},FlyoutsInTheApp.play=async({canvasElement})=>{const canvas=(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.within)(canvasElement),cellTextColorToggleButton=await canvas.findByRole("button",{name:"Text Color"});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(cellTextColorToggleButton);const textColorsFlyout=await canvas.findByRole("button",{name:"Text Color #000000"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(textColorsFlyout).toBeInTheDocument();const addColorButton=await canvas.findByRole("button",{name:"Add New Color from Custom Color Picker"});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(addColorButton);const input=await canvas.findByRole("textbox",{name:/hex/i});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.clear(input),await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.type(input,"bbcc00");const okButton=await canvas.findByRole("button",{name:/ok/i});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(okButton);const newTextColorButton=await canvas.findByRole("button",{name:"Text Color #BBCC00"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(newTextColorButton).toBeInTheDocument();const cellAdjustmentButton=await canvas.findByRole("button",{name:"Cell Adjustment"});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(cellAdjustmentButton);const buttonInCellAdjustmentFlyout=await canvas.findByRole("button",{name:"Delete row"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(buttonInCellAdjustmentFlyout).toBeInTheDocument();const alignTopButtonInHeader=await canvas.findByRole("button",{name:"Text Alignment"});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(alignTopButtonInHeader);const buttonInTextAlignmentFlyout=await canvas.findByRole("button",{name:"Left align"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(buttonInTextAlignmentFlyout).toBeInTheDocument(),await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(alignTopButtonInHeader);const cellBackgroundColorToggleButton=await canvas.findByRole("button",{name:"Background Color"});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(cellBackgroundColorToggleButton);const cellBackgroundColorsFlyout=await canvas.findByRole("button",{name:"Background Color #000000"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(cellBackgroundColorsFlyout).toBeInTheDocument(),(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(canvas.queryByRole("button",{name:"Text Color #BBCC00"})).toBe(null);const moreButton=canvas.queryByRole("button",{name:/^More$/i});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(moreButton);const cellFormatMoreOptions=await canvas.findByRole("button",{name:"More cell format options"});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(cellFormatMoreOptions);const buttonInCellFormatFlyout=await canvas.findByRole("button",{name:"Financial"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(buttonInCellFormatFlyout).toBeInTheDocument(),await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.click(moreButton);const boldButton=await canvas.findByRole("button",{name:"Bold"});await(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(boldButton).toHaveAttribute("aria-current","true");const italicButton=await canvas.findByRole("button",{name:"Italic"});await(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(italicButton).toHaveAttribute("aria-current","false");const underlineButton=await canvas.findByRole("button",{name:"Underline"});await(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(underlineButton).toHaveAttribute("aria-current","true");const strikeoutButton=await canvas.findByRole("button",{name:"Strikeout"});await(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(strikeoutButton).toHaveAttribute("aria-current","false")};const FlyoutWithColorPickerAccessibility=(0,helpers_storybookHelper__WEBPACK_IMPORTED_MODULE_0__.Xu)(templateObject);FlyoutWithColorPickerAccessibility.parameters={...FlyoutsInTheApp.parameters},FlyoutWithColorPickerAccessibility.play=async({canvasElement})=>{const canvas=(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.within)(canvasElement),toolsHeader=await canvas.findByRole("toolbar",{name:"spreadsheetEditorToolsHeader"});await toolsHeader.focus();for(let i=0;i<9;i++)await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.keyboard("{ArrowRight}");const cellTextColorToggleButton=await canvas.findByRole("button",{name:"Text Color"});await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.keyboard("[Enter]");const resetToDefaultButton=await canvas.findByRole("button",{name:"Reset to default"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(resetToDefaultButton).toHaveFocus(),await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.keyboard("{ArrowLeft}");const showLessButton=await canvas.getByRole("button",{name:"Show Less Colors"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(showLessButton).toHaveFocus();for(let i=0;i<7;i++)await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.keyboard("{ArrowRight}");const colorButton=await canvas.findByRole("button",{name:"Text Color #FFFFFF"});(0,storybook_test__WEBPACK_IMPORTED_MODULE_2__.expect)(colorButton).toHaveFocus(),await storybook_test__WEBPACK_IMPORTED_MODULE_2__.userEvent.keyboard("[Escape]"),await cellTextColorToggleButton.focus()};const __namedExportsOrder=["FlyoutsInTheApp","FlyoutWithColorPickerAccessibility"]}}]);