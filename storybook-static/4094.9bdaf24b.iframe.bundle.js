(self.webpackChunkwebviewer_ui=self.webpackChunkwebviewer_ui||[]).push([[4094],{"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SignaturePanel/SignaturePanel.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.SignaturePanel{z-index:65;transition:transform .3s ease,visibility 0s ease .3s}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SignaturePanel{inset-block-start:0;width:100%;height:100%}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SignaturePanel{inset-block-start:0;width:100%;height:100%}}.open.SignaturePanel{transform:none;visibility:visible;transition:transform .3s ease,visibility 0s ease 0s}.SignaturePanel .empty-panel-container{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%;padding:36px;grid-gap:8px;gap:8px}.SignaturePanel .empty-panel-container .empty-icon{width:60px;height:60px;color:var(--gray-6);fill:var(--gray-6)}.SignaturePanel .empty-panel-container .empty-icon svg{width:60px;height:60px}.SignaturePanel .empty-panel-container .empty-message{text-align:center;max-width:131px;font-size:13px}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SignaturePanel .empty-panel-container .empty-message{line-height:15px}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .SignaturePanel .empty-panel-container .empty-message{line-height:15px}}.SignaturePanel{margin:0 8px 8px;display:flex;flex-direction:column}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SignaturePanel{width:auto;margin:16px;flex-grow:1;overflow-y:auto}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SignaturePanel{width:auto;margin:16px;flex-grow:1;overflow-y:auto}}.SignaturePanel .center{display:flex;justify-content:center;align-items:center}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .SignaturePanel .signature-widget-info .title .arrow{min-width:auto;padding:3px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .SignaturePanel .signature-widget-info .title .arrow{min-width:auto;padding:3px}}",""]),exports.locals={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"},module.exports=exports},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SignaturePanel/WidgetInfo/WidgetInfo.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".signature-widget-info{--widget-header-indent:49px;--widget-body-indent:22px;--arrow-width:12px;padding:4px;display:flex;flex-direction:column;font-size:13px;margin-bottom:10px;margin-inline-start:5px;box-sizing:border-box;border:1px solid transparent;cursor:pointer;--border-radius-amount:4px;-moz-border-radius-topleft:var(--border-radius-amount);-moz-border-radius-topright:var(--border-radius-amount);-moz-border-radius-bottomright:var(--border-radius-amount);-moz-border-radius-bottomleft:var(--border-radius-amount);border-radius:var(--border-radius-amount)}.signature-widget-info p+p{margin:1em 0 0}.signature-widget-info p.result-for-header{margin-top:0}.signature-widget-info p.bold{font-weight:700;margin-bottom:4px}.signature-widget-info p.underline{text-decoration:underline}.signature-widget-info .signatureProperties{padding:0;margin:0}.signature-widget-info .signatureProperties:focus,.signature-widget-info .signatureProperties:hover{color:var(--blue-5)}.signature-widget-info .link{cursor:pointer;outline:none;border:0;background-color:transparent;white-space:nowrap}.signature-widget-info .link.focus-visible,.signature-widget-info .link:focus-visible{outline:var(--focus-visible-outline)}.signature-widget-info .link p{margin:0;padding:0}.signature-widget-info .panel-list-text-container{height:100%}.signature-widget-info .panel-list-text-container .panel-list-label-header .Button span{text-align:start;overflow:visible;white-space:normal;text-overflow:inherit}.signature-widget-info .panel-list-icon-container .Icon{width:20px;height:20px}.signature-widget-info .title{padding-inline-start:4px;font-weight:700;display:flex;align-items:center;margin-block-start:0;margin-block-end:0;min-height:32px;margin-top:-5px;margin-bottom:-5px;overflow:hidden;border:0;background-color:transparent}.signature-widget-info .title button+*,.signature-widget-info .title div+*{margin-inline-start:2px}.signature-widget-info .title .arrow{min-width:var(--arrow-width);transition:transform .1s ease;margin-top:0;background-color:transparent;border:none;padding:0;display:flex;justify-content:center;align-items:center}.signature-widget-info .title .arrow.expanded{transform:rotate(90deg)}.signature-widget-info .title .arrow .Icon{width:var(--arrow-width);height:var(--arrow-width)}.signature-widget-info .title .arrow.hidden{visibility:hidden;padding:23px}.signature-widget-info .title .arrow:hover .Icon{color:var(--blue-6)}.signature-widget-info .title .arrow.focus-visible,.signature-widget-info .title .arrow:focus-visible{outline:var(--focus-visible-outline)}.signature-widget-info .title .signature-icon{margin-inline-end:5px}.signature-widget-info .title.focus-visible,.signature-widget-info .title:focus-visible{outline:var(--focus-visible-outline)}.signature-widget-info .header{margin-inline-start:32px}.signature-widget-info .header ul{padding-inline-start:24px}.signature-widget-info .header .body>div:first-child>p:first-child,.signature-widget-info .header .body>p:first-child{margin-top:.5em}.signature-widget-info .header .body>div:last-child{margin-bottom:.5em}.signature-widget-info .header-with-arrow{margin-inline-start:0}.signature-widget-info .header-with-arrow ul{margin-inline-start:var(--arrow-width)}.signature-widget-info .header-with-arrow ul li{margin-inline-start:18px}.signature-widget-info .panel-list-label-header button{font-weight:700;font-size:13px}.signature-widget-info .signatureDetails,.signature-widget-info .verificationDetails{cursor:default;padding:0;background-color:transparent;border:none;text-align:start}",""]),module.exports=exports},"./src/components/PanelListItem/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./src/components/PanelListItem/PanelListItem.js").A},"./src/components/SignaturePanel/SignaturePanel.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_SignaturePanel_SignaturePanel});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),actions=__webpack_require__("./src/redux/actions/index.js"),core=__webpack_require__("./src/core/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js");const getVerificationResult=async(doc,certificates,trustLists,currentLanguage,revocationChecking,revocationProxyPrefix)=>{const{PDFNet}=window.Core,{VerificationResult}=PDFNet,{TrustStatus,DigestStatus,ModificationPermissionsStatus,DocumentStatus}=VerificationResult,verificationResults={};return await PDFNet.runWithCleanup((async()=>{doc=await doc.getPDFDoc();const opts=await PDFNet.VerificationOptions.create(PDFNet.VerificationOptions.SecurityLevel.e_compatibility_and_archiving);revocationChecking&&await opts.enableOnlineCRLRevocationChecking(!0),null===revocationProxyPrefix?await opts.setRevocationProxyPrefix("https://proxy.pdftron.com"):void 0!==revocationProxyPrefix&&await opts.setRevocationProxyPrefix(revocationProxyPrefix);for(const certificate of certificates)if("string"==typeof certificate)try{await opts.addTrustedCertificateFromURL(certificate)}catch{console.error(`Error encountered when trying to load certificate from URL: ${certificate}\nCertificate will not be used as part of verification process.`);continue}else if(certificate instanceof File||"[object File]"===Object.prototype.toString.call(certificate)){const fileReader=new FileReader,arrayBufferPromise=new Promise(((resolve,reject)=>{fileReader.addEventListener("load",(async e=>{resolve(new Uint8Array(e.target.result))})),fileReader.addEventListener("error",(()=>{reject("Error reading the local certificate")})),fileReader.readAsArrayBuffer(certificate)}));try{await opts.addTrustedCertificate(await arrayBufferPromise)}catch(error){console.error(`Error encountered when trying to load certificate: ${error}Certificate will not be used as part of the verification process.`);continue}}else if(certificate instanceof ArrayBuffer||certificate instanceof Int8Array||certificate instanceof Uint8Array||certificate instanceof Uint8ClampedArray)try{await opts.addTrustedCertificate(certificate)}catch(error){console.error(`Error encountered when trying to load certificate: ${error}Certificate will not be used as part of the verification process.`);continue}for(const trustList of trustLists){const trustListDataStructure=trustList.constructor.name,supportedDataStructures=["ArrayBuffer","Int8Array","Uint8Array","Uint8ClampedArray"];let fdfDocBuffer;if("Blob"===trustListDataStructure)fdfDocBuffer=await trustList.arrayBuffer();else{if(!supportedDataStructures.includes(trustListDataStructure)){console.error(`The provided TrustList is an unsupported data-structure. Please ensure the TrustList is formatted as one of the following data-structures: ${[...supportedDataStructures,"Blob"].join("|")}`);continue}fdfDocBuffer=trustList}try{const fdf=await PDFNet.FDFDoc.createFromMemoryBuffer(fdfDocBuffer);await opts.loadTrustList(fdf)}catch(error){console.error(`Error encountered when trying to load certificate: ${error}. Certificate will not be used as part of the verification process.`);continue}}const fieldIterator=await doc.getFieldIteratorBegin();for(;await fieldIterator.hasNext();fieldIterator.next()){const field=await fieldIterator.current();if(!await field.isValid()||await field.getType()!==PDFNet.Field.Type.e_signature)continue;const digitalSigField=await PDFNet.DigitalSignatureField.createFromField(field);try{const result=await digitalSigField.verify(opts),id=await(await digitalSigField.getSDFObj()).getObjNum();let signer,signTime,documentPermission,isCertification,contactInfo,location,reason,validAtTimeOfSigning,signerName;const issuerField={},subjectField={},signed=await digitalSigField.hasCryptographicSignature();if(signed){const subFilter=await digitalSigField.getSubFilter();if(subFilter===PDFNet.DigitalSignatureField.SubFilterType.e_adbe_pkcs7_detached){const signerCert=await digitalSigField.getSignerCertFromCMS(),retrievedSubjectField=await signerCert.getSubjectField();signer=(await processX501DistinguishedName(retrievedSubjectField)||{}).e_commonName}subFilter!==PDFNet.DigitalSignatureField.SubFilterType.e_ETSI_RFC3161&&(signer||(signer=await digitalSigField.getSignatureName()||await digitalSigField.getContactInfo()),signTime=await digitalSigField.getSigningTime(),signTime=await signTime.isValid()?formatPDFNetDate(signTime,currentLanguage):null,contactInfo=await digitalSigField.getContactInfo(),location=await digitalSigField.getLocation(),reason=await digitalSigField.getReason()),documentPermission=await digitalSigField.getDocumentPermissions(),isCertification=await digitalSigField.isCertification()}const verificationStatus=await result.getVerificationStatus(),documentStatus=await result.getDocumentStatus(),digestStatus=await result.getDigestStatus(),trustStatus=await result.getTrustStatus(),permissionStatus=await result.getPermissionsStatus(),digestAlgorithm=await result.getDigestAlgorithm(),disallowedChanges=await Promise.all((await result.getDisallowedChanges()).map((async change=>({objnum:await change.getObjNum(),type:await change.getTypeAsString()})))),validSignerIdentity=trustStatus===TrustStatus.e_trust_verified;let trustVerificationResultString,trustVerificationResultBoolean,timeOfTrustVerificationEnum,trustVerificationTime;if(await result.hasTrustVerificationResult()){const trustVerificationResult=await result.getTrustVerificationResult();trustVerificationResultBoolean=await trustVerificationResult.wasSuccessful(),trustVerificationResultString=await trustVerificationResult.getResultString(),timeOfTrustVerificationEnum=await trustVerificationResult.getTimeOfTrustVerificationEnum();const epochTrustVerificationTime=await trustVerificationResult.getTimeOfTrustVerification();epochTrustVerificationTime&&(trustVerificationTime=formatDate(epochTrustVerificationTime,currentLanguage));const certPath=await trustVerificationResult.getCertPath();if(certPath.length){const firstX509Cert=certPath[0],retrievedIssuerField=await firstX509Cert.getIssuerField(),processedIssuerField=await processX501DistinguishedName(retrievedIssuerField);Object.assign(issuerField,processedIssuerField);const retrievedSubjectField=await firstX509Cert.getSubjectField(),processedSubjectField=await processX501DistinguishedName(retrievedSubjectField);Object.assign(subjectField,processedSubjectField);const lastX509Cert=certPath[certPath.length-1];try{const notBeforeEpochTime=await lastX509Cert.getNotBeforeEpochTime();validAtTimeOfSigning=await lastX509Cert.getNotAfterEpochTime()>=epochTrustVerificationTime&&epochTrustVerificationTime>=notBeforeEpochTime}catch(dateBugError){dateBugError.includes("calendar_point::to_std_timepoint() does not support years after")&&(console.warn("The following error is a known issue with Botan, and aims to be addressed in a future release of PDFNet. This currently does not impact PDFTron's Digital Signature Verification capabilities."),console.warn(dateBugError))}}}let badgeIcon;badgeIcon=verificationStatus?"digital_signature_valid":documentStatus!==DocumentStatus.e_no_error||digestStatus!==DigestStatus.e_digest_verified&&digestStatus!==DigestStatus.e_digest_verification_disabled||trustStatus===TrustStatus.e_no_trust_status||permissionStatus!==ModificationPermissionsStatus.e_unmodified&&permissionStatus!==ModificationPermissionsStatus.e_has_allowed_changes&&permissionStatus!==ModificationPermissionsStatus.e_permissions_verification_disabled?"digital_signature_error":"digital_signature_warning",signer?signerName=signer:!signer&&subjectField.e_commonName&&(signerName=subjectField.e_commonName);const fieldName=await field.getName();verificationResults[fieldName]={signed,signer,signerName,signTime,verificationStatus,documentStatus,digestStatus,trustStatus,permissionStatus,disallowedChanges,trustVerificationResultBoolean,trustVerificationResultString,timeOfTrustVerificationEnum,trustVerificationTime,id,badgeIcon,validSignerIdentity,digestAlgorithm,documentPermission,isCertification,contactInfo,location,reason,issuerField,subjectField,validAtTimeOfSigning}}catch(e){console.error(e)}}})),verificationResults},formatPDFNetDate=(date,currentLanguage)=>{const{year,month,day,hour,minute,second}=date;return new Date(Date.UTC(year,month-1,day,hour,minute,second)).toLocaleDateString(currentLanguage.replace("_","-"),{year:"numeric",month:"long",weekday:"long",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"})},formatDate=(epochTime,currentLanguage)=>{const date=new Date(0);return date.setUTCSeconds(epochTime),date.toLocaleDateString(currentLanguage.replace("_","-"),{year:"numeric",month:"long",weekday:"long",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"})},processX501DistinguishedName=async x501DistinguishedNameObject=>{const processedObject={},allAttributeAndValues=await x501DistinguishedNameObject.getAllAttributesAndValues();for(const x501AttributeTypeAndValue of allAttributeAndValues){const objectIdentifier=await x501AttributeTypeAndValue.getAttributeTypeOID(),key=await objectIdentifier.getRawValue(),value=await x501AttributeTypeAndValue.getStringValue();processedObject[translateObjectIdentifierBotanOID(key)]=value}return processedObject},translateObjectIdentifierBotanOID=objectIdentifierOIDenum=>({"[2,5,4,3]":"e_commonName","[2,5,4,4]":"e_surname","[2,5,4,6]":"e_countryName","[2,5,4,7]":"e_localityName","[2,5,4,8]":"e_stateOrProvinceName","[2,5,4,9]":"e_streetAddress","[2,5,4,10]":"e_organizationName","[2,5,4,11]":"e_organizationalUnitName","[1,2,840,113549,1,9,1]":"e_emailAddress"}["string"==typeof objectIdentifierOIDenum?objectIdentifierOIDenum:JSON.stringify(objectIdentifierOIDenum)]);var Spinner=__webpack_require__("./src/components/Spinner/index.js"),WidgetInfo=__webpack_require__("./src/components/SignaturePanel/WidgetInfo/index.js"),Icon=(__webpack_require__("./src/components/SignaturePanel/SignaturePanel.scss"),__webpack_require__("./src/components/Icon/index.js")),panel=__webpack_require__("./src/constants/panel.js");const SignaturePanel_SignaturePanel=()=>{const dispatch=(0,es.wA)(),[fields,setFields]=(0,react.useState)([]),[showSpinner,setShowSpinner]=(0,react.useState)(!1),[certificateErrorMessage,setCertificateErrorMessage]=(0,react.useState)(""),[document,setDocument]=(0,react.useState)(core.A.getDocument()),[isDisabled,certificate,trustLists,currentLanguage,revocationChecking,revocationProxyPrefix]=(0,es.d4)((state=>[selectors.A.isElementDisabled(state,"signaturePanel"),selectors.A.getCertificates(state),selectors.A.getTrustLists(state),selectors.A.getCurrentLanguage(state),selectors.A.getIsRevocationCheckingEnabled(state),selectors.A.getRevocationProxyPrefix(state)])),[translate]=(0,useTranslation.B)(),onDocumentLoaded=async()=>{setDocument(core.A.getDocument())},onDocumentUnloaded=(0,react.useCallback)((()=>{setShowSpinner(!0),dispatch(actions.A.setVerificationResult({}))}),[setShowSpinner,dispatch]),onAnnotationChanged=(annotations,action)=>{const isInFormCreationMode=core.A.getAnnotationManager().getFormFieldCreationManager().isInFormFieldCreationMode();"add"===action?addSignatureWidgetAnnotations(core.A.getAnnotationManager().getAnnotationsList()):"delete"===action&&isInFormCreationMode&&removeAnnotations(annotations)},addNonSignedFields=()=>{const currentAnnotations=core.A.getAnnotationManager().getAnnotationsList();addSignatureWidgetAnnotations(currentAnnotations)},addSignatureWidgetAnnotations=annotations=>{const currentFields=[];annotations.forEach((annotation=>{annotation instanceof window.Core.Annotations.SignatureWidgetAnnotation&&currentFields.push(annotation.getField())}));const newSet=new Set(currentFields);setFields([...newSet])},removeAnnotations=annotations=>{annotations.forEach((annotation=>{removeMatchingWidget(annotation)})),addNonSignedFields()},removeMatchingWidget=annotation=>{if(annotation instanceof window.Core.Annotations.WidgetAnnotation){const annotationManager=core.A.getAnnotationManager(),widgetToDelete=annotationManager.getAnnotationsList().filter((annotationToFilter=>annotationToFilter.getCustomData("trn-editing-rectangle-id")===annotation.Id));annotationManager.deleteAnnotations(widgetToDelete)}},resetFields=()=>{setFields([]),addNonSignedFields()};if((0,react.useEffect)((()=>(core.A.addEventListener("documentLoaded",onDocumentLoaded),core.A.addEventListener("documentUnloaded",onDocumentUnloaded),core.A.addEventListener("annotationChanged",onAnnotationChanged),core.A.addEventListener("formFieldCreationModeStarted",resetFields),core.A.addEventListener("formFieldCreationModeEnded",resetFields),()=>{core.A.removeEventListener("documentLoaded",onDocumentLoaded),core.A.removeEventListener("documentUnloaded",onDocumentUnloaded),core.A.removeEventListener("annotationChanged",onAnnotationChanged),core.A.removeEventListener("formFieldCreationModeStarted",resetFields),core.A.removeEventListener("formFieldCreationModeEnded",resetFields)})),[onDocumentUnloaded]),(0,react.useEffect)((()=>{document?core.A.getAnnotationsLoadedPromise().then((()=>{setShowSpinner(!0),(async(doc,certificates,trustLists,currentLanguage,revocationChecking,revocationProxyPrefix,dispatch)=>{const verificationResult=await getVerificationResult(doc,certificates,trustLists,currentLanguage,revocationChecking,revocationProxyPrefix);return dispatch(actions.A.setVerificationResult(verificationResult)),verificationResult})(document,certificate,trustLists,currentLanguage,revocationChecking,revocationProxyPrefix,dispatch).then((async verificationResult=>{const fieldManager=core.A.getAnnotationManager().getFieldManager();setFields(Object.keys(verificationResult).map((fieldName=>fieldManager.getField(fieldName)))),setCertificateErrorMessage("")})).catch((e=>{e&&e.message?setCertificateErrorMessage(e.message):console.error(e)})).then((()=>{addNonSignedFields()})).finally((()=>{setShowSpinner(!1)}))})):setShowSpinner(!0)}),[certificate,document,dispatch,currentLanguage]),isDisabled)return null;return(0,jsx_runtime.jsxs)("div",{className:"Panel SignaturePanel","data-element":"signaturePanel",children:[(()=>{let result;if(showSpinner)result=(0,jsx_runtime.jsx)(Spinner.A,{inPanel:!0,width:"40px",height:"40px"});else if("Error reading the local certificate"===certificateErrorMessage)result=translate("digitalSignatureVerification.panelMessages.localCertificateError");else if("Download Failed"===certificateErrorMessage)result=translate("digitalSignatureVerification.panelMessages.certificateDownloadError");else{if(fields.length)return null;result=translate("digitalSignatureVerification.panelMessages.noSignatureFields")}return(0,jsx_runtime.jsxs)("div",{className:"empty-panel-container",children:[(0,jsx_runtime.jsx)(Icon.A,{className:"empty-icon",glyph:panel.P5[panel.BB.SIGNATURE].icon}),(0,jsx_runtime.jsx)("div",{className:"empty-message",children:result})]})})(),!showSpinner&&fields.length>0&&fields.map(((field,index)=>(0,jsx_runtime.jsx)(WidgetInfo.A,{name:field.name,collapsible:!0,field},index)))]})},components_SignaturePanel_SignaturePanel=SignaturePanel_SignaturePanel;SignaturePanel_SignaturePanel.__docgenInfo={description:"",methods:[],displayName:"SignaturePanel"}},"./src/components/SignaturePanel/SignaturePanel.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SignaturePanel/SignaturePanel.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/SignaturePanel/WidgetInfo/WidgetInfo.scss":(module,__unused_webpack_exports,__webpack_require__)=>{var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js??ruleSet[1].rules[13].use[2]!./node_modules/sass-loader/dist/cjs.js!./src/components/SignaturePanel/WidgetInfo/WidgetInfo.scss");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.id,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./src/components/SignaturePanel/WidgetInfo/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>SignaturePanel_WidgetInfo,s:()=>renderPermissionStatus});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),actions=__webpack_require__("./src/redux/actions/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),core=__webpack_require__("./src/core/index.js"),selectors=__webpack_require__("./src/redux/selectors/index.js"),react_dom=__webpack_require__("./node_modules/react-dom/index.js"),getRootNode=__webpack_require__("./src/helpers/getRootNode.js");const SignaturePanel_WidgetLocator=({rect})=>{const[show,setShow]=(0,react.useState)(!1);return(0,react.useEffect)((()=>{const scrollViewContainer=core.A.getScrollViewElement(),handleScroll=()=>{setShow(!1)};return scrollViewContainer.addEventListener("scroll",handleScroll),()=>scrollViewContainer.removeEventListener("scroll",handleScroll)})),(0,react.useEffect)((()=>{rect&&(setTimeout((()=>{setShow(!0)}),50),setTimeout((()=>{setShow(!1)}),700))}),[rect]),show&&react_dom.createPortal((0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:rect.y1,left:rect.x1,width:rect.x2-rect.x1,height:rect.y2-rect.y1,border:"1px solid #00a5e4",zIndex:99}}),(0,getRootNode.Ay)().querySelector("#app"))};var useFocusHandler=__webpack_require__("./src/hooks/useFocusHandler/index.js"),PanelListItem=__webpack_require__("./src/components/PanelListItem/index.js"),Button=__webpack_require__("./src/components/Button/index.js");__webpack_require__("./src/components/SignaturePanel/WidgetInfo/WidgetInfo.scss");const renderPermissionStatus=({isCertification,ModificationPermissionsStatus,permissionStatus,translate,digestStatus,DigestStatusErrorCodes})=>{if(digestStatus===DigestStatusErrorCodes.e_digest_invalid)return(0,jsx_runtime.jsx)("p",{children:translate("digitalSignatureVerification.digestStatus.documentHasBeenAltered")});const permissionMessages={[ModificationPermissionsStatus.e_invalidated_by_disallowed_changes]:"digitalSignatureVerification.permissionStatus.invalidatedByDisallowedChanges",[ModificationPermissionsStatus.e_has_allowed_changes]:"digitalSignatureVerification.permissionStatus.hasAllowedChanges",[ModificationPermissionsStatus.e_unmodified]:isCertification?`${translate("digitalSignatureVerification.permissionStatus.unmodified")} ${translate("digitalSignatureVerification.certified")}.`:`${translate("digitalSignatureVerification.permissionStatus.unmodified")} ${translate("digitalSignatureVerification.signed")}.`,[ModificationPermissionsStatus.e_permissions_verification_disabled]:"digitalSignatureVerification.permissionStatus.permissionsVerificationDisabled",[ModificationPermissionsStatus.e_no_permissions_status]:"digitalSignatureVerification.permissionStatus.noPermissionsStatus",[ModificationPermissionsStatus.e_unsupported_permissions_features]:"digitalSignatureVerification.permissionStatus.unsupportedPermissionsFeatures"};return(0,jsx_runtime.jsx)("p",{children:translate(permissionMessages[permissionStatus]||"")})},propTypes={name:prop_types_default().string.isRequired,onClick:prop_types_default().func,field:prop_types_default().instanceOf(window.Core.Annotations.Forms.Field)},WidgetInfo_WidgetInfo=({name,field})=>{const verificationResult=(0,es.d4)((state=>selectors.A.getVerificationResult(state,name))),[locatorRect,setLocatorRect]=(0,react.useState)(null),[signatureDetailsExpanded,setSignatureDetailsExpanded]=(0,react.useState)(!1),{VerificationResult,VerificationOptions}=window.Core.PDFNet,{TimeMode}=VerificationOptions,{ModificationPermissionsStatus,DigestStatus:DigestStatusErrorCodes}=VerificationResult,[translate]=(0,useTranslation.B)(),{signed,signTime,verificationStatus,permissionStatus,disallowedChanges,trustVerificationResultBoolean,timeOfTrustVerificationEnum,trustVerificationTime,badgeIcon,isCertification,contactInfo,location,reason,signerName,digestStatus}=verificationResult,dispatch=(0,es.wA)(),titleInteraction=()=>{(field=>{if(!field.widgets.length)return;const widget=field.widgets[0];core.A.jumpToAnnotation(widget);const{scrollLeft,scrollTop}=core.A.getScrollViewElement(),rect=widget.getRect(),windowTopLeft=core.A.getDisplayModeObject().pageToWindow({x:rect.x1,y:rect.y1},widget.PageNumber),windowBottomRight=core.A.getDisplayModeObject().pageToWindow({x:rect.x2,y:rect.y2},widget.PageNumber);setLocatorRect({x1:windowTopLeft.x-scrollLeft,y1:windowTopLeft.y-scrollTop,x2:windowBottomRight.x-scrollLeft,y2:windowBottomRight.y-scrollTop})})(field)},openSignatureModalWithFocus=(0,useFocusHandler.A)((()=>{dispatch(actions.A.setSignatureValidationModalWidgetName(name)),dispatch(actions.A.openElement("signatureValidationModal"))}));return(0,jsx_runtime.jsxs)("div",{className:"signature-widget-info",children:[signed?(0,jsx_runtime.jsx)(react.Fragment,{children:(0,jsx_runtime.jsxs)(PanelListItem.A,{labelHeader:(()=>{let content=translate(isCertification?"digitalSignatureVerification.Certified":"digitalSignatureVerification.Signed");return content+=` ${translate("digitalSignatureVerification.by")} ${signerName||translate("digitalSignatureModal.unknown")}`,signTime&&(content+=` ${translate("digitalSignatureVerification.on")} ${signTime}`),content})(),iconGlyph:badgeIcon,useI18String:!1,onClick:titleInteraction,onKeyDown:titleInteraction,children:[(0,jsx_runtime.jsx)("div",{className:"verificationDetails",tabIndex:-1,children:(0,jsx_runtime.jsxs)("div",{className:"header",children:[(()=>{const verificationType=translate(isCertification?"digitalSignatureVerification.Certification":"digitalSignatureVerification.Signature");return(0,jsx_runtime.jsx)("div",{className:"title",children:(0,jsx_runtime.jsx)("p",{children:translate(verificationStatus?"digitalSignatureVerification.verificationStatus.valid":"digitalSignatureVerification.verificationStatus.failed",{verificationType})})})})(),(0,jsx_runtime.jsxs)("ul",{className:"body",children:[(0,jsx_runtime.jsx)("li",{children:renderPermissionStatus({isCertification,ModificationPermissionsStatus,permissionStatus,translate,digestStatus,DigestStatusErrorCodes})}),disallowedChanges.map((({objnum,type})=>(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)("p",{children:translate("digitalSignatureVerification.disallowedChange",{type,objnum})})},objnum))),(()=>{let verificationTimeMessage;switch(timeOfTrustVerificationEnum){case TimeMode.e_current:verificationTimeMessage=translate("digitalSignatureVerification.trustVerification.current");break;case TimeMode.e_signing:verificationTimeMessage=translate("digitalSignatureVerification.trustVerification.signing");break;case TimeMode.e_timestamp:verificationTimeMessage=translate("digitalSignatureVerification.trustVerification.timestamp");break;default:console.warn(`Unexpected pdftron::PDF::VerificationOptions::TimeMode: ${timeOfTrustVerificationEnum}`)}return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)("p",{children:translate(trustVerificationResultBoolean?"digitalSignatureVerification.trustVerification.verifiedTrust":"digitalSignatureVerification.trustVerification.noTrustVerification")})}),(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)("p",{children:trustVerificationTime})}),(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)("p",{children:verificationTimeMessage})})]})})(),(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)("button",{"data-element":`signatureProperties-${name}`,onClick:openSignatureModalWithFocus,tabIndex:0,className:"signatureProperties link","aria-label":"Open signature properties modal",children:(0,jsx_runtime.jsx)("p",{className:"bold underline",children:translate("digitalSignatureVerification.signatureProperties")})})})]})]})}),(0,jsx_runtime.jsx)("div",{className:"header header-with-arrow",children:contactInfo||location||reason?(0,jsx_runtime.jsxs)("div",{className:"signatureDetails",tabIndex:-1,children:[(0,jsx_runtime.jsxs)("div",{className:"title collapsible",children:[(0,jsx_runtime.jsx)(Button.A,{img:"icon-chevron-right",className:classnames_default()({arrow:!0,expanded:signatureDetailsExpanded}),ariaExpanded:signatureDetailsExpanded,isActive:signatureDetailsExpanded,ariaLabel:translate("digitalSignatureVerification.signatureDetails.signatureDetails"),onClick:()=>setSignatureDetailsExpanded(!signatureDetailsExpanded)}),(0,jsx_runtime.jsx)("p",{children:translate("digitalSignatureVerification.signatureDetails.signatureDetails")})]}),signatureDetailsExpanded&&(0,jsx_runtime.jsxs)("ul",{className:"body",children:[(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("p",{className:"bold",children:`${translate("digitalSignatureVerification.signatureDetails.contactInformation")}:`}),(0,jsx_runtime.jsx)("p",{className:"result-for-header",children:contactInfo||translate("digitalSignatureVerification.signatureDetails.noContactInformation")})]}),(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("p",{className:"bold",children:`${translate("digitalSignatureVerification.signatureDetails.location")}:`}),(0,jsx_runtime.jsx)("p",{className:"result-for-header",children:location||translate("digitalSignatureVerification.signatureDetails.noLocation")})]}),(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("p",{className:"bold",children:`${translate("digitalSignatureVerification.signatureDetails.reason")}:`}),(0,jsx_runtime.jsx)("p",{className:"result-for-header",children:reason||translate("digitalSignatureVerification.signatureDetails.noReason")})]}),signTime&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("p",{className:"bold",children:`${translate("digitalSignatureVerification.signatureDetails.signingTime")}:`}),(0,jsx_runtime.jsx)("p",{className:"result-for-header",children:signTime||translate("digitalSignatureVerification.signatureDetails.noSigningTime")})]})]})]}):null})]})}):(0,jsx_runtime.jsx)(PanelListItem.A,{labelHeader:translate("digitalSignatureVerification.unsignedSignatureField",{fieldName:field.name}),iconGlyph:"digital_signature_empty",useI18String:!1,onClick:titleInteraction,onKeyDown:titleInteraction}),(0,jsx_runtime.jsx)(SignaturePanel_WidgetLocator,{rect:locatorRect})]})};WidgetInfo_WidgetInfo.propTypes=propTypes;const SignaturePanel_WidgetInfo_WidgetInfo=WidgetInfo_WidgetInfo;renderPermissionStatus.__docgenInfo={description:"",methods:[],displayName:"renderPermissionStatus"},WidgetInfo_WidgetInfo.__docgenInfo={description:"",methods:[],displayName:"WidgetInfo",props:{name:{description:"",type:{name:"string"},required:!0},onClick:{description:"",type:{name:"func"},required:!1},field:{description:"",type:{name:"instanceOf",value:"window.Core.Annotations.Forms.Field"},required:!1}}};const SignaturePanel_WidgetInfo=SignaturePanel_WidgetInfo_WidgetInfo}}]);